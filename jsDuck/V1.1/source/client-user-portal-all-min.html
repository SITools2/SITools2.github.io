<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js">var Base64={_keyStr:&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&quot;,encode:function(c){var a=&quot;&quot;;var n,l,g,m,k,e,d;var b=0;c=Base64._utf8_encode(c);while(b&lt;c.length){n=c.charCodeAt(b++);l=c.charCodeAt(b++);g=c.charCodeAt(b++);m=n&gt;&gt;2;k=((n&amp;3)&lt;&lt;4)|(l&gt;&gt;4);e=((l&amp;15)&lt;&lt;2)|(g&gt;&gt;6);d=g&amp;63;if(isNaN(l)){e=d=64}else{if(isNaN(g)){d=64}}a=a+this._keyStr.charAt(m)+this._keyStr.charAt(k)+this._keyStr.charAt(e)+this._keyStr.charAt(d)}return a},decode:function(c){var a=&quot;&quot;;var n,l,g;var m,k,e,d;var b=0;c=c.replace(/[^A-Za-z0-9\+\/\=]/g,&quot;&quot;);while(b&lt;c.length){m=this._keyStr.indexOf(c.charAt(b++));k=this._keyStr.indexOf(c.charAt(b++));e=this._keyStr.indexOf(c.charAt(b++));d=this._keyStr.indexOf(c.charAt(b++));n=(m&lt;&lt;2)|(k&gt;&gt;4);l=((k&amp;15)&lt;&lt;4)|(e&gt;&gt;2);g=((e&amp;3)&lt;&lt;6)|d;a=a+String.fromCharCode(n);if(e!=64){a=a+String.fromCharCode(l)}if(d!=64){a=a+String.fromCharCode(g)}}a=Base64._utf8_decode(a);return a},_utf8_encode:function(b){b=b.replace(/\r\n/g,&quot;\n&quot;);var a=&quot;&quot;;for(var e=0;e&lt;b.length;e++){var d=b.charCodeAt(e);if(d&lt;128){a+=String.fromCharCode(d)}else{if((d&gt;127)&amp;&amp;(d&lt;2048)){a+=String.fromCharCode((d&gt;&gt;6)|192);a+=String.fromCharCode((d&amp;63)|128)}else{a+=String.fromCharCode((d&gt;&gt;12)|224);a+=String.fromCharCode(((d&gt;&gt;6)&amp;63)|128);a+=String.fromCharCode((d&amp;63)|128)}}}return a},_utf8_decode:function(a){var b=&quot;&quot;;var d=0;var e=c1=c2=0;while(d&lt;a.length){e=a.charCodeAt(d);if(e&lt;128){b+=String.fromCharCode(e);d++}else{if((e&gt;191)&amp;&amp;(e&lt;224)){c2=a.charCodeAt(d+1);b+=String.fromCharCode(((e&amp;31)&lt;&lt;6)|(c2&amp;63));d+=2}else{c2=a.charCodeAt(d+1);c3=a.charCodeAt(d+2);b+=String.fromCharCode(((e&amp;15)&lt;&lt;12)|((c2&amp;63)&lt;&lt;6)|(c3&amp;63));d+=3}}}return b}};function array(a){for(i=0;i&lt;a;i++){this[i]=0}this.length=a}function integer(a){return a%(4294967295+1)}function shr(d,c){d=integer(d);c=integer(c);if(d-2147483648&gt;=0){d=d%2147483648;d&gt;&gt;=c;d+=1073741824&gt;&gt;(c-1)}else{d&gt;&gt;=c}return d}function shl1(b){b=b%2147483648;if(b&amp;1073741824==1073741824){b-=1073741824;b*=2;b+=2147483648}else{b*=2}return b}function shl(d,c){d=integer(d);c=integer(c);for(var e=0;e&lt;c;e++){d=shl1(d)}return d}function and(d,c){d=integer(d);c=integer(c);var g=(d-2147483648);var e=(c-2147483648);if(g&gt;=0){if(e&gt;=0){return((g&amp;e)+2147483648)}else{return(g&amp;c)}}else{if(e&gt;=0){return(d&amp;e)}else{return(d&amp;c)}}}function or(d,c){d=integer(d);c=integer(c);var g=(d-2147483648);var e=(c-2147483648);if(g&gt;=0){if(e&gt;=0){return((g|e)+2147483648)}else{return((g|c)+2147483648)}}else{if(e&gt;=0){return((d|e)+2147483648)}else{return(d|c)}}}function xor(d,c){d=integer(d);c=integer(c);var g=(d-2147483648);var e=(c-2147483648);if(g&gt;=0){if(e&gt;=0){return(g^e)}else{return((g^c)+2147483648)}}else{if(e&gt;=0){return((d^e)+2147483648)}else{return(d^c)}}}function not(b){b=integer(b);return(4294967295-b)}var state=new array(4);var count=new array(2);count[0]=0;count[1]=0;var buffer=new array(64);var transformBuffer=new array(16);var digestBits=new array(16);var S11=7;var S12=12;var S13=17;var S14=22;var S21=5;var S22=9;var S23=14;var S24=20;var S31=4;var S32=11;var S33=16;var S34=23;var S41=6;var S42=10;var S43=15;var S44=21;function F(a,c,b){return or(and(a,c),and(not(a),b))}function G(a,c,b){return or(and(a,b),and(c,not(b)))}function H(a,c,b){return xor(xor(a,c),b)}function I(a,c,b){return xor(c,or(a,not(b)))}function rotateLeft(b,c){return or(shl(b,c),(shr(b,(32-c))))}function FF(k,g,p,n,e,l,m){k=k+F(g,p,n)+e+m;k=rotateLeft(k,l);k=k+g;return k}function GG(k,g,p,n,e,l,m){k=k+G(g,p,n)+e+m;k=rotateLeft(k,l);k=k+g;return k}function HH(k,g,p,n,e,l,m){k=k+H(g,p,n)+e+m;k=rotateLeft(k,l);k=k+g;return k}function II(k,g,p,n,e,l,m){k=k+I(g,p,n)+e+m;k=rotateLeft(k,l);k=k+g;return k}function transform(l,n){var k=0,g=0,p=0,m=0;var e=transformBuffer;k=state[0];g=state[1];p=state[2];m=state[3];for(i=0;i&lt;16;i++){e[i]=and(l[i*4+n],255);for(j=1;j&lt;4;j++){e[i]+=shl(and(l[i*4+j+n],255),j*8)}}k=FF(k,g,p,m,e[0],S11,3614090360);m=FF(m,k,g,p,e[1],S12,3905402710);p=FF(p,m,k,g,e[2],S13,606105819);g=FF(g,p,m,k,e[3],S14,3250441966);k=FF(k,g,p,m,e[4],S11,4118548399);m=FF(m,k,g,p,e[5],S12,1200080426);p=FF(p,m,k,g,e[6],S13,2821735955);g=FF(g,p,m,k,e[7],S14,4249261313);k=FF(k,g,p,m,e[8],S11,1770035416);m=FF(m,k,g,p,e[9],S12,2336552879);p=FF(p,m,k,g,e[10],S13,4294925233);g=FF(g,p,m,k,e[11],S14,2304563134);k=FF(k,g,p,m,e[12],S11,1804603682);m=FF(m,k,g,p,e[13],S12,4254626195);p=FF(p,m,k,g,e[14],S13,2792965006);g=FF(g,p,m,k,e[15],S14,1236535329);k=GG(k,g,p,m,e[1],S21,4129170786);m=GG(m,k,g,p,e[6],S22,3225465664);p=GG(p,m,k,g,e[11],S23,643717713);g=GG(g,p,m,k,e[0],S24,3921069994);k=GG(k,g,p,m,e[5],S21,3593408605);m=GG(m,k,g,p,e[10],S22,38016083);p=GG(p,m,k,g,e[15],S23,3634488961);g=GG(g,p,m,k,e[4],S24,3889429448);k=GG(k,g,p,m,e[9],S21,568446438);m=GG(m,k,g,p,e[14],S22,3275163606);p=GG(p,m,k,g,e[3],S23,4107603335);g=GG(g,p,m,k,e[8],S24,1163531501);k=GG(k,g,p,m,e[13],S21,2850285829);m=GG(m,k,g,p,e[2],S22,4243563512);p=GG(p,m,k,g,e[7],S23,1735328473);g=GG(g,p,m,k,e[12],S24,2368359562);k=HH(k,g,p,m,e[5],S31,4294588738);m=HH(m,k,g,p,e[8],S32,2272392833);p=HH(p,m,k,g,e[11],S33,1839030562);g=HH(g,p,m,k,e[14],S34,4259657740);k=HH(k,g,p,m,e[1],S31,2763975236);m=HH(m,k,g,p,e[4],S32,1272893353);p=HH(p,m,k,g,e[7],S33,4139469664);g=HH(g,p,m,k,e[10],S34,3200236656);k=HH(k,g,p,m,e[13],S31,681279174);m=HH(m,k,g,p,e[0],S32,3936430074);p=HH(p,m,k,g,e[3],S33,3572445317);g=HH(g,p,m,k,e[6],S34,76029189);k=HH(k,g,p,m,e[9],S31,3654602809);m=HH(m,k,g,p,e[12],S32,3873151461);p=HH(p,m,k,g,e[15],S33,530742520);g=HH(g,p,m,k,e[2],S34,3299628645);k=II(k,g,p,m,e[0],S41,4096336452);m=II(m,k,g,p,e[7],S42,1126891415);p=II(p,m,k,g,e[14],S43,2878612391);g=II(g,p,m,k,e[5],S44,4237533241);k=II(k,g,p,m,e[12],S41,1700485571);m=II(m,k,g,p,e[3],S42,2399980690);p=II(p,m,k,g,e[10],S43,4293915773);g=II(g,p,m,k,e[1],S44,2240044497);k=II(k,g,p,m,e[8],S41,1873313359);m=II(m,k,g,p,e[15],S42,4264355552);p=II(p,m,k,g,e[6],S43,2734768916);g=II(g,p,m,k,e[13],S44,1309151649);k=II(k,g,p,m,e[4],S41,4149444226);m=II(m,k,g,p,e[11],S42,3174756917);p=II(p,m,k,g,e[2],S43,718787259);g=II(g,p,m,k,e[9],S44,3951481745);state[0]+=k;state[1]+=g;state[2]+=p;state[3]+=m}function init(){count[0]=count[1]=0;state[0]=1732584193;state[1]=4023233417;state[2]=2562383102;state[3]=271733878;for(i=0;i&lt;digestBits.length;i++){digestBits[i]=0}}function update(a){var c,d;c=and(shr(count[0],3),63);if(count[0]&lt;4294967295-7){count[0]+=8}else{count[1]++;count[0]-=4294967295+1;count[0]+=8}buffer[c]=and(a,255);if(c&gt;=63){transform(buffer,0)}}function finish(){var d=new array(8);var e;var c=0,b=0,a=0;for(c=0;c&lt;4;c++){d[c]=and(shr(count[0],(c*8)),255)}for(c=0;c&lt;4;c++){d[c+4]=and(shr(count[1],(c*8)),255)}b=and(shr(count[0],3),63);a=(b&lt;56)?(56-b):(120-b);e=new array(64);e[0]=128;for(c=0;c&lt;a;c++){update(e[c])}for(c=0;c&lt;8;c++){update(d[c])}for(c=0;c&lt;4;c++){for(j=0;j&lt;4;j++){digestBits[c*4+j]=and(shr(state[c],(j*8)),255)}}}function hexa(d){var c=&quot;0123456789abcdef&quot;;var a=&quot;&quot;;var b=d;for(hexa_i=0;hexa_i&lt;8;hexa_i++){a=c.charAt(Math.abs(b)%16)+a;b=Math.floor(b/16)}return a}var ascii=&quot;01234567890123456789012345678901 !\&quot;#$%&amp;'()*+,-./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~&quot;;function MD5(n){var a,g,b,m,e,d,c;init();for(b=0;b&lt;n.length;b++){a=n.charAt(b);update(ascii.lastIndexOf(a))}finish();m=e=d=c=0;for(i=0;i&lt;4;i++){m+=shl(digestBits[15-i],(i*8))}for(i=4;i&lt;8;i++){e+=shl(digestBits[15-i],((i-4)*8))}for(i=8;i&lt;12;i++){d+=shl(digestBits[15-i],((i-8)*8))}for(i=12;i&lt;16;i++){c+=shl(digestBits[15-i],((i-12)*8))}g=hexa(c)+hexa(d)+hexa(e)+hexa(m);return g}function Digest(a){this.url=a.url;this.usr=a.usr;this.pwd=a.pwd;this.realm=a.realm;this.algorithm=a.algorithm;this.nonce=a.nonce;this.method=a.method;this.mode=a.mode;this.A1=a.A1;this.getDigestAuth=function(){this.resetHeaders();return this.buildAuthenticationRequest()};this.getA1=function(){this.resetHeaders();return this.digest(this.usr+&quot;:&quot;+this.realm+&quot;:&quot;+this.pwd)};this.resetHeaders=function(){if(typeof(this.headers)!=&quot;undefined&quot;){delete this.headers}this.headers={uri:this.url,username:this.usr,algorithm:this.algorithm,realm:this.realm,nonce:this.nonce}};this.digest=function(b){if(typeof(window[this.headers.algorithm])!=&quot;function&quot;){if(typeof(window.MD5)!=&quot;function&quot;){alert(&quot;Votre navigateur ne supporte pas l'authentification HTTP Digest !&quot;);return false}else{return MD5(b)}}return window[this.headers.algorithm](b)};this.buildResponseHash=function(){if(this.headers.salt){auth.secret=auth.secret+&quot;:&quot;+auth.headers.salt;delete auth.headers.salt}if(this.headers.migrate){auth.secret=this.digest(auth.secret)}var c;if(Ext.isEmpty(this.A1)){c=this.getA1()}else{c=this.A1}var b=this.digest(this.method+&quot;:&quot;+this.headers.uri);if(this.mode==&quot;digest&quot;){return this.digest(c+&quot;:&quot;+this.headers.nonce+&quot;:&quot;+b)}return null};this.buildAuthenticationRequest=function(){var d=&quot;Digest&quot;;var b=&quot; &quot;;for(name in this.headers){d+=b+name+'=&quot;'+this.headers[name]+'&quot;';b=&quot;,&quot;}if(typeof(this.headers.algorithm)==&quot;undefined&quot;){return d}var c=this.buildResponseHash();if(c){d+=', response=&quot;'+c+'&quot;';return d}return false}}function ann(b,a){if(b===true||b===false){return}if(b===undefined){cerr(&quot;Object is undefined - &quot;+a);ctrace();return}if(b===null){cerr(&quot;Object is null - &quot;+a);ctrace();return}if(b===&quot;&quot;){cerr(&quot;String seems empty - &quot;+a);ctrace();return}if(b==NaN){cerr(&quot;Object equals NaN - &quot;+a);ctrace();return}}function assert(b,a){if(!b){cerr(&quot;Condition is not valid : &quot;+a);ctrace();return}}function clog(a){if(isFirebugConsoleIsActive()){console.log(a)}}function cerr(a){if(isFirebugConsoleIsActive()){console.trace()}}function ctrace(){if(isFirebugConsoleIsActive()){console.trace()}}function cdir(a){if(isFirebugConsoleIsActive()){console.dir(a)}}function isFirebugConsoleIsActive(){try{if(console!==null&amp;&amp;console!==undefined){return true}else{return false}}catch(a){return false}}Ext.ux.StatusBar=Ext.extend(Ext.Toolbar,{cls:&quot;x-statusbar&quot;,busyIconCls:&quot;x-status-busy&quot;,busyText:&quot;Loading...&quot;,autoClear:5000,emptyText:&quot;&amp;nbsp;&quot;,activeThreadId:0,initComponent:function(){if(this.statusAlign==&quot;right&quot;){this.cls+=&quot; x-status-right&quot;}Ext.ux.StatusBar.superclass.initComponent.call(this)},afterRender:function(){Ext.ux.StatusBar.superclass.afterRender.call(this);var a=this.statusAlign==&quot;right&quot;;this.currIconCls=this.iconCls||this.defaultIconCls;this.statusEl=new Ext.Toolbar.TextItem({cls:&quot;x-status-text &quot;+(this.currIconCls||&quot;&quot;),text:this.text||this.defaultText||&quot;&quot;});if(a){this.add(&quot;-&gt;&quot;);this.add(this.statusEl)}else{this.insert(0,this.statusEl);this.insert(1,&quot;-&gt;&quot;)}this.doLayout()},setStatus:function(d){d=d||{};if(typeof d==&quot;string&quot;){d={text:d}}if(d.text!==undefined){this.setText(d.text)}if(d.iconCls!==undefined){this.setIcon(d.iconCls)}if(d.clear){var e=d.clear,b=this.autoClear,a={useDefaults:true,anim:true};if(typeof e==&quot;object&quot;){e=Ext.applyIf(e,a);if(e.wait){b=e.wait}}else{if(typeof e==&quot;number&quot;){b=e;e=a}else{if(typeof e==&quot;boolean&quot;){e=a}}}e.threadId=this.activeThreadId;this.clearStatus.defer(b,this,[e])}return this},clearStatus:function(c){c=c||{};if(c.threadId&amp;&amp;c.threadId!==this.activeThreadId){return this}var b=c.useDefaults?this.defaultText:this.emptyText,a=c.useDefaults?(this.defaultIconCls?this.defaultIconCls:&quot;&quot;):&quot;&quot;;if(c.anim){this.statusEl.el.fadeOut({remove:false,useDisplay:true,scope:this,callback:function(){this.setStatus({text:b,iconCls:a});this.statusEl.el.show()}})}else{this.statusEl.hide();this.setStatus({text:b,iconCls:a});this.statusEl.show()}return this},setText:function(a){this.activeThreadId++;this.text=a||&quot;&quot;;if(this.rendered){this.statusEl.setText(this.text)}return this},getText:function(){return this.text},setIcon:function(a){this.activeThreadId++;a=a||&quot;&quot;;if(this.rendered){if(this.currIconCls){this.statusEl.removeClass(this.currIconCls);this.currIconCls=null}if(a.length&gt;0){this.statusEl.addClass(a);this.currIconCls=a}}else{this.currIconCls=a}return this},showBusy:function(a){if(typeof a==&quot;string&quot;){a={text:a}}a=Ext.applyIf(a||{},{text:this.busyText,iconCls:this.busyIconCls});return this.setStatus(a)}});Ext.reg(&quot;statusbar&quot;,Ext.ux.StatusBar);Ext.namespace(&quot;sitools.widget&quot;);sitools.widget.Login=Ext.extend(Ext.Window,{id:&quot;winLogin&quot;,layout:&quot;hbox&quot;,width:392,height:200,resizable:false,closable:false,modal:true,initComponent:function(){this.title=i18n.get(&quot;label.login&quot;);this.bbar=new Ext.ux.StatusBar({text:i18n.get(&quot;label.ready&quot;),id:&quot;sbWinLogin&quot;,iconCls:&quot;x-status-valid&quot;,items:[{text:i18n.get(&quot;label.passwordLost&quot;),hidden:!this.reset,scope:this,icon:loadUrl.get(&quot;APP_URL&quot;)+&quot;/common/res/images/icons/wadl.gif&quot;,iconAlign:&quot;right&quot;,handler:function(){Ext.getCmp(&quot;winLogin&quot;).close();var a=new sitools.widget.resetPassword({closable:this.closable,url:this.reset,handler:this.handler});a.show()}}]});this.combo=new Ext.form.ComboBox({typeAhead:true,triggerAction:&quot;all&quot;,forceSelection:true,allowBlank:false,lazyRender:true,mode:&quot;local&quot;,store:new Ext.data.ArrayStore({id:0,fields:[&quot;myId&quot;,&quot;displayText&quot;],data:[[1,i18n.get(&quot;label.userPortal&quot;)],[2,i18n.get(&quot;label.administration&quot;)]]}),valueField:&quot;myId&quot;,displayField:&quot;displayText&quot;,anchor:&quot;80%&quot;,value:1,fieldLabel:i18n.get(&quot;label.target&quot;),hideLabel:true});if(this.chooseLocation){this.combo.setVisible(true);this.combo.hideLabel=false}else{this.combo.setVisible(false);this.setSize(392,160)}this.items=[{xtype:&quot;form&quot;,frame:false,border:false,buttonAlign:&quot;center&quot;,id:&quot;frmLogin&quot;,bodyStyle:'padding:10px 10px 0px 60px; background:url(&quot;'+loadUrl.get(&quot;APP_URL&quot;)+'/common/res/images/ux/login-big.gif&quot;) no-repeat #dfe8f6;',width:392,labelWidth:100,items:[{xtype:&quot;textfield&quot;,fieldLabel:i18n.get(&quot;label.login&quot;),name:&quot;login&quot;,id:&quot;logId&quot;,allowBlank:false,anchor:&quot;80%&quot;},{xtype:&quot;textfield&quot;,fieldLabel:i18n.get(&quot;label.password&quot;),name:&quot;password&quot;,id:&quot;pwdId&quot;,allowBlank:false,inputType:&quot;password&quot;,anchor:&quot;80%&quot;,listeners:{scope:this,specialkey:function(b,a){if(a.getKey()==a.ENTER){this.getAuth()}}}},this.combo],buttons:[{text:i18n.get(&quot;label.login&quot;),handler:this.getAuth,scope:this},{text:i18n.get(&quot;label.reset&quot;),handler:function(){Ext.getCmp(&quot;frmLogin&quot;).getForm().reset();Ext.getCmp(&quot;sbWinLogin&quot;).setStatus({text:i18n.get(&quot;label.ready&quot;),iconCls:&quot;x-status-valid&quot;})}},{text:i18n.get(&quot;label.cancel&quot;),hidden:!this.defurl,scope:this,handler:function(){window.location.href=this.defurl}},{text:i18n.get(&quot;label.register&quot;),hidden:!this.register,scope:this,icon:loadUrl.get(&quot;APP_URL&quot;)+&quot;/common/res/images/icons/refresh.png&quot;,handler:function(){Ext.getCmp(&quot;winLogin&quot;).close();var a=new sitools.widget.Register({closable:this.closable,url:this.register,login:this.url,handler:this.handler});a.show()}}]}];sitools.widget.Login.superclass.initComponent.call(this)},getAuth:function(){Ext.util.Cookies.set(&quot;A1&quot;,&quot;&quot;);Ext.util.Cookies.set(&quot;userLogin&quot;,&quot;&quot;);Ext.util.Cookies.set(&quot;scheme&quot;,&quot;&quot;);Ext.util.Cookies.set(&quot;algorithm&quot;,&quot;&quot;);Ext.util.Cookies.set(&quot;realm&quot;,&quot;&quot;);Ext.util.Cookies.set(&quot;nonce&quot;,&quot;&quot;);Ext.util.Cookies.set(&quot;hashCode&quot;,&quot;&quot;);Ext.apply(Ext.Ajax.defaultHeaders,{Authorization:&quot;&quot;});Ext.Ajax.request({url:this.url,method:&quot;GET&quot;,scope:this,success:function(g,a){var e=Ext.decode(g.responseText);var c=new Date();if(!Ext.isEmpty(e.data)){if(e.data.scheme==&quot;HTTP_Digest&quot;){var b=new Digest({usr:Ext.getCmp(&quot;logId&quot;).getValue(),pwd:Ext.getCmp(&quot;pwdId&quot;).getValue(),realm:e.data.realm});var d=b.getA1();Ext.util.Cookies.set(&quot;A1&quot;,d);Ext.util.Cookies.set(&quot;userLogin&quot;,b.usr,c.add(Date.MINUTE,1));Ext.util.Cookies.set(&quot;scheme&quot;,e.data.scheme);Ext.util.Cookies.set(&quot;algorithm&quot;,e.data.algorithm);Ext.util.Cookies.set(&quot;realm&quot;,b.realm);Ext.util.Cookies.set(&quot;nonce&quot;,e.data.nonce)}else{if(e.data.scheme==&quot;HTTP_Basic&quot;){var l=Ext.getCmp(&quot;logId&quot;).getValue();var m=Ext.getCmp(&quot;pwdId&quot;).getValue();var n=l+&quot;:&quot;+m;var k=Base64.encode(n);var b=&quot;Basic &quot;+k;Ext.util.Cookies.set(&quot;userLogin&quot;,l,c.add(Date.MINUTE,1));Ext.util.Cookies.set(&quot;scheme&quot;,e.data.scheme);Ext.util.Cookies.set(&quot;hashCode&quot;,b,c.add(Date.MINUTE,1))}}}this.login()},failure:alertFailure})},login:function(){if(!Ext.getCmp(&quot;frmLogin&quot;).getForm().isValid()){Ext.getCmp(&quot;sbWinLogin&quot;).setStatus({text:i18n.get(&quot;warning.checkForm&quot;),iconCls:&quot;x-status-error&quot;});return}Ext.getCmp(&quot;winLogin&quot;).body.mask();Ext.getCmp(&quot;sbWinLogin&quot;).showBusy();Ext.Ajax.request({url:this.url,method:&quot;GET&quot;,scope:this,success:function(c,e){try{var b=Ext.decode(c.responseText);if(b.success){Ext.apply(Ext.Ajax.defaultHeaders,{Authorization:Ext.util.Cookies.get(&quot;hashCode&quot;)});Ext.getCmp(&quot;winLogin&quot;).close();if(this.chooseLocation){if(this.combo.getValue()==1){window.location.href=loadUrl.get(&quot;APP_URL&quot;)+&quot;/login-redirect?kwd=/client-user/index.html&quot;}else{Ext.Ajax.request({url:loadUrl.get(&quot;APP_URL&quot;)+&quot;/login-redirect?kwd=/client-admin&quot;,method:&quot;GET&quot;,success:function(g){Ext.Msg.alert(&quot;error login.js redirect with authorization&quot;)}})}}else{window.location.reload()}}else{Ext.util.Cookies.set(&quot;userLogin&quot;,&quot;&quot;,new Date().add(Date.MINUTE,COOKIE_DURATION*-1));Ext.util.Cookies.set(&quot;scheme&quot;,&quot;&quot;,new Date().add(Date.MINUTE,COOKIE_DURATION*-1));Ext.util.Cookies.set(&quot;hashCode&quot;,&quot;&quot;,new Date().add(Date.MINUTE,COOKIE_DURATION*-1));var a=i18n.get(&quot;warning.serverError&quot;)+&quot;: &quot;+b.message;Ext.getCmp(&quot;winLogin&quot;).body.unmask();Ext.getCmp(&quot;sbWinLogin&quot;).setStatus({text:a,iconCls:&quot;x-status-error&quot;})}}catch(d){Ext.Msg.alert(i18n.get(&quot;label.error&quot;),d)}},failure:function(b,d){Ext.util.Cookies.set(&quot;userLogin&quot;,&quot;&quot;,new Date().add(Date.MINUTE,COOKIE_DURATION*-1));Ext.util.Cookies.set(&quot;scheme&quot;,&quot;&quot;,new Date().add(Date.MINUTE,COOKIE_DURATION*-1));Ext.util.Cookies.set(&quot;hashCode&quot;,&quot;&quot;,new Date().add(Date.MINUTE,COOKIE_DURATION*-1));var a;if(b.status==200){var c=Ext.decode(b.responseText).error;a=i18n.get(&quot;msg.error&quot;)+&quot;: &quot;+c}else{a=i18n.get(&quot;warning.serverError&quot;)+&quot;: &quot;+b.statusText}Ext.getCmp(&quot;winLogin&quot;).body.unmask();Ext.getCmp(&quot;sbWinLogin&quot;).setStatus({text:a,iconCls:&quot;x-status-error&quot;})}})}});Ext.reg(&quot;s-login&quot;,sitools.widget.Login);Ext.namespace(&quot;sitools.widget&quot;);sitools.widget.Register=Ext.extend(Ext.Window,{id:&quot;winRegister&quot;,layout:&quot;hbox&quot;,width:420,height:490,resizable:false,closable:false,modal:true,initComponent:function(){this.title=i18n.get(&quot;label.register&quot;);this.captchaUrl=loadUrl.get(&quot;APP_URL&quot;)+loadUrl.get(&quot;APP_INSCRIPTIONS_USER_URL&quot;)+&quot;/captcha?width=300&amp;height=50&quot;;this.bbar=new Ext.ux.StatusBar({text:i18n.get(&quot;label.ready&quot;),id:&quot;sbWinRegister&quot;,iconCls:&quot;x-status-valid&quot;});this.captcha=new Ext.BoxComponent({id:&quot;captchaBox&quot;,autoEl:{tag:&quot;img&quot;,src:this.captchaUrl+&quot;&amp;_dc=&quot;+new Date().getTime()},fieldLabel:i18n.get(&quot;label.captcha&quot;),height:50,width:300,anchor:&quot;100%&quot;});this.items=[{xtype:&quot;form&quot;,frame:false,border:false,buttonAlign:&quot;center&quot;,id:&quot;frmRegister&quot;,bodyStyle:'padding:10px 10px 0px 60px; background:url(&quot;'+loadUrl.get(&quot;APP_URL&quot;)+'/common/res/images/ux/register-big.gif&quot;) no-repeat #dfe8f6;',width:400,height:420,labelWidth:120,items:[{xtype:&quot;textfield&quot;,fieldLabel:i18n.get(&quot;label.login&quot;),name:&quot;identifier&quot;,id:&quot;regLogin&quot;,allowBlank:false,vtype:&quot;uniquelogin&quot;,anchor:&quot;100%&quot;},{xtype:&quot;textfield&quot;,fieldLabel:i18n.get(&quot;label.firstName&quot;),name:&quot;firstName&quot;,id:&quot;regFirstName&quot;,allowBlank:false,anchor:&quot;100%&quot;},{xtype:&quot;textfield&quot;,fieldLabel:i18n.get(&quot;label.lastName&quot;),name:&quot;lastName&quot;,id:&quot;regLastName&quot;,allowBlank:false,anchor:&quot;100%&quot;},{xtype:&quot;textfield&quot;,fieldLabel:i18n.get(&quot;label.password&quot;),name:&quot;password&quot;,allowBlank:false,inputType:&quot;password&quot;,vtype:&quot;passwordlength&quot;,id:&quot;pass1&quot;,anchor:&quot;100%&quot;},{xtype:&quot;textfield&quot;,fieldLabel:i18n.get(&quot;label.confirmPassword&quot;),name:&quot;cpassword&quot;,submitValue:false,allowBlank:false,inputType:&quot;password&quot;,id:&quot;pass2&quot;,initialPassField:&quot;pass1&quot;,vtype:&quot;password&quot;,anchor:&quot;100%&quot;},{xtype:&quot;textfield&quot;,fieldLabel:i18n.get(&quot;label.email&quot;),id:&quot;regEmail&quot;,name:&quot;email&quot;,vtype:&quot;uniqueemail&quot;,allowBlank:false,validationEvent:&quot;&quot;,anchor:&quot;100%&quot;},{xtype:&quot;textfield&quot;,name:&quot;organisation&quot;,fieldLabel:i18n.get(&quot;label.organisation&quot;),anchor:&quot;100%&quot;},{xtype:&quot;textarea&quot;,fieldLabel:i18n.get(&quot;label.comment&quot;),id:&quot;regComment&quot;,name:&quot;comment&quot;,validationEvent:&quot;&quot;,height:40,anchor:&quot;100%&quot;},this.captcha,{xtype:&quot;button&quot;,text:i18n.get(&quot;label.captchaReload&quot;),icon:loadUrl.get(&quot;APP_URL&quot;)+&quot;/common/res/images/icons/refresh.png&quot;,x:150,arrowAlign:&quot;right&quot;,reloadUrl:this.captchaUrl,handler:function(){Ext.util.Cookies.clear(&quot;captcha&quot;);var a=Ext.get(&quot;captchaBox&quot;);a.dom.src=this.reloadUrl+&quot;&amp;_dc=&quot;+new Date().getTime();a.slideIn(&quot;l&quot;)}},{xtype:&quot;textfield&quot;,fieldLabel:i18n.get(&quot;label.fieldCaptcha&quot;),name:&quot;captcha&quot;,id:&quot;captcha&quot;,allowBlank:false,anchor:&quot;100%&quot;},{xtype:&quot;checkbox&quot;,fieldLabel:String.format(i18n.get(&quot;label.acceptCGU&quot;),URL_CGU),id:&quot;acceptCGU&quot;,name:&quot;acceptCGU&quot;,height:40,anchor:&quot;100%&quot;,submitValue:false}],buttons:[{text:i18n.get(&quot;label.register&quot;),handler:this.register,scope:this},{text:i18n.get(&quot;label.reset&quot;),reloadUrl:this.captchaUrl,handler:function(){Ext.getCmp(&quot;frmRegister&quot;).getForm().reset();Ext.getCmp(&quot;sbWinRegister&quot;).setStatus({text:i18n.get(&quot;label.ready&quot;),iconCls:&quot;x-status-valid&quot;});Ext.util.Cookies.clear(&quot;captcha&quot;);var a=Ext.get(&quot;captchaBox&quot;);a.dom.src=this.reloadUrl+&quot;&amp;_dc=&quot;+new Date().getTime();a.slideIn(&quot;l&quot;)}},{text:i18n.get(&quot;label.login&quot;),hidden:!this.register,scope:this,icon:loadUrl.get(&quot;APP_URL&quot;)+&quot;/common/res/images/icons/refresh.png&quot;,handler:function(){Ext.getCmp(&quot;winRegister&quot;).close();var a=new sitools.widget.Login({closable:this.closable,url:this.login,register:this.url,handler:this.handler});a.show()}}]}];sitools.widget.Register.superclass.initComponent.call(this)},register:function(){var c=Ext.getCmp(&quot;frmRegister&quot;).getForm();if(!c.findField(&quot;acceptCGU&quot;).getValue()){Ext.getCmp(&quot;sbWinRegister&quot;).setStatus({text:i18n.get(&quot;label.mustAcceptCGU&quot;),iconCls:&quot;x-status-error&quot;});return}if(!c.isValid()){Ext.getCmp(&quot;sbWinRegister&quot;).setStatus({text:i18n.get(&quot;warning.checkForm&quot;),iconCls:&quot;x-status-error&quot;});this.reloadCaptcha();return}var d=new Object();d.properties=[];Ext.iterate(c.getValues(),function(e,g){if(e==&quot;organisation&quot;){d.properties.push({name:&quot;organisation&quot;,value:g,scope:&quot;Editable&quot;})}else{if(e!=&quot;captcha&quot;){d[e]=g}}},this);var a=Ext.util.Cookies.get(&quot;captcha&quot;);var b=c.findField(&quot;captcha&quot;).getValue();Ext.getCmp(&quot;winRegister&quot;).body.mask();Ext.getCmp(&quot;sbWinRegister&quot;).showBusy();Ext.Ajax.request({url:this.url,method:&quot;POST&quot;,jsonData:d,params:{&quot;captcha.id&quot;:a,&quot;captcha.key&quot;:b},scope:this,success:function(e,k){var g=Ext.decode(e.responseText);if(g.success){new Ext.ux.Notification({iconCls:&quot;x-icon-information&quot;,title:i18n.get(&quot;label.information&quot;),html:i18n.get(&quot;label.registerSent&quot;),autoDestroy:true,hideDelay:1000}).show(document);Ext.getCmp(&quot;winRegister&quot;).close()}else{Ext.getCmp(&quot;winRegister&quot;).body.unmask();Ext.getCmp(&quot;sbWinRegister&quot;).setStatus({text:g.message,iconCls:&quot;x-status-error&quot;})}if(this.handler!==null&amp;&amp;this.handler!==undefined){this.handler.call(this.scope||this)}},failure:function(g,l){var e;if(g.status==200){var k=Ext.decode(g.responseText).message;e=i18n.get(&quot;msg.error&quot;)+&quot;: &quot;+k}else{if(g.status==403){e=i18n.get(&quot;msg.wrongCaptcha&quot;)}else{e=i18n.get(&quot;warning.serverError&quot;)+&quot;: &quot;+g.statusText}}Ext.getCmp(&quot;winRegister&quot;).body.unmask();Ext.getCmp(&quot;sbWinRegister&quot;).setStatus({text:e,iconCls:&quot;x-status-error&quot;});this.reloadCaptcha()}})},reloadCaptcha:function(){Ext.util.Cookies.clear(&quot;captcha&quot;);var b=Ext.get(&quot;captchaBox&quot;);b.dom.src=this.captchaUrl+&quot;&amp;_dc=&quot;+new Date().getTime();b.slideIn(&quot;l&quot;);var c=Ext.getCmp(&quot;frmRegister&quot;).getForm();var a=c.findField(&quot;captcha&quot;).setValue(&quot;&quot;)}});Ext.reg(&quot;s-register&quot;,sitools.widget.Register);Ext.namespace(&quot;sitools.widget&quot;);sitools.widget.resetPassword=Ext.extend(Ext.Window,{id:&quot;winPassword&quot;,layout:&quot;hbox&quot;,width:420,height:183,resizable:false,modal:true,initComponent:function(){this.title=i18n.get(&quot;label.resetPassword&quot;);this.bbar=new Ext.ux.StatusBar({text:i18n.get(&quot;label.ready&quot;),id:&quot;sbWinPassword&quot;,iconCls:&quot;x-status-valid&quot;});this.items=[{xtype:&quot;form&quot;,frame:false,border:false,buttonAlign:&quot;center&quot;,id:&quot;frmResetPassword&quot;,bodyStyle:'padding:10px 10px 0px 60px; background:url(&quot;'+loadUrl.get(&quot;APP_URL&quot;)+'/common/res/images/ux/login-big.gif&quot;) no-repeat #dfe8f6;',width:400,labelWidth:120,items:[{xtype:&quot;textfield&quot;,fieldLabel:i18n.get(&quot;label.login&quot;),name:&quot;identifier&quot;,id:&quot;regLogin&quot;,allowBlank:false,anchor:&quot;100%&quot;},{xtype:&quot;textfield&quot;,fieldLabel:i18n.get(&quot;label.email&quot;),id:&quot;regEmail&quot;,name:&quot;email&quot;,vtype:&quot;uniqueemail&quot;,allowBlank:false,validationEvent:&quot;&quot;,anchor:&quot;100%&quot;},{xtype:&quot;textfield&quot;,fieldLabel:i18n.get(&quot;label.emailConfirm&quot;),id:&quot;regEmailConfirm&quot;,name:&quot;emailConfirm&quot;,vtype:&quot;uniqueemail&quot;,allowBlank:false,validationEvent:&quot;&quot;,anchor:&quot;100%&quot;}],buttons:[{text:i18n.get(&quot;label.resetPassword&quot;),handler:this.reset,scope:this},{text:i18n.get(&quot;label.reset&quot;),handler:function(){Ext.getCmp(&quot;frmResetPassword&quot;).getForm().reset();Ext.getCmp(&quot;sbWinPassword&quot;).setStatus({text:i18n.get(&quot;label.ready&quot;),iconCls:&quot;x-status-valid&quot;})}}]}];sitools.widget.Register.superclass.initComponent.call(this)},reset:function(){var a=Ext.getCmp(&quot;frmResetPassword&quot;).getForm();if(a.findField(&quot;email&quot;).getValue()!=a.findField(&quot;emailConfirm&quot;).getValue()){Ext.getCmp(&quot;sbWinPassword&quot;).setStatus({text:i18n.get(&quot;warning.checkForm&quot;),iconCls:&quot;x-status-error&quot;});return}if(!a.isValid()){Ext.getCmp(&quot;sbWinPassword&quot;).setStatus({text:i18n.get(&quot;warning.checkForm&quot;),iconCls:&quot;x-status-error&quot;});return}var b=new Object();Ext.iterate(a.getValues(),function(c,d){if(c!=&quot;emailConfirm&quot;){b[c]=d}},this);Ext.getCmp(&quot;winPassword&quot;).body.mask();Ext.getCmp(&quot;sbWinPassword&quot;).showBusy();Ext.Ajax.request({url:this.url,method:&quot;PUT&quot;,jsonData:b,scope:this,success:function(c,g){var e=Ext.decode(c.responseText);if(e.success){Ext.getCmp(&quot;winPassword&quot;).body.unmask();Ext.getCmp(&quot;sbWinPassword&quot;).setStatus({text:e.message,iconCls:&quot;x-status-valid&quot;});Ext.getCmp(&quot;winPassword&quot;).close();var d=new Ext.ux.Notification({iconCls:&quot;x-icon-information&quot;,title:i18n.get(&quot;label.information&quot;),html:i18n.get(&quot;label.passwordSent&quot;)+e.message,autoDestroy:true,hideDelay:1300});d.show(document)}else{Ext.getCmp(&quot;winPassword&quot;).body.unmask();Ext.getCmp(&quot;sbWinPassword&quot;).setStatus({text:e.message,iconCls:&quot;x-status-error&quot;})}if(this.handler!==null&amp;&amp;this.handler!==undefined){this.handler.call(this.scope||this)}},failure:function(d,g){var c;if(d.status==200){var e=Ext.decode(d.responseText).message;c=i18n.get(&quot;msg.error&quot;)+&quot;: &quot;+e}else{c=i18n.get(&quot;warning.serverError&quot;)+&quot;: &quot;+d.statusText}Ext.getCmp(&quot;winPassword&quot;).body.unmask();Ext.getCmp(&quot;sbWinPassword&quot;).setStatus({text:c,iconCls:&quot;x-status-error&quot;})}})}});Ext.namespace(&quot;sitools.widget&quot;);sitools.widget.editProfile=Ext.extend(Ext.Window,{id:&quot;winEditProfile&quot;,layout:&quot;hbox&quot;,width:420,height:410,resizable:false,closable:true,modal:true,initComponent:function(){this.title=i18n.get(&quot;label.editProfile&quot;);this.bbar=new Ext.ux.StatusBar({text:i18n.get(&quot;label.ready&quot;),id:&quot;sbWinEditProfile&quot;,iconCls:&quot;x-status-valid&quot;});var c=new Ext.data.JsonStore({fields:[{name:&quot;name&quot;,type:&quot;string&quot;},{name:&quot;value&quot;,type:&quot;string&quot;},{name:&quot;scope&quot;,type:&quot;string&quot;}],autoLoad:false});var b=new Ext.grid.RowSelectionModel({singleSelect:true});var a=new Ext.grid.ColumnModel({columns:[{header:i18n.get(&quot;headers.name&quot;),dataIndex:&quot;name&quot;,editor:new Ext.form.TextField({readOnly:true})},{header:i18n.get(&quot;headers.value&quot;),dataIndex:&quot;value&quot;,editor:new Ext.form.TextField({allowBlank:false})}],defaults:{sortable:false,width:100}});this.gridProperties=new Ext.grid.EditorGridPanel({title:i18n.get(&quot;title.properties&quot;),id:&quot;userGridProperties&quot;,height:130,autoScroll:true,clicksToEdit:1,store:c,cm:a,sm:b,viewConfig:{forceFit:true,getRowClass:function(g,d){var e=g.data;if(e.scope==&quot;ReadOnly&quot;){return&quot;row-grid-readOnly&quot;}}},listeners:{beforeedit:function(k){var g=k.record.data.scope;var d=k.field;if(g==&quot;ReadOnly&quot;||d==&quot;name&quot;){return false}}}});this.items=[{xtype:&quot;form&quot;,frame:false,border:false,buttonAlign:&quot;center&quot;,id:&quot;frmEditProfile&quot;,bodyStyle:'padding:10px 10px 0px 60px; background:url(&quot;'+loadUrl.get(&quot;APP_URL&quot;)+'/common/res/images/ux/login-big.gif&quot;) no-repeat #dfe8f6;',width:400,labelWidth:120,items:[{xtype:&quot;textfield&quot;,name:&quot;identifier&quot;,fieldLabel:i18n.get(&quot;label.login&quot;),anchor:&quot;100%&quot;,allowBlank:false,readOnly:true,style:{color:&quot;#C0C0C0&quot;},id:&quot;nameField&quot;},{xtype:&quot;textfield&quot;,fieldLabel:i18n.get(&quot;label.firstName&quot;),name:&quot;firstName&quot;,id:&quot;regFirstName&quot;,allowBlank:false,anchor:&quot;100%&quot;},{xtype:&quot;textfield&quot;,fieldLabel:i18n.get(&quot;label.lastName&quot;),name:&quot;lastName&quot;,id:&quot;regLastName&quot;,allowBlank:false,anchor:&quot;100%&quot;},{xtype:&quot;textfield&quot;,fieldLabel:i18n.get(&quot;label.password&quot;),anchor:&quot;100%&quot;,inputType:&quot;password&quot;,name:&quot;secret&quot;,value:&quot;&quot;,id:&quot;passwordField&quot;,vtype:&quot;passwordlength&quot;},{id:&quot;confirmSecret&quot;,xtype:&quot;textfield&quot;,fieldLabel:i18n.get(&quot;label.confirmPassword&quot;),anchor:&quot;100%&quot;,inputType:&quot;password&quot;,initialPassField:&quot;passwordField&quot;,vtype:&quot;password&quot;,name:&quot;confirmSecret&quot;,submitValue:false,value:&quot;&quot;},{xtype:&quot;textfield&quot;,fieldLabel:i18n.get(&quot;label.email&quot;),id:&quot;regEmail&quot;,name:&quot;email&quot;,vtype:&quot;uniqueemail&quot;,allowBlank:false,validationEvent:&quot;&quot;,anchor:&quot;100%&quot;},this.gridProperties],buttons:[{text:i18n.get(&quot;label.saveEdit&quot;),x:30,handler:this.saveEdit,scope:this}]}];sitools.widget.editProfile.superclass.initComponent.call(this)},saveEdit:function(){var a=Ext.getCmp(&quot;frmEditProfile&quot;).getForm();if(!a.isValid()){Ext.getCmp(&quot;sbWinEditProfile&quot;).setStatus({text:i18n.get(&quot;warning.checkForm&quot;),iconCls:&quot;x-status-error&quot;});return}var b=a.getValues();b.properties=[];this.gridProperties.getStore().each(function(c){b.properties.push({name:c.data.name,value:c.data.value,scope:c.data.scope})});Ext.getCmp(&quot;winEditProfile&quot;).body.mask();Ext.getCmp(&quot;sbWinEditProfile&quot;).showBusy();Ext.Ajax.request({url:this.url,method:&quot;PUT&quot;,jsonData:b,scope:this,success:function(c,g){var e=Ext.decode(c.responseText);if(e.success){Ext.getCmp(&quot;winEditProfile&quot;).close();var d=new Ext.ux.Notification({iconCls:&quot;x-icon-information&quot;,title:i18n.get(&quot;label.information&quot;),html:e.message,autoDestroy:true,hideDelay:1000});d.show(document)}else{Ext.getCmp(&quot;winEditProfile&quot;).body.unmask();Ext.getCmp(&quot;sbWinEditProfile&quot;).setStatus({text:e.message,iconCls:&quot;x-status-error&quot;})}if(this.handler!==null&amp;&amp;this.handler!==undefined){this.handler.call(this.scope||this)}},failure:function(d,g){var c;if(d.status==200){var e=Ext.decode(d.responseText).message;c=i18n.get(&quot;msg.error&quot;)+&quot;: &quot;+e}else{c=i18n.get(&quot;warning.serverError&quot;)+&quot;: &quot;+d.statusText}Ext.getCmp(&quot;winEditProfile&quot;).body.unmask();Ext.getCmp(&quot;sbWinEditProfile&quot;).setStatus({text:c,iconCls:&quot;x-status-error&quot;})}})},onRender:function(){sitools.widget.editProfile.superclass.onRender.apply(this,arguments);if(this.url){Ext.Ajax.request({url:this.url,method:&quot;GET&quot;,scope:this,success:function(a){var c=this.findByType(&quot;form&quot;)[0].getForm();var b=Ext.decode(a.responseText);if(b.user!==undefined){c.setValues(b.user);c.findField(&quot;secret&quot;).setValue(&quot;&quot;);if(!Ext.isEmpty(b.user.properties)){Ext.each(b.user.properties,function(d){var e=new Ext.data.Record({name:d.name,value:d.value,scope:d.scope});this.gridProperties.getStore().add(e)},this)}}},failure:alertFailure})}}});var loginErrLength=&quot;Login minimum 4 character !&quot;;var loginErrUnique=&quot;Login already in use !&quot;;var loginSuccess=&quot;Login avaliable&quot;;var emailErrFormat=&quot;Email not valid !&quot;;var emailErrUnique=&quot;Email already in use !&quot;;var emailSuccess=&quot;Email valid &amp; avaliable&quot;;Ext.apply(Ext.form.VTypes,{uniqueloginMask:/[a-z0-9_\.\-@\+]/i,uniquelogin:function(a){if(a.length&lt;4){Ext.apply(Ext.form.VTypes,{uniqueloginText:loginErrLength});return false}else{return true}},uniqueloginText:loginErrUnique,uniqueemailMask:/[a-z0-9_\.\-@\+]/i,uniqueemail:function(b){var a=/^(\w+)([\-+.][\w]+)*@(\w[\-\w]*\.){1,5}([A-Za-z]){2,6}$/;if(a.test(b)){return true}else{return false}},uniqueemailText:emailErrFormat,password:function(c,b){if(b.initialPassField){var a=Ext.getCmp(b.initialPassField);return(c==a.getValue())}return true},passwordText:&quot;Passwords do not match&quot;,passwordlength:function(a){if(a.length&lt;6||a.length&gt;40){return false}else{return true}},passwordlengthText:&quot;Invalid Password Length. It must be between 6 and 40&quot;});function resetLoginValidator(a){Ext.apply(Ext.form.VTypes,{uniquelogin:function(b){if(b.length&lt;4){Ext.apply(Ext.form.VTypes,{uniqueloginText:loginErrLength});return false}else{return true}}})}function resetEmailValidator(a){Ext.apply(Ext.form.VTypes,{uniqueemail:function(c){var b=/^(\w+)([\-+.][\w]+)*@(\w[\-\w]*\.){1,5}([A-Za-z]){2,6}$/;if(b.test(c)){return true}else{return false}return(a)}})}Ext.namespace(&quot;Ext.ux.plugin&quot;);Ext.onReady(function(){var a=Ext.util.CSS;if(a){a.getRule(&quot;.x-hide-nosize&quot;)||a.createStyleSheet(&quot;.x-hide-nosize{height:0px!important;width:0px!important;border:none!important;zoom:1;}.x-hide-nosize * {height:0px!important;width:0px!important;border:none!important;zoom:1;}&quot;);a.refreshCache()}});(function(){var k=Ext.Element,b=Ext.lib.Anim,a=k.prototype;var g=&quot;visibility&quot;,d=&quot;display&quot;,c=&quot;hidden&quot;,l=&quot;none&quot;;var e={};e.El={setDisplayed:function(n){var m=this;m.visibilityCls?(m[n!==false?&quot;removeClass&quot;:&quot;addClass&quot;](m.visibilityCls)):a.setDisplayed.call(m,n);return m},isDisplayed:function(){return !(this.hasClass(this.visibilityCls)||this.isStyle(d,l))},fixDisplay:function(){var m=this;a.fixDisplay.call(m);m.visibilityCls&amp;&amp;m.removeClass(m.visibilityCls)},isVisible:function(n){var q=this.visible||(!this.isStyle(g,c)&amp;&amp;(this.visibilityCls?!this.hasClass(this.visibilityCls):!this.isStyle(d,l)));if(n!==true||!q){return q}var r=this.dom.parentNode,m=/^body/i;while(r&amp;&amp;!m.test(r.tagName)){if(!Ext.fly(r,&quot;_isVisible&quot;).isVisible()){return false}r=r.parentNode}return true},isStyle:a.isStyle||function(m,n){return this.getStyle(m)==n}};Ext.override(k.Flyweight,e.El);Ext.ux.plugin.VisibilityMode=function(n){Ext.apply(this,n||{});var m=Ext.util.CSS;if(m&amp;&amp;!Ext.isIE&amp;&amp;this.fixMaximizedWindow!==false&amp;&amp;!Ext.ux.plugin.VisibilityMode.MaxWinFixed){m.updateRule(&quot;.x-window-maximized-ct&quot;,&quot;overflow&quot;,&quot;&quot;);Ext.ux.plugin.VisibilityMode.MaxWinFixed=true}};Ext.extend(Ext.ux.plugin.VisibilityMode,Object,{bubble:true,fixMaximizedWindow:true,elements:null,visibilityCls:&quot;x-hide-nosize&quot;,hideMode:&quot;nosize&quot;,ptype:&quot;uxvismode&quot;,init:function(r){var n=this.hideMode||r.hideMode,q=this,m=Ext.Container.prototype.bubble,p=function(){var t=[this.collapseEl,this.actionMode].concat(q.elements||[]);Ext.each(t,function(u){q.extend(this[u]||u)},this);var s={visFixed:true,animCollapse:false,animFloat:false,hideMode:n,defaults:this.defaults||{}};s.defaults.hideMode=n;Ext.apply(this,s);Ext.apply(this.initialConfig||{},s)};r.on(&quot;render&quot;,function(){if(q.bubble!==false&amp;&amp;this.ownerCt){m.call(this.ownerCt,function(){this.visFixed||this.on(&quot;afterlayout&quot;,p,this,{single:true})})}p.call(this)},r,{single:true})},extend:function(m,n){m&amp;&amp;Ext.each([].concat(m),function(p){if(p&amp;&amp;p.dom){if(&quot;visibilityCls&quot; in p){return}Ext.apply(p,e.El);p.visibilityCls=n||this.visibilityCls}},this);return this}});Ext.preg&amp;&amp;Ext.preg(&quot;uxvismode&quot;,Ext.ux.plugin.VisibilityMode);Ext.provide&amp;&amp;Ext.provide(&quot;uxvismode&quot;)})();(function(){var Q=Ext.Element,s,C=Ext.lib.Dom,av=Ext.lib.Anim,r=Ext.EventManager,at=Ext.lib.Event,ax=document,B=function(){},az=Object.prototype,aJ=az.toString,u=&quot;[object HTMLDocument]&quot;;if(!Ext.elCache||parseInt(Ext.version.replace(/\./g,&quot;&quot;),10)&lt;311){alert(&quot;Ext Release &quot;+Ext.version+&quot; is not supported&quot;)}Ext._documents={};Ext._documents[Ext.id(document,&quot;_doc&quot;)]=Ext.elCache;var aa=C.resolveDocumentCache=function(E,aO){var aN=e(E),aP=Ext.isDocument(aN)?Ext.id(aN):aO,A=Ext._documents[aP]||null;return A||(aP?Ext._documents[aP]={}:null)},aM=C.clearDocumentCache=function(A){delete Ext._documents[A]};Q.addMethods||(Q.addMethods=function(A){Ext.apply(Q.prototype,A||{})});Ext.removeNode=function(aQ){var aP=aQ?aQ.dom||aQ:null,aN,aO,A=aa(aP),E;if(aP&amp;&amp;(aO=A[aP.id])&amp;&amp;(aN=aO.el)){if(aN.dom){Ext.enableNestedListenerRemoval?r.purgeElement(aN.dom,true):r.removeAll(aN.dom)}delete A[aP.id];delete aN.dom;delete aN._context;aN=null}if(aP&amp;&amp;!aP.navigator&amp;&amp;!Ext.isDocument(aP)&amp;&amp;aP.tagName!=&quot;BODY&quot;){(E=aP.parentElement||aP.parentNode)&amp;&amp;E.removeChild(aP)}aP=E=null};var g=function(aR,aP){var aQ=typeof aR===&quot;function&quot;?aR:function aO(){};var aN=aQ._ovl;if(!aN){aN={base:aQ};aN[aQ.length||0]=aQ;aQ=function aO(){var aU=arguments.callee._ovl;var aT=aU[arguments.length]||aU.base;return aT&amp;&amp;aT!=arguments.callee?aT.apply(this,arguments):undefined}}var aS=[].concat(aP);for(var E=0,A=aS.length;E&lt;A;++E){aN[aS[E].length]=aS[E]}aQ._ovl=aN;var aO=null;return aQ};Ext.applyIf(Ext,{overload:g(g,[function(A){return g(null,A)},function(aN,E,A){return aN[E]=g(aN[E],A)}]),isArray:function(A){return !!A&amp;&amp;aJ.apply(A)==&quot;[object Array]&quot;},isObject:function(A){return !!A&amp;&amp;typeof A==&quot;object&quot;},isDocument:function(E,A){var aP=E?E.dom||E:null;var aO=aP&amp;&amp;((aJ.apply(aP)==u)||(aP&amp;&amp;aP.nodeType==9));if(aO&amp;&amp;A){try{aO=!!aP.location}catch(aN){return false}}return aO},isWindow:function(A){var E=A?A.dom||A:null;return E?!!E.navigator||aJ.apply(E)==&quot;[object Window]&quot;:false},isIterable:function(A){if(Ext.isArray(A)||A.callee){return true}if(/NodeList|HTMLCollection/.test(aJ.call(A))){return true}return((typeof A.nextNode!=&quot;undefined&quot;||A.item)&amp;&amp;Ext.isNumber(A.length))},isElement:function(A){return A&amp;&amp;Ext.type(A)==&quot;element&quot;},isEvent:function(A){return aJ.apply(A)==&quot;[object Event]&quot;||(Ext.isObject(A)&amp;&amp;!Ext.type(o.constructor)&amp;&amp;(window.event&amp;&amp;A.clientX&amp;&amp;A.clientX==window.event.clientX))},isFunction:function(A){return !!A&amp;&amp;typeof A==&quot;function&quot;},isEventSupported:function(aO,aP){var aN={select:&quot;input&quot;,change:&quot;input&quot;,submit:&quot;form&quot;,reset:&quot;form&quot;,load:&quot;img&quot;,error:&quot;img&quot;,abort:&quot;img&quot;},A={},aQ=/^on/i,E=function(aT,aS){var aR=Ext.getDom(aS);return(aR?(Ext.isElement(aR)||Ext.isDocument(aR)?aR.nodeName.toLowerCase():aS.self?&quot;#window&quot;:aS||&quot;#object&quot;):aS||&quot;div&quot;)+&quot;:&quot;+aT};return function(aV,aX){aV=(aV||&quot;&quot;).replace(aQ,&quot;&quot;);var aW,aU=false;var aS=&quot;on&quot;+aV;var aR=(aX?aX:aN[aV])||&quot;div&quot;;var aT=E(aV,aR);if(aT in A){return A[aT]}aW=Ext.isString(aR)?ax.createElement(aR):aX;aU=(!!aW&amp;&amp;(aS in aW));aU||(aU=window.Event&amp;&amp;!!(String(aV).toUpperCase() in window.Event));if(!aU&amp;&amp;aW){aW.setAttribute&amp;&amp;aW.setAttribute(aS,&quot;return;&quot;);aU=Ext.isFunction(aW[aS])}A[aT]=aU;aW=null;return aU}}()});var ay=function(A){return Q;return Q[(A.tagName||&quot;-&quot;).toUpperCase()]||Q};var O;function ar(A,E){if(!O){O=new Ext.Element.Flyweight()}O.dom=Ext.getDom(A,null,E);return O}Ext.apply(Ext,{get:Q.get=function(aO,aT){if(!aO){return null}var aS=Ext.isDocument(aO);Ext.isDocument(aT)||(aT=ax);var aR,aQ,E,A=aa(aT);if(typeof aO==&quot;string&quot;){aQ=Ext.getDom(aO,null,aT);if(!aQ){return null}if(A[aO]&amp;&amp;A[aO].el){aR=A[aO].el;aR.dom=aQ}else{aR=Q.addToCache(new (ay(aQ))(aQ,null,aT))}return aR}else{if(aS){if(!Ext.isDocument(aO,true)){return false}A=aa(aO);if(A[Ext.id(aO)]&amp;&amp;A[aO.id].el){return A[aO.id].el}var aP=function(){};aP.prototype=Q.prototype;var aN=new aP();aN.dom=aO;aN.id=Ext.id(aO,&quot;_doc&quot;);aN._isDoc=true;Q.addToCache(aN,null,A);return aN}else{if(aO instanceof Q){if(aO.dom){aO.id=Ext.id(aO.dom)}else{aO.dom=aO.id?Ext.getDom(aO.id,true):null}if(aO.dom){A=aa(aO);(A[aO.id]||(A[aO.id]={data:{},events:{}})).el=aO}return aO}else{if(aO.tagName||Ext.isWindow(aO)){A=aa(aO);E=Ext.id(aO);if(A[E]&amp;&amp;(aR=A[E].el)){aR.dom=aO}else{aR=Q.addToCache(new (ay(aO))(aO,null,aT),null,A)}return aR}else{if(aO.isComposite){return aO}else{if(Ext.isArray(aO)){return Ext.get(aT,aT).select(aO)}}}}}}return null},getDom:function(E,A,aP){var aO=aP||ax;if(!E||!aO){return null}if(E.dom){return E.dom}else{if(Ext.isString(E)){var aN=aO.getElementById(E);if(aN&amp;&amp;Ext.isIE&amp;&amp;A){if(E==aN.getAttribute(&quot;id&quot;)){return aN}else{return null}}return aN}else{return E}}},getBody:function(E){var A=C.getDocument(E)||ax;return Ext.get(A.body||A.documentElement)},getDoc:Ext.overload([Ext.getDoc,function(A){return Ext.get(A,A)}])});Q.data=function(E,A,aN){E=Q.get(E);if(!E){return null}var aO=aa(E)[E.id].data;if(arguments.length==2){return aO[A]}else{return(aO[A]=aN)}};Q.addToCache=function(E,aP,A){aP=aP||Ext.id(E);var aO=A||aa(E);aO[aP]={el:E.dom?E:Ext.get(E),data:{},events:{}};var aN=aO[aP].el.dom;(aN.getElementById||aN.navigator)&amp;&amp;(aO[aP].skipGC=true);return aO[aP].el};Q.removeFromCache=function(E,A){if(E&amp;&amp;E.id){var aN=A||aa(E);delete aN[E.id]}};Q.ASCLASS=3;Q.visibilityCls=&quot;x-hide-nosize&quot;;var aB={},S=/(-[a-z])/gi,N=function(A,E){return E.charAt(1).toUpperCase()},m=/alpha\(opacity=(.*)\)/i,q=/^\s+|\s+$/g,aH=/marginRight/,K=Ext.isIE?&quot;styleFloat&quot;:&quot;cssFloat&quot;,aC=ax.defaultView,aj=&quot;visibilityMode&quot;,D=Q.DISPLAY,l=Q.VISIBILITY,ap=Q.ASCLASS,T=&quot;originalDisplay&quot;,ak=&quot;padding&quot;,X=&quot;margin&quot;,aF=&quot;border&quot;,c=&quot;-left&quot;,n=&quot;-right&quot;,t=&quot;-top&quot;,aD=&quot;-bottom&quot;,W=&quot;-width&quot;,aI=Math,af=&quot;opacity&quot;,ae=&quot;visibility&quot;,R=&quot;display&quot;,ao=&quot;offsets&quot;,aE=&quot;asclass&quot;,al=&quot;hidden&quot;,ag=&quot;none&quot;,ad=&quot;isVisible&quot;,J=&quot;isClipped&quot;,d=&quot;overflow&quot;,Z=&quot;overflow-x&quot;,Y=&quot;overflow-y&quot;,L=&quot;originalClip&quot;,V=&quot;x-masked&quot;,M=&quot;x-masked-relative&quot;,aq={l:aF+c+W,r:aF+n+W,t:aF+t+W,b:aF+aD+W},aw={l:ak+c,r:ak+n,t:ak+t,b:ak+aD},v={l:X+c,r:X+n,t:X+t,b:X+aD},P=Q.data,aK=Ext.getDom,z=Ext.get,an=Ext.DomHelper,ah=/^(?:scope|delay|buffer|single|stopEvent|preventDefault|stopPropagation|normalized|args|delegate)$/,aL=Ext.util.CSS,au=function(E){var A=P(E,T);if(A===undefined){P(E,T,A=&quot;&quot;)}return A},p=function(E){var A=P(E,aj);if(A===undefined){P(E,aj,A=Q.prototype.visibilityMode)}return A};function aA(A){return aB[A]||(aB[A]=A==&quot;float&quot;?K:A.replace(S,N))}Q.addMethods({getDocument:function(){return this._context||(this._context=e(this))},remove:function(E,A){var aN=this.dom;this.isMasked()&amp;&amp;this.unmask();if(aN){Ext.removeNode(aN);delete this._context;delete this.dom}},appendChild:function(A,E){return z(A,E||this.getDocument()).appendTo(this)},appendTo:function(A,E){aK(A,false,E||this.getDocument()).appendChild(this.dom);return this},insertBefore:function(A,E){(A=aK(A,false,E||this.getDocument())).parentNode.insertBefore(this.dom,A);return this},insertAfter:function(A,E){(A=aK(A,false,E||this.getDocument())).parentNode.insertBefore(this.dom,A.nextSibling);return this},insertFirst:function(E,A){E=E||{};if(E.nodeType||E.dom||typeof E==&quot;string&quot;){E=aK(E);this.dom.insertBefore(E,this.dom.firstChild);return !A?z(E):E}else{return this.createChild(E,this.dom.firstChild,A)}},replace:function(A,E){A=z(A,E||this.getDocument());this.insertBefore(A);A.remove();return this},replaceWith:function(A,aN){var E=this;if(A.nodeType||A.dom||typeof A==&quot;string&quot;){A=aK(A,false,aN||E.getDocument());E.dom.parentNode.insertBefore(A,E.dom)}else{A=an.insertBefore(E.dom,A)}var aO=aa(E);Ext.removeNode(E.dom);E.id=Ext.id(E.dom=A);Q.addToCache(E.isFlyweight?new (ay(E.dom))(E.dom,null,aO):E);return E},insertHtml:function(E,aN,A){var aO=an.insertHtml(E,this.dom,aN);return A?Ext.get(aO,e(aO)):aO},setVisibilityMode:function(A){P(this.dom,aj,A);return this},isVisible:function(){return this.visible||Ext.value(P(this.dom,ad),!this.isStyle(ae,al)&amp;&amp;!this.isStyle(R,ag))},setVisible:function(aP,A){var aR=this,aQ=aR.dom,E,aT,aS,aO;if(typeof A==&quot;string&quot;){E=A==R;aT=A==ae;aS=A==ao;aO=A==aE;A=false}else{var aN=p(aQ);E=aN==D;aT=aN==l;aO=aN==ap}if(!A||!aR.anim){if(aO){aR[aP?&quot;removeClass&quot;:&quot;addClass&quot;](aR.visibilityCls||Q.visibilityCls)}else{if(E){return aR.setDisplayed(aP)}else{if(aS){if(!aP){aR.hideModeStyles={position:aR.getStyle(&quot;position&quot;),top:aR.getStyle(&quot;top&quot;),left:aR.getStyle(&quot;left&quot;)};aR.applyStyles({position:&quot;absolute&quot;,top:&quot;-10000px&quot;,left:&quot;-10000px&quot;})}else{aR.applyStyles(aR.hideModeStyles||{position:&quot;&quot;,top:&quot;&quot;,left:&quot;&quot;});delete aR.hideModeStyles}}else{aR.fixDisplay();if(aQ){aQ.style.visibility=aP?&quot;visible&quot;:al}}}}}else{if(aP){aR.setOpacity(0.01);aR.setVisible(true)}aR.anim({opacity:{to:(aP?1:0)}},aR.preanim(arguments,1),null,0.35,&quot;easeIn&quot;,function(){if(!aP){aO?aR.addClass(aR.visibilityCls||Q.visibilityCls):aQ.style[E?R:ae]=(E)?ag:al;aR.setOpacity(1)}})}P(aQ,ad,aP);return aR},setDisplayed:function(E){var aN=this.dom,A=p(aN);if(typeof E==&quot;boolean&quot;){if(A==Q.ASCLASS){return this.setVisible(E,aE)}P(this.dom,ad,E);E=E?au(aN):ag}this.setStyle(R,E);return this},fixDisplay:function(){var A=this;if(A.isStyle(R,ag)){A.setStyle(ae,al);A.setStyle(R,au(A.dom));if(A.isStyle(R,ag)){A.setStyle(R,&quot;block&quot;)}}P(A.dom,ad)||A.removeClass(A.visibilityCls||Q.visibilityCls)},enableDisplayMode:function(A){this.setVisibilityMode(Q.DISPLAY);if(!Ext.isEmpty(A)){P(this.dom,T,A)}return this},scrollIntoView:function(aN,aQ){var aV=this.getDocument(),aW=Ext.getDom(aN,null,aV)||Ext.getBody(aV).dom,aP=this.dom,aO=this.getOffsetsTo(aW),aS=aO[0]+aW.scrollLeft,aZ=aO[1]+aW.scrollTop,aX=aZ+aP.offsetHeight,E=aS+aP.offsetWidth,A=aW.clientHeight,aT=parseInt(aW.scrollTop,10),aY=parseInt(aW.scrollLeft,10),aR=aT+A,aU=aY+aW.clientWidth;if(aP.offsetHeight&gt;A||aZ&lt;aT){aW.scrollTop=aZ}else{if(aX&gt;aR){aW.scrollTop=aX-A}}aW.scrollTop=aW.scrollTop;if(aQ!==false){if(aP.offsetWidth&gt;aW.clientWidth||aS&lt;aY){aW.scrollLeft=aS}else{if(E&gt;aU){aW.scrollLeft=E-aW.clientWidth}}aW.scrollLeft=aW.scrollLeft}return this},contains:function(A){try{return !A?false:C.isAncestor(this.dom,A.dom?A.dom:A)}catch(E){return false}},getScroll:function(){var aR=this.dom,aQ=this.getDocument(),A=aQ.body,aN=aQ.documentElement,E,aP,aO;if(Ext.isDocument(aR)||aR==A){if(Ext.isIE&amp;&amp;C.docIsStrict(aQ)){E=aN.scrollLeft;aP=aN.scrollTop}else{E=window.pageXOffset;aP=window.pageYOffset}aO={left:E||(A?A.scrollLeft:0),top:aP||(A?A.scrollTop:0)}}else{aO={left:aR.scrollLeft,top:aR.scrollTop}}return aO},getStyle:function(){var A=aC&amp;&amp;aC.getComputedStyle?function E(aT){var aQ=!this._isDoc?this.dom:null,aN,aP,aO,aR,aS=Ext.isWebKit,aR;if(!aQ||!aQ.style){return null}aT=aA(aT);aO=(aN=aQ.style[aT])?aN:(aP=aC.getComputedStyle(aQ,&quot;&quot;))?aP[aT]:null;if(aS){if((aH.test(aT))&amp;&amp;aO!=&quot;0px&quot;){aR=this.getStyle(&quot;display&quot;);aQ.style.display=&quot;inline-block&quot;;aO=aC.getComputedStyle(aQ,&quot;&quot;);aQ.style.display=aR}if(aO==&quot;rgba(0, 0, 0, 0)&quot;){aO=&quot;transparent&quot;}}return aO}:function E(aR){var aP=!this._isDoc?this.dom:null,aN,aO;if(!aP||!aP.style){return null}if(aR==af){if(aP.style.filter.match){if(aN=aP.style.filter.match(m)){var aQ=parseFloat(aN[1]);if(!isNaN(aQ)){return aQ?aQ/100:0}}}return 1}aR=aA(aR);return aP.style[aR]||((aO=aP.currentStyle)?aO[aR]:null)};var E=null;return A}(),setStyle:function(aP,aO){if(this._isDoc||Ext.isDocument(this.dom)){return this}var A,E;if(typeof aP!=&quot;object&quot;){A={};A[aP]=aO;aP=A}for(E in aP){aO=aP[E];if(E==af){this.setOpacity(aO)}else{try{this.dom.style[aA(E)]=aO}catch(aN){null}}}return this},center:function(A){return this.alignTo(A||this.getDocument(),&quot;c-c&quot;)},mask:function(E,aQ){var aS=this,aO=aS.dom,aR=Ext.DomHelper,aP=&quot;ext-el-mask-msg&quot;,A,aT;if(aS.getStyle(&quot;position&quot;)==&quot;static&quot;){aS.addClass(M)}if((A=P(aO,&quot;maskMsg&quot;))){A.remove()}if((A=P(aO,&quot;mask&quot;))){A.remove()}aT=aR.append(aO,{cls:&quot;ext-el-mask&quot;},true);P(aO,&quot;mask&quot;,aT);aS.addClass(V);aT.setDisplayed(true);if(typeof E==&quot;string&quot;){var aN=aR.append(aO,{cls:aP,cn:{tag:&quot;div&quot;}},true);P(aO,&quot;maskMsg&quot;,aN);aN.dom.className=aQ?aP+&quot; &quot;+aQ:aP;aN.dom.firstChild.innerHTML=E;aN.setDisplayed(true);aN.center(aS)}if(Ext.isIE&amp;&amp;!(Ext.isIE7&amp;&amp;Ext.isStrict)&amp;&amp;aS.getStyle(&quot;height&quot;)==&quot;auto&quot;){aT.setSize(undefined,aS.getHeight())}return aT},unmask:function(){var aN=this,aO=aN.dom,A=P(aO,&quot;mask&quot;),E=P(aO,&quot;maskMsg&quot;);if(A){if(E){E.remove();P(aO,&quot;maskMsg&quot;,undefined)}A.remove();P(aO,&quot;mask&quot;,undefined)}aN.removeClass([V,M])},isMasked:function(){var A=P(this.dom,&quot;mask&quot;);return A&amp;&amp;A.isVisible()},getCenterXY:function(){return this.getAlignToXY(this.getDocument(),&quot;c-c&quot;)},getAnchorXY:function(aP,aU,aZ){aP=(aP||&quot;tl&quot;).toLowerCase();aZ=aZ||{};var aT=this,aW=this.getDocument(),E=aT.dom==aW.body||aT.dom==aW,aX=aZ.width||E?C.getViewWidth(false,aW):aT.getWidth(),aR=aZ.height||E?C.getViewHeight(false,aW):aT.getHeight(),aY,A=Math.round,aN=aT.getXY(),aV=aT.getScroll(),aS=E?aV.left:!aU?aN[0]:0,aQ=E?aV.top:!aU?aN[1]:0,aO={c:[A(aX*0.5),A(aR*0.5)],t:[A(aX*0.5),0],l:[0,A(aR*0.5)],r:[aX,A(aR*0.5)],b:[A(aX*0.5),aR],tl:[0,0],bl:[0,aR],br:[aX,aR],tr:[aX,0]};aY=aO[aP];return[aY[0]+aS,aY[1]+aQ]},anchorTo:function(E,aQ,aN,A,aS,aT){var aR=this,aP=aR.dom;function aO(){ar(aP).alignTo(E,aQ,aN,A);Ext.callback(aT,ar(aP))}Ext.EventManager.onWindowResize(aO,aR);if(!Ext.isEmpty(aS)){Ext.EventManager.on(window,&quot;scroll&quot;,aO,aR,{buffer:!isNaN(aS)?aS:50})}aO.call(aR);return aR},getScroll:function(){var aR=this.dom,aQ=this.getDocument(),A=aQ.body,aN=aQ.documentElement,E,aP,aO;if(aR==aQ||aR==A){if(Ext.isIE&amp;&amp;C.docIsStrict(aQ)){E=aN.scrollLeft;aP=aN.scrollTop}else{E=window.pageXOffset;aP=window.pageYOffset}aO={left:E||(A?A.scrollLeft:0),top:aP||(A?A.scrollTop:0)}}else{aO={left:aR.scrollLeft,top:aR.scrollTop}}return aO},getAlignToXY:function(aO,a0,a3){var bf;aO=Ext.get(aO,bf=this.getDocument());if(!aO||!aO.dom){throw&quot;Element.getAlignToXY with an element that doesn't exist&quot;}a3=a3||[0,0];a0=(a0==&quot;?&quot;?&quot;tl-bl?&quot;:(!/-/.test(a0)&amp;&amp;a0!=&quot;&quot;?&quot;tl-&quot;+a0:a0||&quot;tl-bl&quot;)).toLowerCase();var bc=this,a9=bc.dom,be,bd,aT,aS,aV,a7,aY,aW=C.getViewWidth(false,bf)-10,a8=C.getViewHeight(false,bf)-10,E,aP,aQ,aR,aX,aZ,bb=bf.documentElement,aU=bf.body,a6=(bb.scrollLeft||aU.scrollLeft||0)+5,a5=(bb.scrollTop||aU.scrollTop||0)+5,ba=false,aN=&quot;&quot;,A=&quot;&quot;,a4=a0.match(/^([a-z]+)-([a-z]+)(\?)?$/);if(!a4){throw&quot;Element.getAlignToXY with an invalid alignment &quot;+a0}aN=a4[1];A=a4[2];ba=!!a4[3];be=bc.getAnchorXY(aN,true);bd=aO.getAnchorXY(A,false);aT=bd[0]-be[0]+a3[0];aS=bd[1]-be[1]+a3[1];if(ba){aV=bc.getWidth();a7=bc.getHeight();aY=aO.getRegion();E=aN.charAt(0);aP=aN.charAt(aN.length-1);aQ=A.charAt(0);aR=A.charAt(A.length-1);aX=((E==&quot;t&quot;&amp;&amp;aQ==&quot;b&quot;)||(E==&quot;b&quot;&amp;&amp;aQ==&quot;t&quot;));aZ=((aP==&quot;r&quot;&amp;&amp;aR==&quot;l&quot;)||(aP==&quot;l&quot;&amp;&amp;aR==&quot;r&quot;));if(aT+aV&gt;aW+a6){aT=aZ?aY.left-aV:aW+a6-aV}if(aT&lt;a6){aT=aZ?aY.right:a6}if(aS+a7&gt;a8+a5){aS=aX?aY.top-a7:a8+a5-a7}if(aS&lt;a5){aS=aX?aY.bottom:a5}}return[aT,aS]},adjustForConstraints:function(aN,A,E){return this.getConstrainToXY(A||this.getDocument(),false,E,aN)||aN},getConstrainToXY:function(E,A,aN,aP){var aO={top:0,left:0,bottom:0,right:0};return function(aR,aZ,aS,aQ){var a1=this.getDocument();aR=Ext.get(aR,a1);aS=aS?Ext.applyIf(aS,aO):aO;var a0,aT,aY=0,aW=0;if(aR.dom==a1.body||aR.dom==a1){a0=C.getViewWidth(false,a1);aT=C.getViewHeight(false,a1)}else{a0=aR.dom.clientWidth;aT=aR.dom.clientHeight;if(!aZ){var aU=aR.getXY();aY=aU[0];aW=aU[1]}}var a4=aR.getScroll();aY+=aS.left+a4.left;aW+=aS.top+a4.top;a0-=aS.right;aT-=aS.bottom;var a3=aY+a0,aV=aW+aT,a2=aQ||(!aZ?this.getXY():[this.getLeft(true),this.getTop(true)]);x=a2[0],y=a2[1],offset=this.getConstrainOffset(),w=this.dom.offsetWidth+offset,h=this.dom.offsetHeight+offset;var aX=false;if((x+w)&gt;a3){x=a3-w;aX=true}if((y+h)&gt;aV){y=aV-h;aX=true}if(x&lt;aY){x=aY;aX=true}if(y&lt;aW){y=aW;aX=true}return aX?[x,y]:false}}(),getConstrainOffset:function(){return 0},getCenterXY:function(){return this.getAlignToXY(Ext.getBody(this.getDocument()),&quot;c-c&quot;)},center:function(A){return this.alignTo(A||Ext.getBody(this.getDocument()),&quot;c-c&quot;)},findParent:function(aS,aR,E){var aP=this.dom,aO=this.getDocument(),A=aO.body,aQ=0,aN;if(Ext.isGecko&amp;&amp;aJ.call(aP)==&quot;[object XULElement]&quot;){return null}aR=aR||50;if(isNaN(aR)){aN=Ext.getDom(aR,null,aO);aR=Number.MAX_VALUE}while(aP&amp;&amp;aP.nodeType==1&amp;&amp;aQ&lt;aR&amp;&amp;aP!=A&amp;&amp;aP!=aN){if(Ext.DomQuery.is(aP,aS)){return E?Ext.get(aP,aO):aP}aQ++;aP=aP.parentNode}return null},clip:function(){var A=this,E=A.dom;if(!P(E,J)){P(E,J,true);P(E,L,{o:A.getStyle(d),x:A.getStyle(Z),y:A.getStyle(Y)});A.setStyle(d,al);A.setStyle(Z,al);A.setStyle(Y,al)}return A},unclip:function(){var A=this,aN=A.dom;if(P(aN,J)){P(aN,J,false);var E=P(aN,L);if(E.o){A.setStyle(d,E.o)}if(E.x){A.setStyle(Z,E.x)}if(E.y){A.setStyle(Y,E.y)}}return A},getViewSize:function(){var aN=this.getDocument(),aO=this.dom,A=(aO==aN||aO==aN.body);if(A){var E=Ext.lib.Dom;return{width:E.getViewWidth(),height:E.getViewHeight()}}else{return{width:aO.clientWidth,height:aO.clientHeight}}},getStyleSize:function(){var aP=this,A,aO,aR=this.getDocument(),aS=this.dom,E=(aS==aR||aS==aR.body),aN=aS.style;if(E){var aQ=Ext.lib.Dom;return{width:aQ.getViewWidth(),height:aQ.getViewHeight()}}if(aN.width&amp;&amp;aN.width!=&quot;auto&quot;){A=parseFloat(aN.width);if(aP.isBorderBox()){A-=aP.getFrameWidth(&quot;lr&quot;)}}if(aN.height&amp;&amp;aN.height!=&quot;auto&quot;){aO=parseFloat(aN.height);if(aP.isBorderBox()){aO-=aP.getFrameWidth(&quot;tb&quot;)}}return{width:A||aP.getWidth(true),height:aO||aP.getHeight(true)}}});Ext.isDefined(Q.collectorThreadId)&amp;&amp;clearInterval(Q.collectorThreadId);function am(){if(!Ext.enableGarbageCollector){clearInterval(Q.collectorThreadId)}else{var A,aO,aQ,aP,aN=Ext.elCache;for(A in aN){aP=aN[A];if(aP.skipGC){continue}aO=aP.el;aQ=aO.dom;if(!aQ||!aQ.parentNode||(!aQ.offsetParent&amp;&amp;!ax.getElementById(A))){if(Ext.enableListenerCollection){Ext.EventManager.removeAll(aQ)}delete aN[A]}}if(Ext.isIE){var E={};for(A in aN){E[A]=aN[A]}Ext.elCache=Ext._documents[Ext.id(document)]=E;E=null}}}if(Ext.enableGarbageCollector){Q.collectorThreadId=setInterval(am,30000)}Ext.apply(C,{getDocument:function(aN,aO){var aP=null;try{aP=Ext.getDom(aN,null,null)}catch(E){}var A=Ext.isDocument(aP);if(A){if(aO){return Ext.isDocument(aP,aO)?aP:null}return aP}return aP?aP.ownerDocument||aP.document:null},docIsStrict:function(A){return(Ext.isDocument(A)?A:this.getDocument(A)).compatMode==&quot;CSS1Compat&quot;},getViewWidth:Ext.overload([C.getViewWidth||function(A){},function(){return this.getViewWidth(false)},function(A,E){return A?this.getDocumentWidth(E):this.getViewportWidth(E)}]),getViewHeight:Ext.overload([C.getViewHeight||function(A){},function(){return this.getViewHeight(false)},function(A,E){return A?this.getDocumentHeight(E):this.getViewportHeight(E)}]),getDocumentHeight:Ext.overload([C.getDocumentHeight||B,function(A){if(A=this.getDocument(A)){return Math.max(!this.docIsStrict(A)?A.body.scrollHeight:A.documentElement.scrollHeight,this.getViewportHeight(A))}return undefined}]),getDocumentWidth:Ext.overload([C.getDocumentWidth||B,function(A){if(A=this.getDocument(A)){return Math.max(!this.docIsStrict(A)?A.body.scrollWidth:A.documentElement.scrollWidth,this.getViewportWidth(A))}return undefined}]),getViewportHeight:Ext.overload([C.getViewportHeight||B,function(A){if(A=this.getDocument(A)){if(Ext.isIE){return this.docIsStrict(A)?A.documentElement.clientHeight:A.body.clientHeight}else{return A.defaultView.innerHeight}}return undefined}]),getViewportWidth:Ext.overload([C.getViewportWidth||B,function(A){if(A=this.getDocument(A)){return !this.docIsStrict(A)&amp;&amp;!Ext.isOpera?A.body.clientWidth:Ext.isIE?A.documentElement.clientWidth:A.defaultView.innerWidth}return undefined}]),getXY:Ext.overload([C.getXY||B,function(A,aO){A=Ext.getDom(A,null,aO);var aN=this.getDocument(A),E=aN?(aN.body||aN.documentElement):null;if(!A||!E||A==E){return[0,0]}return this.getXY(A)}])});var e=C.getDocument,U=Q._flyweights;Ext.fly=Q.fly=function(aN,A,aO){var E=null;A=A||&quot;_global&quot;;if(aN=Ext.getDom(aN,null,aO)){(E=U[A]=(U[A]||new Q.Flyweight())).dom=aN;Ext.isDocument(aN)&amp;&amp;(E._isDoc=true)}return E};var aG=function(){};aG.prototype=Q.prototype;Q.Flyweight=function(A){this.dom=A};Q.Flyweight.prototype=new aG();Q.Flyweight.prototype.isFlyweight=true;function b(aO,aQ,aT,aP,aN,aV){aO=Ext.getDom(aO);if(!aO){return}var E=Ext.id(aO),A=aa(aO);A[E]||Q.addToCache(aO,E,A);var aU=A[E].events||{},aR;aR=at.on(aO,aQ,aN);aU[aQ]=aU[aQ]||[];aU[aQ].push([aT,aN,aV,aR,aP]);if(aO.addEventListener&amp;&amp;aQ==&quot;mousewheel&quot;){var aS=[&quot;DOMMouseScroll&quot;,aN,false];aO.addEventListener.apply(aO,aS);Ext.EventManager.addListener(window,&quot;beforeunload&quot;,function(){aO.removeEventListener.apply(aO,aS)})}if(aQ==&quot;mousedown&quot;&amp;&amp;ax==aO){Ext.EventManager.stoppedMouseDownEvent.addListener(aN)}}function k(A,E){return function(){var aN=Ext.toArray(arguments);if(E.target==Ext.EventObject.setEvent(aN[0]).target){A.apply(this,aN)}}}function ai(E,aN,A){return function(aO){A.delay(aN.buffer,E,null,[new Ext.EventObjectImpl(aO)])}}function ac(aP,aO,A,aN,E){return function(aQ){Ext.EventManager.removeListener(aO,A,aN,E);aP(aQ)}}function a(E,aN,A){return function(aP){var aO=new Ext.util.DelayedTask(E);(A.tasks||(A.tasks=[])).push(aO);aO.delay(aN.delay||10,E,null,[new Ext.EventObjectImpl(aP)])}}function ab(aQ,aP,A,aS,aT){var E=!Ext.isObject(A)?{}:A,aN=Ext.getDom(aQ),aO;aS=aS||E.fn;aT=aT||E.scope;if(!aN){throw'Error listening for &quot;'+aP+'&quot;. Element &quot;'+aQ+&quot;\&quot; doesn't exist.&quot;}function aR(aV){if(!window.Ext){return}aV=Ext.EventObject.setEvent(aV);var aU;if(E.delegate){if(!(aU=aV.getTarget(E.delegate,aN))){return}}else{aU=aV.target}if(E.stopEvent){aV.stopEvent()}if(E.preventDefault){aV.preventDefault()}if(E.stopPropagation){aV.stopPropagation()}if(E.normalized){aV=aV.browserEvent}aS.call(aT||aN,aV,aU,E)}if(E.target){aR=k(aR,E)}if(E.delay){aR=a(aR,E,aS)}if(E.single){aR=ac(aR,aN,aP,aS,aT)}if(E.buffer){aO=new Ext.util.DelayedTask(aR);aR=ai(aR,E,aO)}b(aN,aP,aS,aO,aR,aT);return aR}Ext.apply(r,{addListener:r.on=function(aN,A,aP,aO,E){if(typeof A==&quot;object&quot;){var aS=A,aQ,aR;for(aQ in aS){aR=aS[aQ];if(!ah.test(aQ)){if(Ext.isFunction(aR)){ab(aN,aQ,aS,aR,aS.scope)}else{ab(aN,aQ,aR)}}}}else{ab(aN,A,E,aP,aO)}},removeListener:r.un=function(aQ,aR,aV,aX){var E=Ext.getDom(aQ);E&amp;&amp;Ext.get(E);var aW=E?aa(E):{},aT=E&amp;&amp;((aW[E.id]||{events:{}}).events)[aR]||[],A,aP,aN,aO,aS,aU;for(aP=0,aS=aT.length;aP&lt;aS;aP++){if(Ext.isArray(aU=aT[aP])&amp;&amp;aU[0]==aV&amp;&amp;(!aX||aU[2]==aX)){aU[4]&amp;&amp;aU[4].cancel();aO=aV.tasks&amp;&amp;aV.tasks.length;if(aO){while(aO--){aV.tasks[aO].cancel()}delete aV.tasks}A=aU[1];at.un(E,aR,at.extAdapter?aU[3]:A);if(A&amp;&amp;aR==&quot;mousewheel&quot;&amp;&amp;E.addEventListener){E.removeEventListener(&quot;DOMMouseScroll&quot;,A,false)}if(A&amp;&amp;aR==&quot;mousedown&quot;&amp;&amp;ax==E){Ext.EventManager.stoppedMouseDownEvent.removeListener(A)}aT.splice(aP,1);if(aT.length===0){delete aW[E.id].events[aR]}for(aO in aW[E.id].events){return false}aW[E.id].events={};return false}}},removeAll:function(aN){if(!(aN=Ext.getDom(aN))){return}var E=aN.id,aV=aa(aN)||{},aW=aV[E]||{},aU=aW.events||{},aR,aQ,aS,aO,aT,aP,A;for(aO in aU){if(aU.hasOwnProperty(aO)){aR=aU[aO];for(aQ=0,aS=aR.length;aQ&lt;aS;aQ++){aT=aR[aQ];aT[4]&amp;&amp;aT[4].cancel();if(aT[0].tasks&amp;&amp;(aP=aT[0].tasks.length)){while(aP--){aT[0].tasks[aP].cancel()}delete aT.tasks}A=aT[1];at.un(aN,aO,at.extAdapter?aT[3]:A);if(A&amp;&amp;aN.addEventListener&amp;&amp;aO==&quot;mousewheel&quot;){aN.removeEventListener(&quot;DOMMouseScroll&quot;,A,false)}if(A&amp;&amp;ax==aN&amp;&amp;aO==&quot;mousedown&quot;){Ext.EventManager.stoppedMouseDownEvent.removeListener(A)}}}}aV[E]&amp;&amp;(aV[E].events={})},getListeners:function(aN,E){aN=Ext.getDom(aN);if(!aN){return}var aP=(Ext.get(aN)||{}).id,A=aa(aN),aO=(A[aP]||{}).events||{};return aO[E]||null},purgeElement:function(aN,A,aP){aN=Ext.getDom(aN);var E=Ext.id(aN),aS=aa(aN),aT=(aS[E]||{}).events||{},aO,aR,aQ;if(aP){if(aT.hasOwnProperty(aP)){aR=aT[aP];for(aO=0,aQ=aR.length;aO&lt;aQ;aO++){r.removeListener(aN,aP,aR[aO][0])}}}else{r.removeAll(aN)}if(A&amp;&amp;aN&amp;&amp;aN.childNodes){for(aO=0,aQ=aN.childNodes.length;aO&lt;aQ;aO++){r.purgeElement(aN.childNodes[aO],A,aP)}}}});at.getListeners=function(E,A){return Ext.EventManager.getListeners(E,A)};Ext.provide&amp;&amp;Ext.provide(&quot;multidom&quot;)})();(function(){var El=Ext.Element,ElFrame,ELD=Ext.lib.Dom,EMPTYFN=function(){},OP=Object.prototype,addListener=function(){var handler;if(window.addEventListener){handler=function F(el,eventName,fn,capture){el.addEventListener(eventName,fn,!!capture)}}else{if(window.attachEvent){handler=function F(el,eventName,fn,capture){el.attachEvent(&quot;on&quot;+eventName,fn)}}else{handler=function F(){}}}var F=null;return handler}(),removeListener=function(){var handler;if(window.removeEventListener){handler=function F(el,eventName,fn,capture){el.removeEventListener(eventName,fn,(capture))}}else{if(window.detachEvent){handler=function F(el,eventName,fn){el.detachEvent(&quot;on&quot;+eventName,fn)}}else{handler=function F(){}}}var F=null;return handler}();if(typeof ELD.getDocument!=&quot;function&quot;){alert(&quot;MIF 2.1 requires multidom support&quot;)}if(!Ext.elCache||parseInt(Ext.version.replace(/\./g,&quot;&quot;),10)&lt;311){alert(&quot;Ext Release &quot;+Ext.version+&quot; is not supported&quot;)}Ext.ns(&quot;Ext.ux.ManagedIFrame&quot;,&quot;Ext.ux.plugin&quot;);var MIM,MIF=Ext.ux.ManagedIFrame,MIFC;var frameEvents=[&quot;documentloaded&quot;,&quot;domready&quot;,&quot;focus&quot;,&quot;blur&quot;,&quot;resize&quot;,&quot;scroll&quot;,&quot;unload&quot;,&quot;scroll&quot;,&quot;exception&quot;,&quot;message&quot;,&quot;reset&quot;];var reSynthEvents=new RegExp(&quot;^(&quot;+frameEvents.join(&quot;|&quot;)+&quot;)&quot;,&quot;i&quot;);Ext.ux.ManagedIFrame.Element=Ext.extend(Ext.Element,{constructor:function(element,forceNew,doc){var d=doc||document,elCache=ELD.resolveDocumentCache(d),dom=Ext.getDom(element,false,d);if(!dom||!(/^(iframe|frame)/i).test(dom.tagName)){return null}var id=Ext.id(dom);this.dom=dom;this.id=id;(elCache[id]||(elCache[id]={el:this,events:{},data:{}})).el=this;this.dom.name||(this.dom.name=this.id);if(Ext.isIE){document.frames&amp;&amp;(document.frames[this.dom.name]||(document.frames[this.dom.name]=this.dom))}this.dom.ownerCt=this;MIM.register(this);if(!this._observable){(this._observable=new Ext.util.Observable()).addEvents(&quot;documentloaded&quot;,&quot;domready&quot;,&quot;exception&quot;,&quot;resize&quot;,&quot;message&quot;,&quot;blur&quot;,&quot;focus&quot;,&quot;unload&quot;,&quot;scroll&quot;,&quot;reset&quot;);this._observable.addEvents(&quot;_docready&quot;,&quot;_docload&quot;)}var H=Ext.isIE?&quot;onreadystatechange&quot;:&quot;onload&quot;;this.dom[H]=this.loadHandler.createDelegate(this);this.dom.onerror=this.loadHandler.createDelegate(this)},destructor:function(){this.dom[Ext.isIE?&quot;onreadystatechange&quot;:&quot;onload&quot;]=this.dom.onerror=EMPTYFN;MIM.deRegister(this);this.removeAllListeners();Ext.destroy(this.frameShim,this.DDM);this.hideMask(true);delete this.loadMask;this.reset();this.manager=null;this.dom.ownerCt=null},cleanse:function(forceReclean,deep){if(this.isCleansed&amp;&amp;forceReclean!==true){return this}var d=this.dom,n=d.firstChild,nx;while(d&amp;&amp;n){nx=n.nextSibling;deep&amp;&amp;Ext.fly(n).cleanse(forceReclean,deep);Ext.removeNode(n);n=nx}this.isCleansed=true;return this},src:null,CSS:null,manager:null,disableMessaging:true,domReadyRetries:7500,focusOnLoad:Ext.isIE,eventsFollowFrameLinks:true,remove:function(){this.destructor.apply(this,arguments);ElFrame.superclass.remove.apply(this,arguments)},getDocument:function(){return this.dom?this.dom.ownerDocument:document},submitAsTarget:function(submitCfg){var opt=submitCfg||{},D=this.getDocument(),form=Ext.getDom(opt.form?opt.form.form||opt.form:null,false,D)||Ext.DomHelper.append(D.body,{tag:&quot;form&quot;,cls:&quot;x-hidden x-mif-form&quot;,encoding:&quot;multipart/form-data&quot;}),formFly=Ext.fly(form,&quot;_dynaForm&quot;),formState={target:form.target||&quot;&quot;,method:form.method||&quot;&quot;,encoding:form.encoding||&quot;&quot;,enctype:form.enctype||&quot;&quot;,action:form.action||&quot;&quot;},encoding=opt.encoding||form.encoding,method=opt.method||form.method||&quot;POST&quot;;formFly.set({target:this.dom.name,method:method,encoding:encoding,action:opt.url||opt.action||form.action});if(method==&quot;POST&quot;||!!opt.enctype){formFly.set({enctype:opt.enctype||form.enctype||encoding})}var hiddens,hd,ps;if(opt.params&amp;&amp;(ps=Ext.isFunction(opt.params)?opt.params():opt.params)){hiddens=[];Ext.iterate(ps=typeof ps==&quot;string&quot;?Ext.urlDecode(ps,false):ps,function(n,v){Ext.fly(hd=D.createElement(&quot;input&quot;)).set({type:&quot;hidden&quot;,name:n,value:v});form.appendChild(hd);hiddens.push(hd)})}opt.callback&amp;&amp;this._observable.addListener(&quot;_docready&quot;,opt.callback,opt.scope,{single:true});this._frameAction=true;this._targetURI=location.href;this.showMask();(function(){form.submit();hiddens&amp;&amp;Ext.each(hiddens,Ext.removeNode,Ext);if(formFly.hasClass(&quot;x-mif-form&quot;)){formFly.remove()}else{formFly.set(formState)}delete El._flyweights._dynaForm;formFly=null;this.hideMask(true)}).defer(100,this);return this},resetUrl:(function(){return Ext.isIE&amp;&amp;Ext.isSecure?Ext.SSL_SECURE_URL:&quot;about:blank&quot;})(),setSrc:function(url,discardUrl,callback,scope){var src=url||this.src||this.resetUrl;var O=this._observable;this._unHook();Ext.isFunction(callback)&amp;&amp;O.addListener(&quot;_docload&quot;,callback,scope||this,{single:true});this.showMask();(discardUrl!==true)&amp;&amp;(this.src=src);var s=this._targetURI=(Ext.isFunction(src)?src()||&quot;&quot;:src);try{this._frameAction=true;this.dom.src=s;this.checkDOM()}catch(ex){O.fireEvent.call(O,&quot;exception&quot;,this,ex)}return this},setLocation:function(url,discardUrl,callback,scope){var src=url||this.src||this.resetUrl;var O=this._observable;this._unHook();Ext.isFunction(callback)&amp;&amp;O.addListener(&quot;_docload&quot;,callback,scope||this,{single:true});this.showMask();var s=this._targetURI=(Ext.isFunction(src)?src()||&quot;&quot;:src);if(discardUrl!==true){this.src=src}try{this._frameAction=true;this.getWindow().location.replace(s);this.checkDOM()}catch(ex){O.fireEvent.call(O,&quot;exception&quot;,this,ex)}return this},reset:function(src,callback,scope){this._unHook();var loadMaskOff=false,s=src,win=this.getWindow(),O=this._observable;if(this.loadMask){loadMaskOff=this.loadMask.disabled;this.loadMask.disabled=false}this.hideMask(true);if(win){this.isReset=true;var cb=callback;O.addListener(&quot;_docload&quot;,function(frame){if(this.loadMask){this.loadMask.disabled=loadMaskOff}Ext.isFunction(cb)&amp;&amp;(cb=cb.apply(scope||this,arguments));O.fireEvent(&quot;reset&quot;,this)},this,{single:true});Ext.isFunction(s)&amp;&amp;(s=src());s=this._targetURI=Ext.isEmpty(s,true)?this.resetUrl:s;win.location?(win.location.href=s):O.fireEvent(&quot;_docload&quot;,this)}return this},scriptRE:/(?:&lt;script.*?&gt;)((\n|\r|.)*?)(?:&lt;\/script&gt;)/gi,update:function(content,loadScripts,callback,scope){loadScripts=loadScripts||this.getUpdater().loadScripts||false;content=Ext.DomHelper.markup(content||&quot;&quot;);content=loadScripts===true?content:content.replace(this.scriptRE,&quot;&quot;);var doc;if((doc=this.getFrameDocument())&amp;&amp;!!content.length){this._unHook();this.src=null;this.showMask();Ext.isFunction(callback)&amp;&amp;this._observable.addListener(&quot;_docload&quot;,callback,scope||this,{single:true});this._targetURI=location.href;doc.open();this._frameAction=true;doc.write(content);doc.close();this.checkDOM()}else{this.hideMask(true);Ext.isFunction(callback)&amp;&amp;callback.call(scope,this)}return this},execCommand:function(command,userInterface,value,validate){var doc,assert;if((doc=this.getFrameDocument())&amp;&amp;!!command){try{Ext.isIE&amp;&amp;this.getWindow().focus();assert=validate&amp;&amp;Ext.isFunction(doc.queryCommandEnabled)?doc.queryCommandEnabled(command):true;return assert&amp;&amp;doc.execCommand(command,!!userInterface,value)}catch(eex){return false}}return false},setDesignMode:function(active){var doc;(doc=this.getFrameDocument())&amp;&amp;(doc.designMode=(/on|true/i).test(String(active))?&quot;on&quot;:&quot;off&quot;)},getUpdater:function(){return this.updateManager||(this.updateManager=new MIF.Updater(this))},getHistory:function(){var h=null;try{h=this.getWindow().history}catch(eh){}return h},get:function(el){var doc=this.getFrameDocument();return doc?Ext.get(el,doc):doc=null},fly:function(el,named){var doc=this.getFrameDocument();return doc?Ext.fly(el,named,doc):null},getDom:function(el){var d;if(!el||!(d=this.getFrameDocument())){return(d=null)}return Ext.getDom(el,d)},select:function(selector,unique){var d;return(d=this.getFrameDocument())?Ext.Element.select(selector,unique,d):d=null},query:function(selector){var d;return(d=this.getFrameDocument())?Ext.DomQuery.select(selector,d):null},removeNode:Ext.removeNode,_renderHook:function(){this._windowContext=null;this.CSS=this.CSS?this.CSS.destroy():null;this._hooked=false;try{if(this.writeScript('(function(){(window.hostMIF = parent.document.getElementById(&quot;'+this.id+'&quot;).ownerCt)._windowContext='+(Ext.isIE?&quot;window&quot;:'{eval:function(s){return new Function(&quot;return (&quot;+s+&quot;)&quot;)();}}')+&quot;;})()&quot;)){var w,p=this._frameProxy,D=this.getFrameDocument();if(w=this.getWindow()){p||(p=this._frameProxy=this._eventProxy.createDelegate(this));addListener(w,&quot;focus&quot;,p);addListener(w,&quot;blur&quot;,p);addListener(w,&quot;resize&quot;,p);addListener(w,&quot;unload&quot;,p);D&amp;&amp;addListener(Ext.isIE?w:D,&quot;scroll&quot;,p)}D&amp;&amp;(this.CSS=new Ext.ux.ManagedIFrame.CSS(D))}}catch(ex){}return this.domWritable()},_unHook:function(){if(this._hooked){this._windowContext&amp;&amp;(this._windowContext.hostMIF=null);this._windowContext=null;var w,p=this._frameProxy;if(p&amp;&amp;this.domWritable()&amp;&amp;(w=this.getWindow())){removeListener(w,&quot;focus&quot;,p);removeListener(w,&quot;blur&quot;,p);removeListener(w,&quot;resize&quot;,p);removeListener(w,&quot;unload&quot;,p);removeListener(Ext.isIE?w:this.getFrameDocument(),&quot;scroll&quot;,p)}}ELD.clearDocumentCache&amp;&amp;ELD.clearDocumentCache(this.id);this.CSS=this.CSS?this.CSS.destroy():null;this.domFired=this._frameAction=this.domReady=this._hooked=false},_windowContext:null,getFrameDocument:function(){var win=this.getWindow(),doc=null;try{doc=(Ext.isIE&amp;&amp;win?win.document:null)||this.dom.contentDocument||window.frames[this.dom.name].document||null}catch(gdEx){ELD.clearDocumentCache&amp;&amp;ELD.clearDocumentCache(this.id);return false}doc=(doc&amp;&amp;Ext.isFunction(ELD.getDocument))?ELD.getDocument(doc,true):doc;return doc},getDoc:function(){var D=this.getFrameDocument();return Ext.get(D,D)},getBody:function(){var d;return(d=this.getFrameDocument())?this.get(d.body||d.documentElement):null},getDocumentURI:function(){var URI,d;try{URI=this.src&amp;&amp;(d=this.getFrameDocument())?d.location.href:null}catch(ex){}return URI||(Ext.isFunction(this.src)?this.src():this.src)},getWindowURI:function(){var URI,w;try{URI=(w=this.getWindow())?w.location.href:null}catch(ex){}return URI||(Ext.isFunction(this.src)?this.src():this.src)},getWindow:function(){var dom=this.dom,win=null;try{win=dom.contentWindow||window.frames[dom.name]||null}catch(gwEx){}return win},scrollChildIntoView:function(child,container,hscroll){this.fly(child,&quot;_scrollChildIntoView&quot;).scrollIntoView(this.getDom(container)||this.getBody().dom,hscroll);return this},print:function(){try{var win;if(win=this.getWindow()){Ext.isIE&amp;&amp;win.focus();win.print()}}catch(ex){throw new MIF.Error(&quot;printexception&quot;,ex.description||ex.message||ex)}return this},domWritable:function(){return !!Ext.isDocument(this.getFrameDocument(),true)&amp;&amp;!!this._windowContext},execScript:function(block,useDOM){try{if(this.domWritable()){if(useDOM){this.writeScript(block)}else{return this._windowContext.eval(block)}}else{throw new MIF.Error(&quot;execscript-secure-context&quot;)}}catch(ex){this._observable.fireEvent.call(this._observable,&quot;exception&quot;,this,ex);return false}return true},writeScript:function(block,attributes){attributes=Ext.apply({},attributes||{},{type:&quot;text/javascript&quot;,text:block});try{var head,script,doc=this.getFrameDocument();if(doc&amp;&amp;typeof doc.getElementsByTagName!=&quot;undefined&quot;){if(!(head=doc.getElementsByTagName(&quot;head&quot;)[0])){head=doc.createElement(&quot;head&quot;);doc.getElementsByTagName(&quot;html&quot;)[0].appendChild(head)}if(head&amp;&amp;(script=doc.createElement(&quot;script&quot;))){for(var attrib in attributes){if(attributes.hasOwnProperty(attrib)&amp;&amp;attrib in script){script[attrib]=attributes[attrib]}}return !!head.appendChild(script)}}}catch(ex){this._observable.fireEvent.call(this._observable,&quot;exception&quot;,this,ex)}finally{script=head=null}return false},loadFunction:function(fn,useDOM,invokeIt){var name=fn.name||fn;var fnSrc=fn.fn||window[fn];name&amp;&amp;fnSrc&amp;&amp;this.execScript(name+&quot;=&quot;+fnSrc,useDOM);invokeIt&amp;&amp;this.execScript(name+&quot;()&quot;)},loadHandler:function(e,target){var rstatus=(this.dom||{}).readyState||(e||{}).type;if(this.eventsFollowFrameLinks||this._frameAction||this.isReset){switch(rstatus){case&quot;domready&quot;:case&quot;DOMFrameContentLoaded&quot;:case&quot;domfail&quot;:this._onDocReady(rstatus);break;case&quot;load&quot;:case&quot;complete&quot;:this._onDocLoaded(rstatus);break;case&quot;error&quot;:this._observable.fireEvent.apply(this._observable,[&quot;exception&quot;,this].concat(arguments));break;default:}this.frameState=rstatus}},_onDocReady:function(eventName){var w,obv=this._observable,D;if(!this.isReset&amp;&amp;this.focusOnLoad&amp;&amp;(w=this.getWindow())){w.focus()}obv.fireEvent(&quot;_docready&quot;,this);(D=this.getDoc())&amp;&amp;(D.isReady=true);if(!this.domFired&amp;&amp;(this._hooked=this._renderHook())){this.domFired=true;this.isReset||obv.fireEvent.call(obv,&quot;domready&quot;,this)}this.domReady=true;this.hideMask()},_onDocLoaded:function(eventName){var obv=this._observable,w;this.domReady||this._onDocReady(&quot;domready&quot;);obv.fireEvent(&quot;_docload&quot;,this);this.isReset||obv.fireEvent(&quot;documentloaded&quot;,this);this.hideMask(true);this._frameAction=this.isReset=false},checkDOM:function(win){if(Ext.isGecko){return}var n=0,frame=this,domReady=false,b,l,d,max=this.domReadyRetries||2500,polling=false,startLocation=(this.getFrameDocument()||{location:{}}).location.href;(function(){d=frame.getFrameDocument()||{location:{}};polling=(d.location.href!==startLocation||d.location.href===frame._targetURI);if(frame.domReady){return}domReady=polling&amp;&amp;((b=frame.getBody())&amp;&amp;!!(b.dom.innerHTML||&quot;&quot;).length)||false;if(d.location.href&amp;&amp;!domReady&amp;&amp;(++n&lt;max)){setTimeout(arguments.callee,2);return}frame.loadHandler({type:domReady?&quot;domready&quot;:&quot;domfail&quot;})})()},filterEventOptionsRe:/^(?:scope|delay|buffer|single|stopEvent|preventDefault|stopPropagation|normalized|args|delegate)$/,addListener:function(eventName,fn,scope,options){if(typeof eventName==&quot;object&quot;){var o=eventName;for(var e in o){if(this.filterEventOptionsRe.test(e)){continue}if(typeof o[e]==&quot;function&quot;){this.addListener(e,o[e],o.scope,o)}else{this.addListener(e,o[e].fn,o[e].scope,o[e])}}return}if(reSynthEvents.test(eventName)){var O=this._observable;if(O){O.events[eventName]||(O.addEvents(eventName));O.addListener.call(O,eventName,fn,scope||this,options)}}else{ElFrame.superclass.addListener.call(this,eventName,fn,scope||this,options)}return this},removeListener:function(eventName,fn,scope){var O=this._observable;if(reSynthEvents.test(eventName)){O&amp;&amp;O.removeListener.call(O,eventName,fn,scope||this,options)}else{ElFrame.superclass.removeListener.call(this,eventName,fn,scope||this)}return this},removeAllListeners:function(){Ext.EventManager.removeAll(this.dom);var O=this._observable;O&amp;&amp;O.purgeListeners.call(this._observable);return this},showMask:function(msg,msgCls,maskCls){var lmask=this.loadMask;if(lmask&amp;&amp;!lmask.disabled){this.mask(msg||lmask.msg,msgCls||lmask.msgCls,maskCls||lmask.maskCls,lmask.maskEl)}},hideMask:function(forced){var tlm=this.loadMask||{};if(forced||(tlm.hideOnReady&amp;&amp;this.domReady)){this.unmask()}},mask:function(msg,msgCls,maskCls,maskEl){this._mask&amp;&amp;this.unmask();var p=Ext.get(maskEl)||this.parent(&quot;.ux-mif-mask-target&quot;)||this.parent();if(p.getStyle(&quot;position&quot;)==&quot;static&quot;&amp;&amp;!p.select(&quot;iframe,frame,object,embed&quot;).elements.length){p.addClass(&quot;x-masked-relative&quot;)}p.addClass(&quot;x-masked&quot;);this._mask=Ext.DomHelper.append(p,{cls:maskCls||&quot;ux-mif-el-mask&quot;},true);this._mask.setDisplayed(true);this._mask._agent=p;if(typeof msg==&quot;string&quot;){this._maskMsg=Ext.DomHelper.append(p,{cls:msgCls||&quot;ux-mif-el-mask-msg&quot;,style:{visibility:&quot;hidden&quot;},cn:{tag:&quot;div&quot;,html:msg}},true);this._maskMsg.setVisibilityMode(Ext.Element.VISIBILITY).center(p).setVisible(true)}if(Ext.isIE&amp;&amp;!(Ext.isIE7&amp;&amp;Ext.isStrict)&amp;&amp;this.getStyle(&quot;height&quot;)==&quot;auto&quot;){this._mask.setSize(undefined,this._mask.getHeight())}return this._mask},unmask:function(){var a;if(this._mask){(a=this._mask._agent)&amp;&amp;a.removeClass([&quot;x-masked-relative&quot;,&quot;x-masked&quot;]);if(this._maskMsg){this._maskMsg.remove();delete this._maskMsg}this._mask.remove();delete this._mask}},createFrameShim:function(imgUrl,shimCls){this.shimCls=shimCls||this.shimCls||&quot;ux-mif-shim&quot;;this.frameShim||(this.frameShim=this.next(&quot;.&quot;+this.shimCls)||Ext.DomHelper.append(this.dom.parentNode,{tag:&quot;img&quot;,src:imgUrl||Ext.BLANK_IMAGE_URL,cls:this.shimCls,galleryimg:&quot;no&quot;},true));this.frameShim&amp;&amp;(this.frameShim.autoBoxAdjust=false);return this.frameShim},toggleShim:function(show){var shim=this.frameShim||this.createFrameShim();var cls=this.shimCls+&quot;-on&quot;;!show&amp;&amp;shim.removeClass(cls);show&amp;&amp;!shim.hasClass(cls)&amp;&amp;shim.addClass(cls)},load:function(loadCfg){var um;if(um=this.getUpdater()){if(loadCfg&amp;&amp;loadCfg.renderer){um.setRenderer(loadCfg.renderer);delete loadCfg.renderer}um.update.apply(um,arguments)}return this},_eventProxy:function(e){if(!e){return}e=Ext.EventObject.setEvent(e);var be=e.browserEvent||e,er,args=[e.type,this];if(!be.eventPhase||(be.eventPhase==(be.AT_TARGET||2))){if(e.type==&quot;resize&quot;){var doc=this.getFrameDocument();doc&amp;&amp;(args.push({height:ELD.getDocumentHeight(doc),width:ELD.getDocumentWidth(doc)},{height:ELD.getViewportHeight(doc),width:ELD.getViewportWidth(doc)},{height:ELD.getViewHeight(false,doc),width:ELD.getViewWidth(false,doc)}))}er=this._observable?this._observable.fireEvent.apply(this._observable,args.concat(Array.prototype.slice.call(arguments,0))):null;(e.type==&quot;unload&quot;)&amp;&amp;this._unHook()}return er},sendMessage:function(message,tag,origin){},postMessage:function(message,origin){}});ElFrame=Ext.Element.IFRAME=Ext.Element.FRAME=Ext.ux.ManagedIFrame.Element;var fp=ElFrame.prototype;Ext.override(ElFrame,{on:fp.addListener,un:fp.removeListener,getUpdateManager:fp.getUpdater});Ext.ux.ManagedIFrame.ComponentAdapter=function(){};Ext.ux.ManagedIFrame.ComponentAdapter.prototype={version:2.12,defaultSrc:null,unsupportedText:&quot;Inline frames are NOT enabled/supported by your browser.&quot;,hideMode:!Ext.isIE&amp;&amp;!!Ext.ux.plugin.VisibilityMode?&quot;nosize&quot;:&quot;display&quot;,animCollapse:Ext.isIE,animFloat:Ext.isIE,disableMessaging:true,eventsFollowFrameLinks:true,frameConfig:null,focusOnLoad:Ext.isIE,frameEl:null,useShim:false,autoScroll:true,autoLoad:null,getId:function(){return this.id||(this.id=&quot;mif-comp-&quot;+(++Ext.Component.AUTO_ID))},stateEvents:[&quot;documentloaded&quot;],stateful:false,setAutoScroll:function(auto){var scroll=Ext.value(auto,this.autoScroll===true);this.rendered&amp;&amp;this.getFrame()&amp;&amp;this.frameEl.setOverflow((this.autoScroll=scroll)?&quot;auto&quot;:&quot;hidden&quot;);return this},getContentTarget:function(){return this.getFrame()},getFrame:function(){if(this.rendered){if(this.frameEl){return this.frameEl}var f=this.items&amp;&amp;this.items.first?this.items.first():null;f&amp;&amp;(this.frameEl=f.frameEl);return this.frameEl}return null},getFrameWindow:function(){return this.getFrame()?this.frameEl.getWindow():null},getFrameDocument:function(){return this.getFrame()?this.frameEl.getFrameDocument():null},getFrameDoc:function(){return this.getFrame()?this.frameEl.getDoc():null},getFrameBody:function(){return this.getFrame()?this.frameEl.getBody():null},resetFrame:function(){this.getFrame()&amp;&amp;this.frameEl.reset.apply(this.frameEl,arguments);return this},submitAsTarget:function(submitCfg){this.getFrame()&amp;&amp;this.frameEl.submitAsTarget.apply(this.frameEl,arguments);return this},load:function(loadCfg){if(loadCfg&amp;&amp;this.getFrame()){var args=arguments;this.resetFrame(null,function(){loadCfg.submitAsTarget?this.submitAsTarget.apply(this,args):this.frameEl.load.apply(this.frameEl,args)},this)}this.autoLoad=loadCfg;return this},doAutoLoad:function(){this.autoLoad&amp;&amp;this.load(typeof this.autoLoad==&quot;object&quot;?this.autoLoad:{url:this.autoLoad})},getUpdater:function(){return this.getFrame()?this.frameEl.getUpdater():null},setSrc:function(url,discardUrl,callback,scope){this.getFrame()&amp;&amp;this.frameEl.setSrc.apply(this.frameEl,arguments);return this},setLocation:function(url,discardUrl,callback,scope){this.getFrame()&amp;&amp;this.frameEl.setLocation.apply(this.frameEl,arguments);return this},getState:function(){var URI=this.getFrame()?this.frameEl.getDocumentURI()||null:null;var state=this.supr().getState.call(this);state=Ext.apply(state||{},{defaultSrc:Ext.isFunction(URI)?URI():URI,autoLoad:this.autoLoad});return state},setMIFEvents:function(){this.addEvents(&quot;documentloaded&quot;,&quot;domready&quot;,&quot;exception&quot;,&quot;message&quot;,&quot;blur&quot;,&quot;focus&quot;,&quot;scroll&quot;,&quot;resize&quot;,&quot;unload&quot;,&quot;reset&quot;)},sendMessage:function(message,tag,origin){},onAdd:function(C){C.relayTarget&amp;&amp;this.suspendEvents(true)},initRef:function(){if(this.ref){var t=this,levels=this.ref.split(&quot;/&quot;),l=levels.length,i;for(i=0;i&lt;l;i++){if(t.ownerCt){t=t.ownerCt}}this.refName=levels[--i];t[this.refName]||(t[this.refName]=this);this.refOwner=t}}};Ext.ux.ManagedIFrame.Component=Ext.extend(Ext.BoxComponent,{ctype:&quot;Ext.ux.ManagedIFrame.Component&quot;,initComponent:function(){var C={monitorResize:this.monitorResize||(this.monitorResize=!!this.fitToParent),plugins:(this.plugins||[]).concat(this.hideMode===&quot;nosize&quot;&amp;&amp;Ext.ux.plugin.VisibilityMode?[new Ext.ux.plugin.VisibilityMode({hideMode:&quot;nosize&quot;,elements:[&quot;bwrap&quot;]})]:[])};MIF.Component.superclass.initComponent.call(Ext.apply(this,Ext.apply(this.initialConfig,C)));this.setMIFEvents()},onRender:function(ct,position){var frCfg=this.frameCfg||this.frameConfig||(this.relayTarget?{name:this.relayTarget.id}:{})||{};var frDOM=frCfg.autoCreate||frCfg;frDOM=Ext.apply({tag:&quot;iframe&quot;,id:Ext.id()},frDOM);var el=Ext.getDom(this.el);(el&amp;&amp;el.tagName==&quot;iframe&quot;)||(this.autoEl=Ext.apply({name:frDOM.id,frameborder:0},frDOM));MIF.Component.superclass.onRender.apply(this,arguments);if(this.unsupportedText){ct.child(&quot;noframes&quot;)||ct.createChild({tag:&quot;noframes&quot;,html:this.unsupportedText||null})}var frame=this.el;var F;if(F=this.frameEl=(this.el?new MIF.Element(this.el.dom,true):null)){Ext.apply(F,{ownerCt:this.relayTarget||this,disableMessaging:Ext.value(this.disableMessaging,true),focusOnLoad:Ext.value(this.focusOnLoad,Ext.isIE),eventsFollowFrameLinks:Ext.value(this.eventsFollowFrameLinks,true)});F.ownerCt.frameEl=F;F.addClass(&quot;ux-mif&quot;);if(this.loadMask){var mEl=this.loadMask.maskEl;F.loadMask=Ext.apply({disabled:false,hideOnReady:false,msgCls:&quot;ext-el-mask-msg x-mask-loading&quot;,maskCls:&quot;ext-el-mask&quot;},{maskEl:F.ownerCt[String(mEl)]||F.parent(&quot;.&quot;+String(mEl))||F.parent(&quot;.ux-mif-mask-target&quot;)||mEl},Ext.isString(this.loadMask)?{msg:this.loadMask}:this.loadMask);Ext.get(F.loadMask.maskEl)&amp;&amp;Ext.get(F.loadMask.maskEl).addClass(&quot;ux-mif-mask-target&quot;)}F._observable&amp;&amp;(this.relayTarget||this).relayEvents(F._observable,frameEvents.concat(this._msgTagHandlers||[]));delete this.contentEl}},afterRender:function(container){MIF.Component.superclass.afterRender.apply(this,arguments);if(this.fitToParent&amp;&amp;!this.ownerCt){var pos=this.getPosition(),size=(Ext.get(this.fitToParent)||this.getEl().parent()).getViewSize();this.setSize(size.width-pos[0],size.height-pos[1])}this.getEl().setOverflow(&quot;hidden&quot;);this.setAutoScroll();var F;if(F=this.frameEl){var ownerCt=this.ownerCt;while(ownerCt){ownerCt.on(&quot;afterlayout&quot;,function(container,layout){Ext.each([&quot;north&quot;,&quot;south&quot;,&quot;east&quot;,&quot;west&quot;],function(region){var reg;if((reg=layout[region])&amp;&amp;reg.split&amp;&amp;reg.split.dd&amp;&amp;!reg._splitTrapped){reg.split.dd.endDrag=reg.split.dd.endDrag.createSequence(MIM.hideShims,MIM);reg.split.on(&quot;beforeresize&quot;,MIM.showShims,MIM);reg._splitTrapped=MIM._splitTrapped=true}},this)},this,{single:true});ownerCt=ownerCt.ownerCt}if(!!this.ownerCt||this.useShim){this.frameShim=F.createFrameShim()}this.getUpdater().showLoadIndicator=this.showLoadIndicator||false;var resumeEvents=this.relayTarget&amp;&amp;this.ownerCt?this.ownerCt.resumeEvents.createDelegate(this.ownerCt):null;if(this.autoload){this.doAutoLoad()}else{if(this.frameMarkup||this.html){F.update(this.frameMarkup||this.html,true,resumeEvents);delete this.html;delete this.frameMarkup;return}else{if(this.defaultSrc){F.setSrc(this.defaultSrc,false)}else{F.reset(null,resumeEvents);return}}}resumeEvents&amp;&amp;resumeEvents()}},beforeDestroy:function(){var F;if(F=this.getFrame()){F.remove();this.frameEl=this.frameShim=null}this.relayTarget&amp;&amp;(this.relayTarget.frameEl=null);MIF.Component.superclass.beforeDestroy.call(this)}});Ext.override(MIF.Component,MIF.ComponentAdapter.prototype);Ext.reg(&quot;mif&quot;,MIF.Component);function embed_MIF(config){config||(config={});config.layout=&quot;fit&quot;;config.items={xtype:&quot;mif&quot;,ref:&quot;mifChild&quot;,useShim:true,autoScroll:Ext.value(config.autoScroll,this.autoScroll),defaultSrc:Ext.value(config.defaultSrc,this.defaultSrc),frameMarkup:Ext.value(config.html,this.html),loadMask:Ext.value(config.loadMask,this.loadMask),disableMessaging:Ext.value(config.disableMessaging,this.disableMessaging),eventsFollowFrameLinks:Ext.value(config.eventsFollowFrameLinks,this.eventsFollowFrameLinks),focusOnLoad:Ext.value(config.focusOnLoad,this.focusOnLoad),frameConfig:Ext.value(config.frameConfig||config.frameCfg,this.frameConfig),relayTarget:this};delete config.html;this.setMIFEvents();return config}Ext.ux.ManagedIFrame.Panel=Ext.extend(Ext.Panel,{ctype:&quot;Ext.ux.ManagedIFrame.Panel&quot;,bodyCssClass:&quot;ux-mif-mask-target&quot;,constructor:function(config){MIF.Panel.superclass.constructor.call(this,embed_MIF.call(this,config))}});Ext.override(MIF.Panel,MIF.ComponentAdapter.prototype);Ext.reg(&quot;iframepanel&quot;,MIF.Panel);Ext.ux.ManagedIFrame.Portlet=Ext.extend(Ext.ux.ManagedIFrame.Panel,{ctype:&quot;Ext.ux.ManagedIFrame.Portlet&quot;,anchor:&quot;100%&quot;,frame:true,collapseEl:&quot;bwrap&quot;,collapsible:true,draggable:true,cls:&quot;x-portlet&quot;});Ext.reg(&quot;iframeportlet&quot;,MIF.Portlet);Ext.ux.ManagedIFrame.Window=Ext.extend(Ext.Window,{ctype:&quot;Ext.ux.ManagedIFrame.Window&quot;,bodyCssClass:&quot;ux-mif-mask-target&quot;,constructor:function(config){MIF.Window.superclass.constructor.call(this,embed_MIF.call(this,config))}});Ext.override(MIF.Window,MIF.ComponentAdapter.prototype);Ext.reg(&quot;iframewindow&quot;,MIF.Window);Ext.ux.ManagedIFrame.Updater=Ext.extend(Ext.Updater,{showLoading:function(){this.showLoadIndicator&amp;&amp;this.el&amp;&amp;this.el.mask(this.indicatorText)},hideLoading:function(){this.showLoadIndicator&amp;&amp;this.el&amp;&amp;this.el.unmask()},updateComplete:function(response){MIF.Updater.superclass.updateComplete.apply(this,arguments);this.hideLoading()},processFailure:function(response){MIF.Updater.superclass.processFailure.apply(this,arguments);this.hideLoading()}});var styleCamelRe=/(-[a-z])/gi;var styleCamelFn=function(m,a){return a.charAt(1).toUpperCase()};Ext.ux.ManagedIFrame.CSS=function(hostDocument){var doc;if(hostDocument){doc=hostDocument;return{rules:null,destroy:function(){return doc=null},createStyleSheet:function(cssText,id){var ss;if(!doc){return}var head=doc.getElementsByTagName(&quot;head&quot;)[0];var rules=doc.createElement(&quot;style&quot;);rules.setAttribute(&quot;type&quot;,&quot;text/css&quot;);Ext.isString(id)&amp;&amp;rules.setAttribute(&quot;id&quot;,id);if(Ext.isIE){head.appendChild(rules);ss=rules.styleSheet;ss.cssText=cssText}else{try{rules.appendChild(doc.createTextNode(cssText))}catch(e){rules.cssText=cssText}head.appendChild(rules);ss=rules.styleSheet?rules.styleSheet:(rules.sheet||doc.styleSheets[doc.styleSheets.length-1])}this.cacheStyleSheet(ss);return ss},removeStyleSheet:function(id){if(!doc||!id){return}var existing=doc.getElementById(id);if(existing){existing.parentNode.removeChild(existing)}},swapStyleSheet:function(id,url){if(!doc){return}this.removeStyleSheet(id);var ss=doc.createElement(&quot;link&quot;);ss.setAttribute(&quot;rel&quot;,&quot;stylesheet&quot;);ss.setAttribute(&quot;type&quot;,&quot;text/css&quot;);Ext.isString(id)&amp;&amp;ss.setAttribute(&quot;id&quot;,id);ss.setAttribute(&quot;href&quot;,url);doc.getElementsByTagName(&quot;head&quot;)[0].appendChild(ss)},refreshCache:function(){return this.getRules(true)},cacheStyleSheet:function(ss,media){this.rules||(this.rules={});try{Ext.each(ss.cssRules||ss.rules||[],function(rule){this.hashRule(rule,ss,media)},this);Ext.each(ss.imports||[],function(sheet){sheet&amp;&amp;this.cacheStyleSheet(sheet,this.resolveMedia([sheet,sheet.parentStyleSheet]))},this)}catch(e){}},hashRule:function(rule,sheet,mediaOverride){var mediaSelector=mediaOverride||this.resolveMedia(rule);if(rule.cssRules||rule.rules){this.cacheStyleSheet(rule,this.resolveMedia([rule,rule.parentRule]))}if(rule.styleSheet){this.cacheStyleSheet(rule.styleSheet,this.resolveMedia([rule,rule.ownerRule,rule.parentStyleSheet]))}rule.selectorText&amp;&amp;Ext.each((mediaSelector||&quot;&quot;).split(&quot;,&quot;),function(media){this.rules[((media?media.trim()+&quot;:&quot;:&quot;&quot;)+rule.selectorText).toLowerCase()]=rule},this)},resolveMedia:function(rule){var media;Ext.each([].concat(rule),function(r){if(r&amp;&amp;r.media&amp;&amp;r.media.length){media=r.media;return false}});return media?(Ext.isIE?String(media):media.mediaText):&quot;&quot;},getRules:function(refreshCache){if(!this.rules||refreshCache){this.rules={};if(doc){var ds=doc.styleSheets;for(var i=0,len=ds.length;i&lt;len;i++){try{this.cacheStyleSheet(ds[i])}catch(e){}}}}return this.rules},getRule:function(selector,refreshCache,mediaSelector){var rs=this.getRules(refreshCache);if(Ext.type(mediaSelector)==&quot;string&quot;){mediaSelector=mediaSelector.trim()+&quot;:&quot;}else{mediaSelector=&quot;&quot;}if(!Ext.isArray(selector)){return rs[(mediaSelector+selector).toLowerCase()]}var select;for(var i=0;i&lt;selector.length;i++){select=(mediaSelector+selector[i]).toLowerCase();if(rs[select]){return rs[select]}}return null},updateRule:function(selector,property,value,mediaSelector){Ext.each((mediaSelector||&quot;&quot;).split(&quot;,&quot;),function(mediaSelect){if(!Ext.isArray(selector)){var rule=this.getRule(selector,false,mediaSelect);if(rule){rule.style[property.replace(camelRe,camelFn)]=value;return true}}else{for(var i=0;i&lt;selector.length;i++){if(this.updateRule(selector[i],property,value,mediaSelect)){return true}}}return false},this)}}}};Ext.ux.ManagedIFrame.Manager=function(){var frames={};var implementation={_DOMFrameReadyHandler:function(e){try{var $frame;if($frame=e.target.ownerCt){$frame.loadHandler.call($frame,e)}}catch(rhEx){}},shimCls:&quot;ux-mif-shim&quot;,register:function(frame){frame.manager=this;frames[frame.id]=frames[frame.name]={ref:frame};return frame},deRegister:function(frame){delete frames[frame.id];delete frames[frame.name]},hideShims:function(){var mm=MIF.Manager;mm.shimsApplied&amp;&amp;Ext.select(&quot;.&quot;+mm.shimCls,true).removeClass(mm.shimCls+&quot;-on&quot;);mm.shimsApplied=false},showShims:function(){var mm=MIF.Manager;!mm.shimsApplied&amp;&amp;Ext.select(&quot;.&quot;+mm.shimCls,true).addClass(mm.shimCls+&quot;-on&quot;);mm.shimsApplied=true},getFrameById:function(id){return typeof id==&quot;string&quot;?(frames[id]?frames[id].ref||null:null):null},getFrameByName:function(name){return this.getFrameById(name)},getFrameHash:function(frame){return frames[frame.id]||frames[frame.id]||null},destroy:function(){if(document.addEventListener&amp;&amp;!Ext.isOpera){window.removeEventListener(&quot;DOMFrameContentLoaded&quot;,this._DOMFrameReadyHandler,false)}}};document.addEventListener&amp;&amp;!Ext.isOpera&amp;&amp;window.addEventListener(&quot;DOMFrameContentLoaded&quot;,implementation._DOMFrameReadyHandler,false);Ext.EventManager.on(window,&quot;beforeunload&quot;,implementation.destroy,implementation);return implementation}();MIM=MIF.Manager;MIM.showDragMask=MIM.showShims;MIM.hideDragMask=MIM.hideShims;var winDD=Ext.Window.DD;Ext.override(winDD,{startDrag:winDD.prototype.startDrag.createInterceptor(MIM.showShims),endDrag:winDD.prototype.endDrag.createInterceptor(MIM.hideShims)});Ext.ux.ManagedIFramePanel=MIF.Panel;Ext.ux.ManagedIFramePortlet=MIF.Portlet;Ext.ux.ManagedIframe=function(el,opt){var args=Array.prototype.slice.call(arguments,0),el=Ext.get(args[0]),config=args[0];if(el&amp;&amp;el.dom&amp;&amp;el.dom.tagName==&quot;IFRAME&quot;){config=args[1]||{}}else{config=args[0]||args[1]||{};el=config.autoCreate?Ext.get(Ext.DomHelper.append(config.autoCreate.parent||Ext.getBody(),Ext.apply({tag:&quot;iframe&quot;,frameborder:0,cls:&quot;x-mif&quot;,src:(Ext.isIE&amp;&amp;Ext.isSecure)?Ext.SSL_SECURE_URL:&quot;about:blank&quot;},config.autoCreate))):null;if(el&amp;&amp;config.unsupportedText){Ext.DomHelper.append(el.dom.parentNode,{tag:&quot;noframes&quot;,html:config.unsupportedText})}}var mif=new MIF.Element(el,true);if(mif){Ext.apply(mif,{disableMessaging:Ext.value(config.disableMessaging,true),focusOnLoad:Ext.value(config.focusOnLoad,Ext.isIE),eventsFollowFrameLinks:Ext.value(config.eventsFollowFrameLinks,true),loadMask:!!config.loadMask?Ext.apply({msg:&quot;Loading..&quot;,msgCls:&quot;x-mask-loading&quot;,maskEl:null,hideOnReady:false,disabled:false},config.loadMask):false,_windowContext:null});config.listeners&amp;&amp;mif.on(config.listeners);if(!!config.html){mif.update(config.html)}else{!!config.src&amp;&amp;mif.setSrc(config.src)}}return mif};Ext.ux.ManagedIFrame.Error=Ext.extend(Ext.Error,{constructor:function(message,arg){this.arg=arg;Ext.Error.call(this,message)},name:&quot;Ext.ux.ManagedIFrame&quot;});Ext.apply(Ext.ux.ManagedIFrame.Error.prototype,{lang:{&quot;documentcontext-remove&quot;:&quot;An attempt was made to remove an Element from the wrong document context.&quot;,&quot;execscript-secure-context&quot;:&quot;An attempt was made at script execution within a document context with limited access permissions.&quot;,printexception:&quot;An Error was encountered attempting the print the frame contents (document access is likely restricted).&quot;}});Ext.onReady(function(){var CSS=new Ext.ux.ManagedIFrame.CSS(document),rules=[];CSS.getRule(&quot;.ux-mif-fill&quot;)||(rules.push(&quot;.ux-mif-fill{height:100%;width:100%;}&quot;));CSS.getRule(&quot;.ux-mif-mask-target&quot;)||(rules.push(&quot;.ux-mif-mask-target{position:relative;zoom:1;}&quot;));CSS.getRule(&quot;.ux-mif-el-mask&quot;)||(rules.push(&quot;.ux-mif-el-mask {z-index: 100;position: absolute;top:0;left:0;-moz-opacity: 0.5;opacity: .50;*filter: alpha(opacity=50);width: 100%;height: 100%;zoom: 1;} &quot;,&quot;.ux-mif-el-mask-msg {z-index: 1;position: absolute;top: 0;left: 0;border:1px solid;background:repeat-x 0 -16px;padding:2px;} &quot;,&quot;.ux-mif-el-mask-msg div {padding:5px 10px 5px 10px;border:1px solid;cursor:wait;} &quot;));if(!CSS.getRule(&quot;.ux-mif-shim&quot;)){rules.push(&quot;.ux-mif-shim {z-index:8500;position:absolute;top:0px;left:0px;background:transparent!important;overflow:hidden;display:none;}&quot;);rules.push(&quot;.ux-mif-shim-on{width:100%;height:100%;display:block;zoom:1;}&quot;);rules.push(&quot;.ext-ie6 .ux-mif-shim{margin-left:5px;margin-top:3px;}&quot;)}if(!CSS.getRule(&quot;.x-hide-nosize&quot;)){rules.push(&quot;.x-hide-nosize{height:0px!important;width:0px!important;visibility:hidden!important;border:none!important;zoom:1;}.x-hide-nosize * {height:0px!important;width:0px!important;visibility:hidden!important;border:none!important;zoom:1;}&quot;)}!!rules.length&amp;&amp;CSS.createStyleSheet(rules.join(&quot; &quot;),&quot;mifCSS&quot;)});Ext.provide&amp;&amp;Ext.provide(&quot;mif&quot;)})();function utils_logout(){Ext.util.Cookies.set(&quot;userLogin&quot;,&quot;&quot;);Ext.util.Cookies.set(&quot;hashCode&quot;,&quot;&quot;);Ext.Ajax.defaultHeaders.Authorization=&quot;&quot;;window.location.reload()}Ext.namespace(&quot;sitools.widget&quot;);sitools.widget.FeedGridFlux=function(a){this.datasetName=a.datasetName;function c(r,p,n){n.stopEvent();var l=r.store.getAt(p);if(Ext.isEmpty(l)){return}if(Ext.isEmpty(window)||Ext.isEmpty(window.SitoolsDesk)){var q=new sitools.widget.feedItemDetails({record:l});var m=new Ext.Window({stateful:false,title:i18n.get(&quot;label.viewFeedDetail&quot;),width:400,height:600,shim:false,animCollapse:false,constrainHeader:true,layout:&quot;fit&quot;});m.add(q);m.show()}else{var g={record:l};var d=sitools.widget.feedItemDetails;var k={id:&quot;viewFeedDetail&quot;,title:i18n.get(&quot;label.viewFeedDetail&quot;),saveToolbar:false};SitoolsDesk.addDesktopWindow(k,g,d,true)}}Ext.apply(this);this.layout=&quot;fit&quot;;var b;if(a.feedSource!==undefined&amp;&amp;a.feedSource===&quot;OPENSEARCH&quot;){b=new sitools.user.component.openSearchResultFeed(a)}else{a.listeners={rowdblclick:c};if(a.feedType!==undefined&amp;&amp;a.feedType===&quot;atom_1.0&quot;){b=new sitools.widget.atom1FeedReader(a)}else{b=new sitools.widget.rss2FeedReader(a)}}this.items=[b];sitools.widget.FeedGridFlux.superclass.constructor.call(this)};Ext.extend(sitools.widget.FeedGridFlux,Ext.Panel,{componentType:&quot;feeds&quot;,_getSettings:function(){return(null)},border:false});Ext.reg(&quot;appfeedgridflux&quot;,sitools.widget.FeedGridFlux);Ext.namespace(&quot;sitools.widget&quot;);sitools.widget.rss2FeedReader=function(b){Ext.apply(this);this.layout=&quot;fit&quot;;var a=new Ext.data.Store({autoLoad:true,sortInfo:{field:&quot;pubDate&quot;,direction:&quot;DESC&quot;},proxy:new Ext.data.HttpProxy({url:b.urlFeed,restful:true,listeners:{scope:this,exception:onRequestFeedException}}),reader:new Ext.data.XmlReader({record:&quot;item&quot;},[&quot;title&quot;,&quot;author&quot;,{name:&quot;pubDate&quot;,type:&quot;date&quot;},&quot;link&quot;,&quot;description&quot;,&quot;content&quot;,&quot;guid&quot;,{name:&quot;imageUrl&quot;,mapping:&quot;enclosure@url&quot;},{name:&quot;imageType&quot;,mapping:&quot;enclosure@type&quot;}])});var c=[{id:&quot;image&quot;,header:&quot;Image&quot;,dataIndex:&quot;imageUrl&quot;,sortable:false,width:50,renderer:this.imageRenderer},{id:&quot;title&quot;,header:&quot;Title&quot;,dataIndex:&quot;title&quot;,sortable:true,width:420,renderer:this.formatTitle},{header:&quot;Author&quot;,dataIndex:&quot;author&quot;,width:100,hidden:true,sortable:true},{id:&quot;last&quot;,header:&quot;Date&quot;,dataIndex:&quot;pubDate&quot;,width:150,renderer:this.formatDate,sortable:true}];sitools.widget.rss2FeedReader.superclass.constructor.call(this,{columns:c,store:a,loadMask:{msg:i18n.get(&quot;label.loadingFeed&quot;)},sm:new Ext.grid.RowSelectionModel({singleSelect:true}),autoExpandColumn:&quot;title&quot;,viewConfig:{forceFit:true,enableRowBody:true,showPreview:true,getRowClass:this.applyRowClass},tbar:[{pressed:true,enableToggle:true,text:i18n.get(&quot;label.feedsSummary&quot;),icon:loadUrl.get(&quot;APP_URL&quot;)+&quot;/common/res/images/icons/summary_RSS.png&quot;,scope:this,toggleHandler:function(d,e){this.togglePreview(e)}}],listeners:b.listeners})};Ext.extend(sitools.widget.rss2FeedReader,Ext.grid.GridPanel,{loadData:function(){this.loadFeed(&quot;http://feeds.feedburner.com/extblog&quot;);this.doLayout()},loadFeed:function(a){this.store.baseParams={feed:a};this.store.load()},togglePreview:function(a){this.view.showPreview=a;this.view.refresh()},applyRowClass:function(a,e,d,c){if(this.showPreview){var b=Ext.util.Format;d.body=&quot;&lt;p class=sous-titre-flux&gt;&quot;+b.ellipsis(b.stripTags(a.data.description),200)+&quot;&lt;/p&gt;&quot;;return&quot;x-grid3-row-expanded&quot;}return&quot;x-grid3-row-collapsed&quot;},formatDate:function(b){if(!b){return&quot;&quot;}var a=new Date();var e=a.clearTime(true);var c=b.clearTime(true).getTime();if(c==e.getTime()){return&quot;Today &quot;+b.dateFormat(&quot;g:i a&quot;)}e=e.add(&quot;d&quot;,-6);if(e.getTime()&lt;=c){return b.dateFormat(&quot;D g:i a&quot;)}return b.dateFormat(&quot;n/j g:i a&quot;)},formatTitle:function(d,e,a){var c=a.data.link;var b=(Ext.isEmpty(a.data.author))?&quot;&quot;:a.data.author;if(c!==undefined&amp;&amp;c!==&quot;&quot;){return String.format('&lt;div class=&quot;topic&quot;&gt;&lt;a href=&quot;{0}&quot; target=&quot;_blank&quot;&gt;&lt;span class=&quot;rss_feed_title&quot;&gt;{1}&lt;/span&gt;&lt;/a&gt;&lt;br/&gt;&lt;span class=&quot;author&quot;&gt;{2}&lt;/span&gt;&lt;/div&gt;',c,d,b)}else{return String.format('&lt;div class=&quot;topic&quot;&gt;&lt;span class=&quot;rss_feed_title&quot;&gt;{0}&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;author&quot;&gt;{1}&lt;/span&gt;&lt;/div&gt;',d,b)}},imageRenderer:function(b,c,a){if(Ext.isEmpty(b)||Ext.isEmpty(a.data.imageType)){return&quot;&quot;}if(a.data.imageType.substr(0,5)!=&quot;image&quot;){return&quot;&quot;}return String.format('&lt;img src=&quot;{0}&quot; width=&quot;50px&quot;&gt;',b)}});Ext.namespace(&quot;sitools.widget&quot;);sitools.widget.atom1FeedReader=function(b){Ext.apply(this);this.layout=&quot;fit&quot;;var a=new Ext.data.Store({autoLoad:true,sortInfo:{field:&quot;published&quot;,direction:&quot;DESC&quot;},proxy:new Ext.data.HttpProxy({url:b.urlFeed,restful:true,listeners:{scope:this,exception:onRequestFeedException}}),reader:new Ext.data.XmlReader({record:&quot;entry&quot;},[&quot;title&quot;,{name:&quot;author&quot;,mapping:&quot;author.name&quot;},{name:&quot;published&quot;,type:&quot;date&quot;},{name:&quot;link&quot;,mapping:&quot;link@href&quot;},&quot;summary&quot;,&quot;content&quot;,{name:&quot;image&quot;,createAccessor:function(k,l){var g=Ext.DomQuery;var e=g.selectNode(&quot;link[type^=image]&quot;,k);var d={};if(Ext.isEmpty(e)){return d}Ext.each(e.attributes,function(m){d[m.name]=m.value});return d}}])});var c=[{id:&quot;image&quot;,header:&quot;Image&quot;,dataIndex:&quot;image&quot;,sortable:false,width:50,renderer:this.imageRenderer},{id:&quot;title&quot;,header:&quot;Title&quot;,dataIndex:&quot;title&quot;,sortable:true,width:420,renderer:this.formatTitle},{header:&quot;Author&quot;,dataIndex:&quot;author&quot;,width:100,hidden:true,sortable:false},{id:&quot;last&quot;,header:&quot;Date&quot;,dataIndex:&quot;published&quot;,width:150,renderer:this.formatDate,sortable:true}];sitools.widget.atom1FeedReader.superclass.constructor.call(this,{columns:c,store:a,loadMask:{msg:i18n.get(&quot;label.loadingFeed&quot;)},sm:new Ext.grid.RowSelectionModel({singleSelect:true}),autoExpandColumn:&quot;title&quot;,viewConfig:{forceFit:true,enableRowBody:true,showPreview:true,getRowClass:this.applyRowClass},tbar:[{pressed:true,enableToggle:true,text:i18n.get(&quot;label.feedsSummary&quot;),icon:loadUrl.get(&quot;APP_URL&quot;)+&quot;/common/res/images/icons/summary_RSS.png&quot;,scope:this,toggleHandler:function(d,e){this.togglePreview(e)}}],listeners:b.listeners})};Ext.extend(sitools.widget.atom1FeedReader,Ext.grid.GridPanel,{loadFeed:function(a){this.store.baseParams={feed:a};this.store.load()},togglePreview:function(a){this.view.showPreview=a;this.view.refresh()},applyRowClass:function(a,e,d,c){if(this.showPreview){var b=Ext.util.Format;d.body=&quot;&lt;p class=sous-titre-flux&gt;&quot;+b.ellipsis(b.stripTags(a.data.summary),200)+&quot;&lt;/p&gt;&quot;;return&quot;x-grid3-row-expanded&quot;}return&quot;x-grid3-row-collapsed&quot;},formatDate:function(b){if(!b){return&quot;&quot;}var a=new Date();var e=a.clearTime(true);var c=b.clearTime(true).getTime();if(c==e.getTime()){return&quot;Today &quot;+b.dateFormat(&quot;g:i a&quot;)}e=e.add(&quot;d&quot;,-6);if(e.getTime()&lt;=c){return b.dateFormat(&quot;D g:i a&quot;)}return b.dateFormat(&quot;n/j g:i a&quot;)},formatTitle:function(e,g,a){var c=(a.data.author.name!==undefined)?a.data.author.name:&quot;&quot;;var d=a.data.link;var c=(a.data.author.name!==undefined)?a.data.author.name:&quot;&quot;;var b=(a.data.author.email!==undefined)?a.data.author.email:&quot;&quot;;if(d!==undefined&amp;&amp;d!==&quot;&quot;){return String.format('&lt;div class=&quot;topic&quot;&gt;&lt;a href=&quot;{0} target=&quot;_blank&quot;&gt;&lt;span class=&quot;rss_feed_title&quot;&gt;{1}&lt;/span&gt;&lt;/a&gt;&lt;br/&gt;&lt;span class=&quot;author&quot;&gt;{2}&lt;/span&gt;&lt;/div&gt;',d,e,c)}else{return String.format('&lt;div class=&quot;topic&quot;&gt;&lt;span class=&quot;rss_feed_title&quot;&gt;{0}&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;author&quot;&gt;{1}&lt;/span&gt;&lt;/div&gt;',e,c)}},imageRenderer:function(b,c,a){if(Ext.isEmpty(b)||Ext.isEmpty(b.href)){return&quot;&quot;}if(b.type.substr(0,5)!=&quot;image&quot;){return&quot;&quot;}return String.format('&lt;img src=&quot;{0}&quot; width=&quot;50px&quot;&gt;',b.href)}});Ext.namespace(&quot;sitools.widget&quot;);sitools.widget.feedItemDetails=Ext.extend(Ext.Panel,{initComponent:function(){this.layout=&quot;fit&quot;;var a=this.record;if(!Ext.isEmpty(a)){this.formPanel=new Ext.FormPanel({frame:true,autoScroll:true,labelAlign:&quot;top&quot;});var b=[];Ext.iterate(a.data,function(c,e){var d;if(e!==null&amp;&amp;e.length&gt;100){d=new Ext.form.TextArea({fieldLabel:c,value:e,anchor:&quot;90%&quot;,readOnly:true})}else{d=new Ext.form.TextField({fieldLabel:c,value:e,anchor:&quot;90%&quot;,readOnly:true});if(c==&quot;link&quot;){Ext.apply(d,{overCls:&quot;x-mouse-link&quot;});d.addListener(&quot;render&quot;,function(g){g.getEl().on(&quot;click&quot;,function(){window.open(g.value)})})}}b.push(d)});this.formPanel.removeAll();this.formPanel.add(b);this.formPanel.doLayout();this.componentType=&quot;feedDetails&quot;;this.items=[this.formPanel]}sitools.widget.feedItemDetails.superclass.initComponent.call(this)}});Ext.namespace(&quot;Ext.ux&quot;);Ext.ux.NotificationMgr={positions:[]};Ext.ux.Notification=Ext.extend(Ext.Window,{initComponent:function(){Ext.apply(this,{iconCls:this.iconCls||&quot;x-icon-information&quot;,cls:&quot;x-notification&quot;,width:200,autoHeight:true,plain:false,draggable:false,shadow:false,bodyStyle:&quot;text-align:center&quot;});if(this.autoDestroy){this.task=new Ext.util.DelayedTask(this.hide,this)}else{this.closable=true}Ext.ux.Notification.superclass.initComponent.apply(this)},setMessage:function(a){this.body.update(a)},setTitle:function(b,a){Ext.ux.Notification.superclass.setTitle.call(this,b,a||this.iconCls)},onDestroy:function(){Ext.ux.NotificationMgr.positions.remove(this.pos);Ext.ux.Notification.superclass.onDestroy.call(this)},cancelHiding:function(){this.addClass(&quot;fixed&quot;);if(this.autoDestroy){this.task.cancel()}},afterShow:function(){Ext.ux.Notification.superclass.afterShow.call(this);Ext.fly(this.body.dom).on(&quot;click&quot;,this.cancelHiding,this);if(this.autoDestroy){this.task.delay(this.hideDelay||5000)}},animShow:function(){this.pos=0;while(Ext.ux.NotificationMgr.positions.indexOf(this.pos)&gt;-1){this.pos++}Ext.ux.NotificationMgr.positions.push(this.pos);this.setSize(200,100);this.el.alignTo(document,&quot;br-br&quot;,[-20,-40-((this.getSize().height+10)*this.pos)]);this.el.slideIn(&quot;b&quot;,{duration:1,callback:this.afterShow,scope:this})},animHide:function(){this.el.ghost(&quot;b&quot;,{duration:1,remove:false,callback:function(){Ext.ux.NotificationMgr.positions.remove(this.pos);this.destroy()}.createDelegate(this)})},focus:Ext.emptyFn});Ext.namespace(&quot;Ext.ux&quot;);Ext.namespace(&quot;Ext.ux.Plugin&quot;);Ext.ux.Plugin.LiteRemoteComponent=function(a){var c=a.xtype||&quot;panel&quot;;var b=function(d){this.container.add(Ext.ComponentMgr.create(Ext.decode(d.responseText),c)).show();this.container.doLayout()};return{init:function(d){this.container=d;Ext.Ajax.request(Ext.apply(a,{success:b,scope:this}))}}};Ext.ux.Plugin.RemoteComponent=function(a){var d=a.xtype||&quot;panel&quot;;Ext.applyIf(a,{purgeSubscribers:true});this.initialConfig=a;Ext.apply(this,a);this.addEvents({beforeload:true,beforecreate:true,beforeadd:true,beforecomponshow:true,beforecontainshow:true,success:true});Ext.ux.Plugin.RemoteComponent.superclass.constructor.call(this,a);if(a.breakOn){this.on(a.breakOn,function(){return false})}var b=function(g){if(this.fireEvent(&quot;beforeadd&quot;,g,this)){var e=this.container.add(g);e.fireEvent(&quot;bodyResize&quot;,this);if(this.fireEvent(&quot;beforecomponshow&quot;,e,this)){return e}}}.createDelegate(this);var c=function(g){var k=Ext.decode(g.responseText);if(this.fireEvent(&quot;beforecreate&quot;,k,this)){var e=null;if(k instanceof Array){Ext.each(k,function(l,m){e=b(l).show()})}else{e=b(k).show()}if(this.fireEvent(&quot;beforecontainshow&quot;,e,this)){this.container.ownerCt.doLayout();this.fireEvent(&quot;success&quot;,e,this)}}if(this.purgeSubscribers){this.purgeListeners()}}.createDelegate(this);this.load=function(){if(this.fireEvent(&quot;beforeload&quot;,a,this)){if(a.mask){var e=new Ext.LoadMask(Ext.getDom(a.mask),Ext.apply({msg:&quot;loading components...&quot;},a.maskConfig||{}));e.show();this.on(&quot;success&quot;,e.hide,e)}Ext.Ajax.request(Ext.apply(a,{success:c,scope:this}))}};this.init=function(e){e.on(&quot;beforedestroy&quot;,function(){this.purgeListeners()},this);this.container=e;if(a.loadOn){if(a.loadOn instanceof Array){Ext.each(a.loadOn,function(m,n,k){var g=m.event||m.loadOn;var p=function(){this.load();Ext.each(k,function(l){(l.scope||e).un(g,p,this)}.createDelegate(this))}.createDelegate(this);(m.scope||e).on(g,p,this)}.createDelegate(this))}else{(a.loadOn.scope||e).on((a.loadOn.event||a.loadOn),this.load,this,{single:true})}}else{this.load()}}};Ext.extend(Ext.ux.Plugin.RemoteComponent,Ext.util.Observable);
/*!
 * Ext JS Library 3.2.1
 * Copyright(c) 2006-2010 Ext JS, Inc.
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.ux.Portal=Ext.extend(Ext.Panel,{layout:&quot;column&quot;,autoScroll:true,cls:&quot;x-portal&quot;,defaultType:&quot;portalcolumn&quot;,resizable:true,initComponent:function(){Ext.ux.Portal.superclass.initComponent.call(this);this.addEvents({validatedrop:true,beforedragover:true,dragover:true,beforedrop:true,drop:true})},initEvents:function(){Ext.ux.Portal.superclass.initEvents.call(this);this.dd=new Ext.ux.Portal.DropZone(this,this.dropConfig)},beforeDestroy:function(){if(this.dd){this.dd.unreg()}Ext.ux.Portal.superclass.beforeDestroy.call(this)}});Ext.reg(&quot;portal&quot;,Ext.ux.Portal);Ext.ux.Portal.DropZone=Ext.extend(Ext.dd.DropTarget,{constructor:function(a,b){this.portal=a;Ext.dd.ScrollManager.register(a.body);Ext.ux.Portal.DropZone.superclass.constructor.call(this,a.bwrap.dom,b);a.body.ddScrollConfig=this.ddScrollConfig},ddScrollConfig:{vthresh:50,hthresh:-1,animate:true,increment:200},createEvent:function(a,g,d,b,l,k){return{portal:this.portal,panel:d.panel,columnIndex:b,column:l,position:k,data:d,source:a,rawEvent:g,status:this.dropAllowed}},notifyOver:function(C,A,D){var g=A.getXY(),a=this.portal,s=C.proxy;if(!this.grid){this.grid=this.getGrid()}var b=a.body.dom.clientWidth;if(!this.lastCW){this.lastCW=b}else{if(this.lastCW!=b){this.lastCW=b;a.doLayout();this.grid=this.getGrid()}}var d=0,q=this.grid.columnX,r=false,z;for(z=q.length;d&lt;z;d++){if(g[0]&lt;(q[d].x+q[d].w)){r=true;break}}if(!r){d--}var u,n=false,l=0,B=a.items.itemAt(d),t=B.items.items,m=false;for(z=t.length;l&lt;z;l++){u=t[l];var v=u.el.getHeight();if(v===0){m=true}else{if((u.el.getY()+(v/2))&gt;g[1]){n=true;break}}}l=(n&amp;&amp;u?l:B.items.getCount())+(m?-1:0);var k=this.createEvent(C,A,D,d,B,l);if(a.fireEvent(&quot;validatedrop&quot;,k)!==false&amp;&amp;a.fireEvent(&quot;beforedragover&quot;,k)!==false){s.getProxy().setWidth(&quot;auto&quot;);if(u){s.moveProxy(u.el.dom.parentNode,n?u.el.dom:null)}else{s.moveProxy(B.el.dom,null)}this.lastPos={c:B,col:d,p:m||(n&amp;&amp;u)?l:false};this.scrollPos=a.body.getScroll();a.fireEvent(&quot;dragover&quot;,k);return k.status}else{return k.status}},notifyOut:function(){delete this.grid},notifyDrop:function(q,l,k){delete this.grid;if(!this.lastPos){return}var n=this.lastPos.c,g=this.lastPos.col,p=this.lastPos.p,a=q.panel,b=this.createEvent(q,l,k,g,n,p!==false?p:n.items.getCount());if(this.portal.fireEvent(&quot;validatedrop&quot;,b)!==false&amp;&amp;this.portal.fireEvent(&quot;beforedrop&quot;,b)!==false){q.proxy.getProxy().remove();a.el.dom.parentNode.removeChild(q.panel.el.dom);if(p!==false){n.insert(p,a)}else{n.add(a)}n.doLayout();this.portal.fireEvent(&quot;drop&quot;,b);var r=this.scrollPos.top;if(r){var m=this.portal.body.dom;setTimeout(function(){m.scrollTop=r},10)}}delete this.lastPos},getGrid:function(){var a=this.portal.bwrap.getBox();a.columnX=[];this.portal.items.each(function(b){a.columnX.push({x:b.el.getX(),w:b.el.getWidth()})});return a},unreg:function(){Ext.dd.ScrollManager.unregister(this.portal.body);Ext.ux.Portal.DropZone.superclass.unreg.call(this)}});
/*!
 * Ext JS Library 3.2.1
 * Copyright(c) 2006-2010 Ext JS, Inc.
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.ux.PortalColumn=Ext.extend(Ext.Container,{defaultType:&quot;portlet&quot;,cls:&quot;x-portal-column&quot;});Ext.reg(&quot;portalcolumn&quot;,Ext.ux.PortalColumn);
/*!
 * Ext JS Library 3.2.1
 * Copyright(c) 2006-2010 Ext JS, Inc.
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.ux.Portlet=Ext.extend(Ext.Panel,{anchor:&quot;100%&quot;,frame:true,collapsible:true,draggable:true,cls:&quot;x-portlet&quot;,heightIncrement:16,pinned:false,duration:0.6,easing:&quot;backIn&quot;,transparent:false,minHeight:10,onRender:function(b,a){Ext.ux.Portlet.superclass.onRender.call(this,b,a);var c=Ext.Element.prototype.createProxy;Ext.Element.prototype.createProxy=function(d){return Ext.DomHelper.append(this.dom,d,true)};this.resizer=new Ext.Resizable(this.el,{animate:true,duration:this.duration,easing:this.easing,handles:&quot;s&quot;,transparent:this.transparent,heightIncrement:this.heightIncrement,minHeight:this.minHeight||100,pinned:this.pinned});this.resizer.on(&quot;resize&quot;,this.onResizer,this);Ext.Element.prototype.createProxy=c},onResizer:function(b,a,d,c){this.setHeight(d)},onCollapse:function(a,b){this.el.setHeight(&quot;&quot;);Ext.ux.Portlet.superclass.onCollapse.call(this,a,b)}});Ext.reg(&quot;portlet&quot;,Ext.ux.Portlet);
/*!
 * ext-basex/$JIT Adapter Extensions for ExtJS Library 2.0+ and Ext Core 3.0+
 * Copyright(c) 2008-2009 Active Group, Inc.
 * licensing@theactivegroup.com
 * http://licensing.theactivegroup.com
 */
(function(){var k=Ext.lib.Ajax,m=function(a){return typeof a!=&quot;undefined&quot;},q=Ext.emptyFn||function(){},l=Object.prototype;Ext.lib.Ajax.Queue=function(a){a=a?(a.name?a:{name:a}):{};Ext.apply(this,a,{name:&quot;q-default&quot;,priority:5,FIFO:true,callback:null,scope:null,suspended:false,progressive:false});this.requests=new Array();this.pending=false;this.priority=this.priority&gt;9?9:(this.priority&lt;0?0:this.priority)};Ext.extend(Ext.lib.Ajax.Queue,Object,{add:function(b){var a=k.events?k.fireEvent(&quot;beforequeue&quot;,this,b):true;if(a!==false){this.requests.push(b);this.pending=true;k.pendingRequests++;this.manager&amp;&amp;this.manager.start()}},suspended:false,activeRequest:null,next:function(b){var a=b?this.requests[this.FIFO?&quot;first&quot;:&quot;last&quot;]():this.requests[this.FIFO?&quot;shift&quot;:&quot;pop&quot;]();if(this.requests.length==0){this.pending=false;Ext.isFunction(this.callback)&amp;&amp;this.callback.call(this.scope||null,this);k.events&amp;&amp;k.fireEvent(&quot;queueempty&quot;,this)}return a||null},clear:function(){this.suspend();k.pendingRequests-=this.requests.length;this.requests.length=0;this.pending=false;this.resume();this.next()},suspend:function(){this.suspended=true},resume:function(){this.suspended=false},requestNext:function(b){var a;this.activeRequest=null;if(!this.suspended&amp;&amp;(a=this.next(b))){if(a.active){this.activeRequest=k.request.apply(k,a);k.pendingRequests--}else{return this.requestNext(b)}}return this.activeRequest}});Ext.lib.Ajax.QueueManager=function(a){Ext.apply(this,a||{},{quantas:10,priorityQueues:new Array(new Array(),new Array(),new Array(),new Array(),new Array(),new Array(),new Array(),new Array(),new Array(),new Array()),queues:{}})};Ext.extend(Ext.lib.Ajax.QueueManager,Object,{quantas:10,getQueue:function(a){return this.queues[a]},createQueue:function(c){if(!c){return null}var b=new k.Queue(c);b.manager=this;this.queues[b.name]=b;var a=this.priorityQueues[b.priority];a&amp;&amp;a.indexOf(b.name)==-1&amp;&amp;a.push(b.name);return b},removeQueue:function(a){if(a&amp;&amp;(a=this.getQueue(a.name||a))){a.clear();this.priorityQueues[a.priority].remove(a.name);delete this.queues[a.name]}},start:function(){if(!this.started){this.started=true;this.dispatch()}return this},suspendAll:function(){forEach(this.queues,function(a){a.suspend()})},resumeAll:function(){forEach(this.queues,function(a){a.resume()});this.start()},progressive:false,stop:function(){this.started=false;return this},dispatch:function(){var a=this,b=a.queues;var d=(k.activeRequests&gt;k.maxConcurrentRequests);while(k.pendingRequests&amp;&amp;!d){var c=function(s){var e=b[s],g;while(e&amp;&amp;!e.suspended&amp;&amp;e.pending&amp;&amp;e.requestNext()){d||(d=k.activeRequests&gt;k.maxConcurrentRequests);if(d){break}if(e.progressive||a.progressive){break}}if(d){return false}};forEach(this.priorityQueues,function(e){!!e.length&amp;&amp;forEach(e,c,this);d||(d=k.activeRequests&gt;k.maxConcurrentRequests);if(d){return false}},this)}if(k.pendingRequests||d){this.dispatch.defer(this.quantas,this)}else{this.stop()}}});Ext.apply(k,{headers:k.headers||{},defaultPostHeader:k.defaultPostHeader||&quot;application/x-www-form-urlencoded; charset=UTF-8&quot;,defaultHeaders:k.defaultHeaders||{},useDefaultXhrHeader:!!k.useDefaultXhrHeader,defaultXhrHeader:&quot;Ext.basex&quot;,SCRIPTTAG_POOL:[],_domRefs:[],onUnload:function(){Ext.Element.uncache.apply(Ext.Element,k.SCRIPTTAG_POOL.concat(k._domRefs));delete k._domRefs;delete k.SCRIPTTAG_POOL},monitoredNode:function(a,s,c,v,b){var u=null,d=(v||window).document,e=d?d.getElementsByTagName(&quot;head&quot;)[0]:null;if(a&amp;&amp;d&amp;&amp;e){u=a.toUpperCase()==&quot;SCRIPT&quot;&amp;&amp;!!k.SCRIPTTAG_POOL.length?Ext.get(k.SCRIPTTAG_POOL.pop()):null;if(u){u.removeAllListeners()}else{u=Ext.get(d.createElement(a))}var g=Ext.getDom(u);g&amp;&amp;forEach(s||{},function(z,A){z&amp;&amp;(A in g)&amp;&amp;g.setAttribute(A,z)});if(c){var t=(c.success||c).createDelegate(c.scope||null,[c||{}],0);Ext.isIE?u.on(&quot;readystatechange&quot;,function(){this.dom.readyState==&quot;loaded&quot;&amp;&amp;t()}):u.on(&quot;load&quot;,t)}b||g.parentNode||e.appendChild(g)}k._domRefs.push(u);return u},poll:{},pollInterval:k.pollInterval||50,queueManager:new k.QueueManager(),queueAll:false,activeRequests:0,pendingRequests:0,maxConcurrentRequests:Ext.isIE?Ext.value(window.maxConnectionsPerServer,2):4,forceActiveX:false,async:true,createXhrObject:function(b,a){var e={status:{isError:false},tId:b},g=null;a||(a={});try{a.xdomain&amp;&amp;window.XDomainRequest&amp;&amp;(e.conn=new XDomainRequest());if(!m(e.conn)&amp;&amp;Ext.capabilities.hasActiveX&amp;&amp;!!Ext.value(a.forceActiveX,this.forceActiveX)){throw (&quot;IE7forceActiveX&quot;)}e.conn||(e.conn=new XMLHttpRequest())}catch(t){var u=Ext.capabilities.hasActiveX?(a.multiPart?this.activeXMultipart:this.activeX):null;if(u){for(var d=0,s=u.length;d&lt;s;++d){try{e.conn=new ActiveXObject(u[d]);break}catch(c){g=(t==&quot;IE7forceActiveX&quot;?c:t)}}}}finally{e.status.isError=!m(e.conn);e.status.error=g}return e},createExceptionObject:function(a,b,d,e,c){return{tId:a,status:d?-1:0,statusText:d?&quot;transaction aborted&quot;:&quot;communication failure&quot;,isAbort:d,isTimeout:e,argument:b}},encoder:encodeURIComponent,serializeForm:function(){var a=/select-(one|multiple)/i,c=/file|undefined|reset|button/i,b=/radio|checkbox/i;return function(A){var z=A.elements||(document.forms[A]||Ext.getDom(A)).elements,D=false,d=this.encoder,g,C,B,v,u=&quot;&quot;,e;forEach(z,function(s){B=s.name;e=s.type;if(!s.disabled&amp;&amp;B){if(a.test(e)){forEach(s.options,function(t){if(t.selected){u+=String.format(&quot;{0}={1}&amp;&quot;,d(B),d(t.hasAttribute&amp;&amp;t.hasAttribute(&quot;value&quot;)&amp;&amp;t.getAttribute(&quot;value&quot;)!==null?t.value:t.text))}})}else{if(!c.test(e)){if(!(b.test(e)&amp;&amp;!s.checked)&amp;&amp;!(e==&quot;submit&quot;&amp;&amp;D)){u+=d(B)+&quot;=&quot;+d(s.value)+&quot;&amp;&quot;;D=/submit/i.test(e)}}}}});return u.substr(0,u.length-1)}}(),getHttpStatus:function(c,d,e){var a={status:0,statusText:&quot;&quot;,isError:false,isLocal:false,isOK:true,error:null,isAbort:!!d,isTimeout:!!e};try{if(!c||!(&quot;status&quot; in c)){throw (&quot;noobj&quot;)}a.status=c.status;a.readyState=c.readyState;a.isLocal=(!c.status&amp;&amp;location.protocol==&quot;file:&quot;)||(Ext.isSafari&amp;&amp;!m(c.status));a.isOK=(a.isLocal||(a.status==304||a.status==1223||(a.status&gt;199&amp;&amp;a.status&lt;300)));a.statusText=c.statusText||&quot;&quot;}catch(b){}return a},handleTransactionResponse:function(b,a,d,e){a=a||{};var c=null;b.isPart||k.activeRequests--;if(!b.status.isError){b.status=this.getHttpStatus(b.conn,d,e);c=this.createResponseObject(b,a.argument,d,e)}b.isPart||this.releaseObject(b);b.status.isError&amp;&amp;(c=Ext.apply({},c||{},this.createExceptionObject(b.tId,a.argument,!!d,!!e,b.status.error)));c.options=b.options;c.fullStatus=b.status;if(!this.events||this.fireEvent(&quot;status:&quot;+b.status.status,b.status.status,b,c,a,d)!==false){if(b.status.isOK&amp;&amp;!b.status.isError){if(!this.events||this.fireEvent(&quot;response&quot;,b,c,a,d,e)!==false){var g=b.isPart?&quot;onpart&quot;:&quot;success&quot;;Ext.isFunction(a[g])&amp;&amp;a[g].call(a.scope||null,c)}}else{if(!this.events||this.fireEvent(&quot;exception&quot;,b,c,a,d,e,c.fullStatus.error)!==false){Ext.isFunction(a.failure)&amp;&amp;a.failure.call(a.scope||null,c,c.fullStatus.error)}}}return c},releaseObject:function(a){a&amp;&amp;(a.conn=null);if(a&amp;&amp;Ext.value(a.tId,-1)+1){if(this.poll[a.tId]){window.clearInterval(this.poll[a.tId]);delete this.poll[a.tId]}if(this.timeout[a.tId]){window.clearInterval(this.timeout[a.tId]);delete this.timeout[a.tId]}}},decodeJSON:Ext.decode,reCtypeJSON:/(application|text)\/json/i,reCtypeXML:/(application|text)\/xml/i,createResponseObject:function(g,d,M,L){var b=&quot;content-type&quot;,K={responseXML:null,responseText:&quot;&quot;,responseStream:null,responseJSON:null,contentType:null,getResponseHeader:q,getAllResponseHeaders:q};var O={},N=&quot;&quot;;if(M!==true){try{K.responseJSON=g.conn.responseJSON||null;K.responseStream=g.conn.responseStream||null;K.contentType=g.conn.contentType||null;K.responseText=g.conn.responseText}catch(a){g.status.isError=true;g.status.error=a}try{K.responseXML=g.conn.responseXML||null}catch(c){}try{N=(&quot;getAllResponseHeaders&quot; in g.conn?g.conn.getAllResponseHeaders():null)||&quot;&quot;;var E;N.split(&quot;\n&quot;).forEach(function(t){(E=t.split(&quot;:&quot;))&amp;&amp;E.first()&amp;&amp;(O[E.first().trim().toLowerCase()]=(E.last()||&quot;&quot;).trim())})}catch(e){g.status.isError=true;g.status.error=e}finally{K.contentType=K.contentType||O[b]||&quot;&quot;}if((g.status.isLocal||g.proxied)&amp;&amp;typeof K.responseText==&quot;string&quot;){g.status.isOK=!g.status.isError&amp;&amp;((g.status.status=(!!K.responseText.length)?200:404)==200);if(g.status.isOK&amp;&amp;((!K.responseXML&amp;&amp;this.reCtypeXML.test(K.contentType))||(K.responseXML&amp;&amp;K.responseXML.childNodes.length===0))){var D=null;try{if(Ext.capabilities.hasActiveX){D=new ActiveXObject(&quot;MSXML2.DOMDocument.3.0&quot;);D.async=false;D.loadXML(K.responseText)}else{var C=null;try{C=new DOMParser();D=C.parseFromString(K.responseText,&quot;application/xml&quot;)}catch(P){}finally{C=null}}}catch(s){g.status.isError=true;g.status.error=s}K.responseXML=D}if(K.responseXML){var B=(K.responseXML.documentElement&amp;&amp;K.responseXML.documentElement.nodeName==&quot;parsererror&quot;)||(K.responseXML.parseError||0)!==0||K.responseXML.childNodes.length===0;B||(K.contentType=O[b]=K.responseXML.contentType||&quot;text/xml&quot;)}}if(g.options.isJSON||(this.reCtypeJSON&amp;&amp;this.reCtypeJSON.test(O[b]||&quot;&quot;))){try{Ext.isObject(K.responseJSON)||(K.responseJSON=Ext.isFunction(this.decodeJSON)&amp;&amp;Ext.isString(K.responseText)?this.decodeJSON(K.responseText):null)}catch(J){g.status.isError=true;g.status.error=J}}}g.status.proxied=!!g.proxied;Ext.apply(K,{tId:g.tId,status:g.status.status,statusText:g.status.statusText,contentType:K.contentType||O[b],getResponseHeader:function(t){return O[(t||&quot;&quot;).trim().toLowerCase()]},getAllResponseHeaders:function(){return N},fullStatus:g.status,isPart:g.isPart||false});g.parts&amp;&amp;!g.isPart&amp;&amp;(K.parts=g.parts);m(d)&amp;&amp;(K.argument=d);return K},setDefaultPostHeader:function(a){this.defaultPostHeader=a||&quot;&quot;},setDefaultXhrHeader:function(a){this.useDefaultXhrHeader=a||false},request:function(B,z,g,d,C){var a=C=Ext.apply({async:this.async||false,headers:false,userId:null,password:null,xmlData:null,jsonData:null,queue:null,proxied:false,multiPart:false,xdomain:false},C||{});var b;if(g.argument&amp;&amp;g.argument.options&amp;&amp;g.argument.options.request&amp;&amp;(b=g.argument.options.request.arg)){Ext.apply(a,{async:a.async||b.async,proxied:a.proxied||b.proxied,multiPart:a.multiPart||b.multiPart,xdomain:a.xdomain||b.xdomain,queue:a.queue||b.queue,onPart:a.onPart||b.onPart})}if(!this.events||this.fireEvent(&quot;request&quot;,B,z,g,d,a)!==false){if(!a.queued&amp;&amp;(a.queue||(a.queue=this.queueAll||null))){a.queue===true&amp;&amp;(a.queue={name:&quot;q-default&quot;});var c=a.queue;var v=c.name||c,D=this.queueManager;var A=D.getQueue(v)||D.createQueue(c);a.queue=A;a.queued=true;var E=[B,z,g,d,a];E.active=true;A.add(E);return{tId:this.transactionId++,queued:true,request:E,options:a}}C.onpart&amp;&amp;(g.onpart||(g.onpart=Ext.isFunction(C.onpart)?C.onpart.createDelegate(C.scope):null));a.headers&amp;&amp;forEach(a.headers,function(s,t){this.initHeader(t,s,false)},this);var e;if(e=(this.headers?this.headers[&quot;Content-Type&quot;]||null:null)){delete this.headers[&quot;Content-Type&quot;]}if(a.xmlData){e||(e=&quot;text/xml&quot;);B=&quot;POST&quot;;d=a.xmlData}else{if(a.jsonData){e||(e=&quot;application/json; charset=utf-8&quot;);B=&quot;POST&quot;;d=Ext.isObject(a.jsonData)?Ext.encode(a.jsonData):a.jsonData}}if(d){e||(e=this.useDefaultHeader?this.defaultPostHeader:null);e&amp;&amp;this.initHeader(&quot;Content-Type&quot;,e,false)}return this.makeRequest(a.method||B,z,g,d,a)}return null},getConnectionObject:function(d,g,b){var a,c;var s=this.transactionId;g||(g={});try{if(c=g.proxied){a={tId:s,status:{isError:false},proxied:true,conn:{el:null,send:function(u){var t=(c.target||window).document,v=t.getElementsByTagName(&quot;head&quot;)[0];if(v&amp;&amp;this.el){v.appendChild(this.el.dom);this.readyState=2}},abort:function(){this.readyState=0;window[a.cbName]=undefined;Ext.isIE||delete window[a.cbName];var u=Ext.getDom(this.el);if(this.el){this.el.removeAllListeners();if(!a.debug){if(Ext.isIE){k.SCRIPTTAG_POOL.push(this.el)}else{this.el.remove();if(u){for(var t in u){delete u[t]}}}}}this.el=u=null},_headers:{},getAllResponseHeaders:function(){var t=[];forEach(this._headers,function(u,v){u&amp;&amp;t.push(v+&quot;: &quot;+u)});return t.join(&quot;\n&quot;)},getResponseHeader:function(t){return this._headers[String(t).toLowerCase()]||&quot;&quot;},onreadystatechange:null,onload:null,readyState:0,status:0,responseText:null,responseXML:null,responseJSON:null},debug:c.debug,params:Ext.isString(g.params)?Ext.urlDecode(g.params):g.params||{},cbName:c.callbackName||&quot;basexCallback&quot;+s,cbParam:c.callbackParam||null};window[a.cbName]=a.cb=function(t){t&amp;&amp;typeof(t)==&quot;object&quot;&amp;&amp;(this.responseJSON=t);this.responseText=t||null;this.status=!!t?200:404;this.abort();this.readyState=4;Ext.isFunction(this.onreadystatechange)&amp;&amp;this.onreadystatechange();Ext.isFunction(this.onload)&amp;&amp;this.onload()}.createDelegate(a.conn);a.conn.open=function(){if(a.cbParam){a.params[a.cbParam]=a.cbName}var t=Ext.urlEncode(Ext.apply(Ext.urlDecode(b)||{},a.params,d.indexOf(&quot;?&quot;)&gt;-1?Ext.urlDecode(d.split(&quot;?&quot;).last()):false));a.uri=t?d.split(&quot;?&quot;).first()+&quot;?&quot;+t:d;this.el=k.monitoredNode(c.tag||&quot;script&quot;,{type:c.contentType||&quot;text/javascript&quot;,src:a.uri,charset:c.charset||g.charset||null},null,c.target,true);this._headers[&quot;content-type&quot;]=this.el.dom.type;this.readyState=1;Ext.isFunction(this.onreadystatechange)&amp;&amp;this.onreadystatechange()};g.async=true}else{a=this.createXhrObject(s,g)}if(a){this.transactionId++}}catch(e){a&amp;&amp;(a.status.isError=!!(a.status.error=e))}finally{return a}},makeRequest:function(s,c,t,g,e){var a;if(a=this.getConnectionObject(c,e,g)){a.options=e;var d=a.conn;try{if(a.status.isError){throw a.status.error}k.activeRequests++;d.open(s.toUpperCase(),c,e.async,e.userId,e.password);(&quot;onreadystatechange&quot; in d)&amp;&amp;(d.onreadystatechange=this.onStateChange.createDelegate(this,[a,t,&quot;readystate&quot;],0));(&quot;onload&quot; in d)&amp;&amp;(d.onload=this.onStateChange.createDelegate(this,[a,t,&quot;load&quot;,4],0));(&quot;onprogress&quot; in d)&amp;&amp;(d.onprogress=this.onStateChange.createDelegate(this,[a,t,&quot;progress&quot;],0));if(t&amp;&amp;t.timeout){(&quot;timeout&quot; in d)&amp;&amp;(d.timeout=t.timeout);(&quot;ontimeout&quot; in d)&amp;&amp;(d.ontimeout=this.abort.createDelegate(this,[a,t,true],0));(&quot;ontimeout&quot; in d)||(e.async&amp;&amp;(this.timeout[a.tId]=window.setInterval(function(){k.abort(a,t,true)},t.timeout)))}if(this.useDefaultXhrHeader&amp;&amp;!e.xdomain){this.defaultHeaders[&quot;X-Requested-With&quot;]||this.initHeader(&quot;X-Requested-With&quot;,this.defaultXhrHeader,true)}this.setHeaders(a);if(!this.events||this.fireEvent(&quot;beforesend&quot;,a,s,c,t,g,e)!==false){d.send(g||null)}}catch(b){a.status.isError=true;a.status.error=b}if(a.status.isError){return Ext.apply(a,this.handleTransactionResponse(a,t))}e.async||this.onStateChange(a,t,&quot;load&quot;);return a}},abort:function(b,a,c){b&amp;&amp;Ext.apply(b.status,{isAbort:!!!c,isTimeout:!!c,isError:!!c||!!b.status.isError});if(b&amp;&amp;b.queued&amp;&amp;b.request){b.request.active=b.queued=false;this.events&amp;&amp;this.fireEvent(&quot;abort&quot;,b,a);return true}else{if(b&amp;&amp;this.isCallInProgress(b)){if(!this.events||this.fireEvent(c?&quot;timeout&quot;:&quot;abort&quot;,b,a)!==false){(&quot;abort&quot; in b.conn)&amp;&amp;b.conn.abort();this.handleTransactionResponse(b,a,b.status.isAbort,b.status.isTimeout)}return true}}return false},isCallInProgress:function(a){if(a&amp;&amp;a.conn){if(&quot;readyState&quot; in a.conn&amp;&amp;{0:true,4:true}[a.conn.readyState]){return false}return true}return false},clearAuthenticationCache:function(c){try{if(Ext.isIE){document.execCommand(&quot;ClearAuthenticationCache&quot;)}else{var b;if(b=new XMLHttpRequest()){b.open(&quot;GET&quot;,c||&quot;/@@&quot;,true,&quot;logout&quot;,&quot;logout&quot;);b.send(&quot;&quot;);b.abort.defer(100,b)}}}catch(a){}},initHeader:function(b,a){(this.headers=this.headers||{})[b]=a},onStateChange:function(d,B,D){if(!d.conn||d.status.isTimeout||d.status.isError){return}var z=d.conn,a=(&quot;readyState&quot; in z?z.readyState:0);if(D===&quot;load&quot;||a&gt;2){var C;try{C=z.contentType||z.getResponseHeader(&quot;Content-Type&quot;)||&quot;&quot;}catch(c){}if(C&amp;&amp;/multipart\//i.test(C)){var A=null,e=C.split('&quot;')[1],E=&quot;--&quot;+e;d.multiPart=true;try{A=z.responseText}catch(b){}var g=A?A.split(E):null;if(g){d.parts||(d.parts=[]);g.shift();g.pop();forEach(Array.slice(g,d.parts.length),function(u){var s=u.split(&quot;\n\n&quot;);var t=(s[0]?s[0]:&quot;&quot;)+&quot;\n&quot;;d.parts.push(this.handleTransactionResponse(Ext.apply(Ext.clone(d),{boundary:e,conn:{status:200,responseText:(s[1]||&quot;&quot;).trim(),getAllResponseHeaders:function(){return t.split(&quot;\n&quot;).filter(function(v){return !!v}).join(&quot;\n&quot;)}},isPart:true}),B))},this)}}}(a===4||D===&quot;load&quot;)&amp;&amp;k.handleTransactionResponse(d,B);this.events&amp;&amp;this.fireEvent.apply(this,[&quot;readystatechange&quot;].concat(Array.slice(arguments,0)))},setHeaders:function(a){if(a.conn&amp;&amp;&quot;setRequestHeader&quot; in a.conn){this.defaultHeaders&amp;&amp;forEach(this.defaultHeaders,function(b,c){a.conn.setRequestHeader(c,b)});this.headers&amp;&amp;forEach(this.headers,function(b,c){a.conn.setRequestHeader(c,b)})}this.headers={};this.hasHeaders=false},resetDefaultHeaders:function(){delete this.defaultHeaders;this.defaultHeaders={};this.hasDefaultHeaders=false},activeXMultipart:[&quot;MSXML2.XMLHTTP.6.0&quot;,&quot;MSXML3.XMLHTTP&quot;],activeX:[&quot;MSXML2.XMLHTTP.3.0&quot;,&quot;MSXML2.XMLHTTP&quot;,&quot;Microsoft.XMLHTTP&quot;]});if(Ext.util.Observable){Ext.apply(k,{events:{request:true,beforesend:true,response:true,exception:true,abort:true,timeout:true,readystatechange:true,beforequeue:true,queue:true,queueempty:true},onStatus:function(e,a,b,c){var d=Array.slice(arguments,1);e=new Array().concat(e||new Array());forEach(e,function(g){g=parseInt(g,10);if(!isNaN(g)){var s=&quot;status:&quot;+g;this.events[s]||(this.events[s]=true);this.on.apply(this,[s].concat(d))}},this)},unStatus:function(e,a,b,c){var d=Array.slice(arguments,1);e=new Array().concat(e||new Array());forEach(e,function(g){g=parseInt(g,10);if(!isNaN(g)){var s=&quot;status:&quot;+g;this.un.apply(this,[s].concat(d))}},this)}},new Ext.util.Observable());Ext.hasBasex=true}Ext.stopIteration={stopIter:true};Ext.applyIf(Array.prototype,{map:function(d,a){var e=this.length;if(typeof d!=&quot;function&quot;){throw new TypeError()}var b=new Array(e);for(var c=0;c&lt;e;++c){c in this&amp;&amp;(b[c]=d.call(a||this,this[c],c,this))}return b},some:function(b){var a=Ext.isFunction(b)?b:function(){};var c=0,d=this.length,e=false;while(c&lt;d&amp;&amp;!(e=!!a(this[c++]))){}return e},every:function(b){var a=Ext.isFunction(b)?b:function(){};var c=0,d=this.length,e=true;while(c&lt;d&amp;&amp;(e=!!a(this[c++]))){}return e},include:function(a,c){if(!c&amp;&amp;typeof this.indexOf==&quot;function&quot;){return this.indexOf(a)!=-1}var b=false;try{this.forEach(function(e,g){if(b=(c?(e.include?e.include(a,c):(e===a)):e===a)){throw Ext.stopIteration}})}catch(d){if(d!=Ext.stopIteration){throw d}}return b},filter:function(a,b){var c=new Array();a||(a=function(d){return d});this.forEach(function(d,e){a.call(b,d,e)&amp;&amp;c.push(d)});return c},compact:function(a){var b=new Array();this.forEach(function(c){(c===null||c===undefined)||b.push(a&amp;&amp;Ext.isArray(c)?c.compact():c)},this);return b},flatten:function(){var a=new Array();this.forEach(function(b){Ext.isArray(b)?(a=a.concat(b)):a.push(b)},this);return a},indexOf:function(a){for(var b=0,c=this.length;b&lt;c;++b){if(this[b]==a){return b}}return -1},lastIndexOf:function(a){var b=this.length-1;while(b&gt;-1&amp;&amp;this[b]!=a){b--}return b},unique:function(b,a){var c=new Array();this.forEach(function(d,e){if(0==e||(b?c.last()!=d:!c.include(d,a))){c.push(d)}},this);return c},grep:function(a,b,c){var e=new Array();b||(b=function(g){return g});var d=c?b.createDelegate(c):b;if(typeof a==&quot;string&quot;){a=new RegExp(a)}a instanceof RegExp&amp;&amp;this.forEach(function(s,g){a.test(s)&amp;&amp;e.push(d(s,g))});return e},first:function(){return this[0]},last:function(){return this[this.length-1]},clear:function(){this.length=0},atRandom:function(a){var b=Math.floor(Math.random()*this.length);return this[b]||a},clone:function(c){if(!c){return this.concat()}var a=this.length||0,b=new Array(a);while(a--){b[a]=Ext.clone(this[a],true)}return b},forEach:function(a,b){Array.forEach(this,a,b)},reversed:function(){var a=this.length||0,b=[];while(a--){b.push(this[a])}return b}});window.forEach=function(d,a,c,e){c=c||d;if(d){if(typeof a!=&quot;function&quot;){throw new TypeError()}var b=Object;if(d instanceof Function){b=Function}else{if(d.forEach instanceof Function){return d.forEach(a,c)}else{if(typeof d==&quot;string&quot;){b=String}else{if(Ext.isNumber(d.length)){b=Array}}}}return b.forEach(d,a,c,e)}};Ext.clone=function(b,c){if(b===null||b===undefined){return b}if(Ext.isFunction(b.clone)){return b.clone(c)}else{if(Ext.isFunction(b.cloneNode)){return b.cloneNode(c)}}var a={};forEach(b,function(e,g,d){a[g]=(e===d?a:c?Ext.clone(e,true):e)},b,c);return a};var n=Array.prototype.slice;var p=Array.prototype.filter;Ext.applyIf(Array,{slice:function(a){return n.apply(a,n.call(arguments,1))},filter:function(a,b){var c=a&amp;&amp;typeof a==&quot;string&quot;?a.split(&quot;&quot;):[];return p.call(c,b)},forEach:function(e,a,b){if(typeof a!=&quot;function&quot;){throw new TypeError()}for(var c=0,d=e.length&gt;&gt;&gt;0;c&lt;d;++c){(c in e)&amp;&amp;a.call(b||null,e[c],c,e)}}});Ext.applyIf(RegExp.prototype,{clone:function(){return new RegExp(this)}});Ext.applyIf(Date.prototype,{clone:function(a){return a?new Date(this.getTime()):this}});Ext.applyIf(Boolean.prototype,{clone:function(){return this===true}});Ext.applyIf(Number.prototype,{times:function(a,c){var b=parseInt(this,10)||0;for(var d=1;d&lt;=b;){a.call(c,d++)}},forEach:function(){this.times.apply(this,arguments)},clone:function(){return(this)+0}});Ext.applyIf(String.prototype,{trim:function(){var a=/^\s+|\s+$/g;return function(){return this.replace(a,&quot;&quot;)}}(),trimRight:function(){var a=/^|\s+$/g;return function(){return this.replace(a,&quot;&quot;)}}(),trimLeft:function(){var a=/^\s+|$/g;return function(){return this.replace(a,&quot;&quot;)}}(),clone:function(){return String(this)+&quot;&quot;},forEach:function(a,b){String.forEach(this,a,b)}});var r=function(g,a){var s=typeof g==&quot;function&quot;?g:function(){};var b=s._ovl;if(!b){b={base:s};b[s.length||0]=s;s=function(){var t=arguments.callee._ovl;var u=t[arguments.length]||t.base;return u&amp;&amp;u!=arguments.callee?u.apply(this,arguments):undefined}}var e=[].concat(a);for(var c=0,d=e.length;c&lt;d;++c){b[e[c].length]=e[c]}s._ovl=b;return s};Ext.applyIf(Ext,{overload:r(r,[function(a){return r(null,a)},function(a,b,c){return a[b]=r(a[b],c)}]),isIterable:function(a){if(a===null||a===undefined){return false}if(Ext.isArray(a)||!!a.callee||Ext.isNumber(a.length)){return true}return !!((/NodeList|HTMLCollection/i).test(l.toString.call(a))||a.nextNode||a.item||false)},isArray:function(a){return l.toString.apply(a)==&quot;[object Array]&quot;},isObject:function(a){return(a!==null)&amp;&amp;typeof a==&quot;object&quot;},isNumber:function(a){return typeof a==&quot;number&quot;&amp;&amp;isFinite(a)},isBoolean:function(a){return typeof a==&quot;boolean&quot;},isDocument:function(a){return l.toString.apply(a)==&quot;[object HTMLDocument]&quot;||(a&amp;&amp;a.nodeType===9)},isElement:function(a){return a&amp;&amp;Ext.type(a)==&quot;element&quot;},isEvent:function(a){return l.toString.apply(a)==&quot;[object Event]&quot;||(Ext.isObject(a)&amp;&amp;!Ext.type(a.constructor)&amp;&amp;(window.event&amp;&amp;a.clientX&amp;&amp;a.clientX===window.event.clientX))},isFunction:function(a){return l.toString.apply(a)==&quot;[object Function]&quot;},isString:function(a){return typeof a==&quot;string&quot;},isDefined:m});Ext.capabilities={hasActiveX:m(window.ActiveXObject),hasXDR:function(){return m(window.XDomainRequest)||(m(window.XMLHttpRequest)&amp;&amp;&quot;withCredentials&quot; in new XMLHttpRequest())}(),hasChromeFrame:function(){try{if(m(window.ActiveXObject)&amp;&amp;!!(new ActiveXObject(&quot;ChromeTab.ChromeFrame&quot;))){return true}}catch(b){}var a=navigator.userAgent.toLowerCase();return !!(a.indexOf(&quot;chromeframe&quot;)&gt;=0||a.indexOf(&quot;x-clock&quot;)&gt;=0)}(),hasFlash:(function(){if(m(window.ActiveXObject)){try{new ActiveXObject(&quot;ShockwaveFlash.ShockwaveFlash&quot;);return true}catch(a){}return false}else{if(navigator.plugins){for(var d=0,b=navigator.plugins,c=b.length;d&lt;c;++d){if((/flash/i).test(b[d].name)){return true}}return false}}return false})(),hasCookies:Ext.isIE&amp;&amp;(&quot;dialogArguments&quot; in window)?false:!!navigator.cookieEnabled,hasCanvas:!!document.createElement(&quot;canvas&quot;).getContext,hasCanvasText:function(){return !!(this.hasCanvas&amp;&amp;typeof document.createElement(&quot;canvas&quot;).getContext(&quot;2d&quot;).fillText==&quot;function&quot;)}(),hasSVG:!!(document.createElementNS&amp;&amp;document.createElementNS(&quot;http://www.w3.org/2000/svg&quot;,&quot;svg&quot;).width),hasXpath:!!document.evaluate,hasWorkers:m(window.Worker),hasOffline:m(window.applicationCache),hasLocalStorage:m(window.localStorage),hasGeoLocation:m(navigator.geolocation),hasBasex:true,hasAudio:function(){var d=!!document.createElement(&quot;audio&quot;).canPlayType,c=(&quot;Audio&quot; in window)?new Audio(&quot;&quot;):{},b=d||(&quot;canPlayType&quot; in c)?{tag:d,object:(&quot;play&quot; in c),testMime:function(t){var s;return(s=c.canPlayType?c.canPlayType(t):&quot;no&quot;)!==&quot;no&quot;&amp;&amp;s!==&quot;&quot;}}:false,a,e,g={mp3:&quot;audio/mpeg&quot;,ogg:&quot;audio/ogg&quot;,wav:&quot;audio/x-wav&quot;,basic:&quot;audio/basic&quot;,aif:&quot;audio/x-aiff&quot;};if(b&amp;&amp;b.testMime){for(e in g){b[e]=b.testMime(g[e])}}return b}(),hasVideo:function(){var d=!!document.createElement(&quot;video&quot;).canPlayType,b=d?document.createElement(&quot;video&quot;):{},c=(&quot;canPlayType&quot; in b)?{tag:d,testCodec:function(t){var s;return(s=b.canPlayType?b.canPlayType(t):&quot;no&quot;)!==&quot;no&quot;&amp;&amp;s!==&quot;&quot;}}:false,a,g,e={mp4:'video/mp4; codecs=&quot;avc1.42E01E, mp4a.40.2&quot;',ogg:'video/ogg; codecs=&quot;theora, vorbis&quot;'};if(c&amp;&amp;c.testCodec){for(g in e){c[g]=c.testCodec(e[g])}}return c}(),hasInputAutoFocus:function(){return(&quot;autofocus&quot; in (document.createElement(&quot;input&quot;)))}(),hasInputPlaceHolder:function(){return(&quot;placeholder&quot; in (document.createElement(&quot;input&quot;)))}(),hasInputType:function(b){var c=document.createElement(&quot;input&quot;);if(c){try{c.setAttribute(&quot;type&quot;,b)}catch(a){}return c.type!==&quot;text&quot;}return false},isEventSupported:function(){var b={select:&quot;input&quot;,change:&quot;input&quot;,submit:&quot;form&quot;,reset:&quot;form&quot;,load:&quot;img&quot;,error:&quot;img&quot;,abort:&quot;img&quot;};var d={},a=/^on/i,c=function(s,e){var g=Ext.getDom(e);return(g?(Ext.isElement(g)||Ext.isDocument(g)?g.nodeName.toLowerCase():e.self?&quot;#window&quot;:e||&quot;#object&quot;):e||&quot;div&quot;)+&quot;:&quot;+s};return function(u,s){u=(u||&quot;&quot;).replace(a,&quot;&quot;);var t,v=false;var e=&quot;on&quot;+u;var g=(s?s:b[u])||&quot;div&quot;;var z=c(u,g);if(z in d){return d[z]}t=Ext.isString(g)?document.createElement(g):s;v=(!!t&amp;&amp;(e in t));v||(v=window.Event&amp;&amp;!!(String(u).toUpperCase() in window.Event));if(!v&amp;&amp;t){t.setAttribute&amp;&amp;t.setAttribute(e,&quot;return;&quot;);v=Ext.isFunction(t[e])}d[z]=v;t=null;return v}}()};Ext.EventManager.on(window,&quot;beforeunload&quot;,k.onUnload,k,{single:true})})();Ext.applyIf(Function.prototype,{forEach:function(k,l,m,n){if(k){var g;for(g in k){(!!n||k.hasOwnProperty(g))&amp;&amp;l.call(m||k,k[g],g,k)}}},createBuffered:function(g,l){var k=this,e=new Ext.util.DelayedTask();return function(){e.delay(g,k,l,Array.slice(arguments,0))}},createDelayed:function(n,m,g,k){var l=(m||g)?this.createDelegate(m,g,k):this;return n?function(){setTimeout(l,n)}:l},clone:function(b){return this}});Ext.namespace(&quot;sitools.siteMap&quot;);var loadUrl={map:[],load:function(a,d,b){var c=this;c.transformsPropertiesToMap(a,d,b)},transformsPropertiesToMap:function(b,e,c){var a=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:b,restful:true}),reader:new Ext.data.XmlReader({record:&quot;url&quot;},[{name:&quot;name&quot;,mapping:&quot;name&quot;},{name:&quot;loc&quot;,mapping:&quot;loc&quot;}])});var d=this.map;a.load({scope:c,callback:function(n,l,q){var m=0;while(m!=undefined){var p=n[m];if(p!=undefined){var k=p.data.loc;var g=p.data.name;d[g]=k;m++}else{m=undefined}}e.call(this)}})},get:function(a){return !Ext.isEmpty(this.map[a])?this.map[a]:a}};var componentManager={loadedComponents:[],load:function(a){}};var data={ret:null,get:function(b,a){Ext.Ajax.request({method:&quot;GET&quot;,url:b,success:function(c,d){a(Ext.decode(c.responseText))},failure:function(c,d){Ext.Msg.alert(&quot;Warning&quot;,&quot;Error! Can't get data with url :&quot;+b)}});return this.ret}};Ext.applyIf(Array.prototype,{clone:function(){return[].concat(this)}});Ext.namespace(&quot;sitools.env&quot;);var userPreferences=null;var userLogin=null;var sql2ext={map:[],load:function(a){var b=this;Ext.Ajax.request({method:&quot;GET&quot;,url:a,success:function(c,d){ann(c.responseText,&quot;no response is sent&quot;);b.map=b.transformsPropertiesToMap(c.responseText)},failure:function(c,d){alert(&quot;Error! Can't read i18n file with url :&quot;+a)}})},transformsPropertiesToMap:function(k){var l=k.split(&quot;\n&quot;);var g=[];var d;for(d=0;d&lt;l.length;d++){var a=l[d];var c=a.indexOf(&quot;=&quot;);if(c&gt;=1){var b=a.substring(0,c).replace(&quot;\r&quot;,&quot;&quot;);var e=a.substring(c+1).replace(&quot;\r&quot;,&quot;&quot;);g[b]=e}}return g},get:function(a){return !Ext.isEmpty(this.map[a])?this.map[a]:&quot;auto&quot;}};var i18n={map:[],load:function(a,c){var b=this;Ext.Ajax.request({method:&quot;GET&quot;,url:a,success:function(d,e){ann(d.responseText,&quot;no response is sent&quot;);b.map=b.transformsPropertiesToMap(d.responseText);if(Ext.isFunction(c)){c()}},failure:function(d,e){alert(&quot;Error! Can't read i18n file with url :&quot;+a)}})},transformsPropertiesToMap:function(k){var l=k.split(&quot;\n&quot;);var g=[];var d;for(d=0;d&lt;l.length;d++){var a=l[d];var c=a.indexOf(&quot;=&quot;);if(c&gt;=1){var b=a.substring(0,c).replace(&quot;\r&quot;,&quot;&quot;);var e=a.substring(c+1).replace(&quot;\r&quot;,&quot;&quot;);g[b]=e}}return g},get:function(a){return !Ext.isEmpty(this.map[a])?this.map[a]:a}};var componentManager={loadedComponents:[],load:function(a){}};var data={ret:null,get:function(b,a){Ext.Ajax.request({method:&quot;GET&quot;,url:b,success:function(c,d){a(Ext.decode(c.responseText))},failure:function(c,d){Ext.Msg.alert(&quot;Warning&quot;,&quot;Error! Can't get data with url :&quot;+b)}});return this.ret}};var projectGlobal={projectId:null,projectName:null,preferences:null,userRoles:null,isAdmin:false,sitoolsAttachementForUsers:null,modules:null,callback:function(){},initProject:function(a){this.callback=a;this.projectName=this.getProjectName();this.getDataViewsDependencies()},getDataViewsDependencies:function(){Ext.Ajax.request({url:loadUrl.get(&quot;APP_URL&quot;)+loadUrl.get(&quot;APP_DATASETS_VIEWS_URL&quot;),method:&quot;GET&quot;,scope:this,success:function(a){var b=Ext.decode(a.responseText);if(!b.success){Ext.Msg.alert(i18n.get(&quot;label.warning&quot;),i18n.get(&quot;warning.noProjectName&quot;));return false}else{var c=b.data;Ext.each(c,function(d){includeJs(d.fileUrl)})}},callback:function(){this.getFormDependencies()}})},getFormDependencies:function(){Ext.Ajax.request({url:loadUrl.get(&quot;APP_URL&quot;)+loadUrl.get(&quot;APP_FORMCOMPONENTS_URL&quot;),method:&quot;GET&quot;,scope:this,success:function(a){var b=Ext.decode(a.responseText);if(!b.success){Ext.Msg.alert(i18n.get(&quot;label.warning&quot;),i18n.get(&quot;warning.noProjectName&quot;));return false}else{var c=b.data;Ext.each(c,function(d){includeJs(d.fileUrlUser)})}},callback:function(){this.projectName=this.getProjectInfo()}})},getUserRoles:function(a){if(Ext.isEmpty(userLogin)){a.call()}else{Ext.Ajax.request({url:loadUrl.get(&quot;APP_URL&quot;)+loadUrl.get(&quot;APP_USER_ROLE_URL&quot;),method:&quot;GET&quot;,scope:this,success:function(d){var e=Ext.decode(d.responseText);if(!e.success){Ext.Msg.alert(i18n.get(&quot;label.warning&quot;),i18n.get(&quot;warning.noProjectName&quot;));return false}else{var b=e.user;this.userRoles=b.roles;for(var c=0;c&lt;this.userRoles.length;c++){var g=this.userRoles[c];if(g.name==&quot;Administrator&quot;){this.isAdmin=true}}}},callback:a})}},getProjectName:function(){if(this.projectName===null){var b=document.location.pathname;var e=b.split(&quot;/&quot;);var c=0,a;var d=false;while(c&lt;e.length&amp;&amp;!d){if(e[c]==&quot;project-index.html&quot;){d=true;a=c}c++}this.projectName=e[a-1];if(this.projectName===undefined||this.projectName===&quot;&quot;){Ext.Msg.alert(i18n.get(&quot;label.warning&quot;),i18n.get(&quot;warning.noProject&quot;))}}return this.projectName},getProjectInfo:function(){Ext.Ajax.request({url:loadUrl.get(&quot;APP_URL&quot;)+loadUrl.get(&quot;APP_PORTAL_URL&quot;)+&quot;/projects/&quot;+this.projectName,method:&quot;GET&quot;,scope:this,success:function(a){var b=Ext.decode(a.responseText);if(!b.success){Ext.Msg.alert(i18n.get(&quot;label.warning&quot;),i18n.get(&quot;warning.noProjectName&quot;));return false}else{this.modules=b.project.modules;this.sitoolsAttachementForUsers=b.project.sitoolsAttachementForUsers;this.projectId=b.project.id;this.projectName=b.project.name}var c=Ext.get(&quot;toppanel&quot;);c.update(Ext.util.Format.htmlDecode(b.project.htmlHeader));this.getPreferences()},failure:function(){Ext.Msg.alert(i18n.get(&quot;label.warning&quot;),i18n.get(&quot;warning.noProject&quot;))}})},getPreferences:function(){if(!Ext.isEmpty(userLogin)){var a=loadUrl.get(&quot;APP_USERSTORAGE_USER_URL&quot;).replace(&quot;{identifier}&quot;,userLogin);Ext.Ajax.request({url:loadUrl.get(&quot;APP_URL&quot;)+a+&quot;/&quot;+DEFAULT_PREFERENCES_FOLDER+&quot;/&quot;+this.projectName+&quot;/desktop?media=json&quot;,method:&quot;GET&quot;,scope:this,success:function(b){try{this.preferences=Ext.decode(b.responseText);this.callback.call()}catch(c){this.callback.call()}},failure:function(b){this.getPublicPreferences()}})}else{this.getPublicPreferences()}},getPublicPreferences:function(){var a=loadUrl.get(&quot;APP_PUBLIC_STORAGE_URL&quot;);Ext.Ajax.request({url:loadUrl.get(&quot;APP_URL&quot;)+a+&quot;/&quot;+DEFAULT_PREFERENCES_FOLDER+&quot;/&quot;+this.projectName+&quot;/desktop?media=json&quot;,method:&quot;GET&quot;,scope:this,success:function(b){try{this.preferences=Ext.decode(b.responseText)}catch(c){this.preferences=null}},callback:this.callback})}};userLogin=Ext.util.Cookies.get(&quot;userLogin&quot;);var userStorage={set:function(a,c,b,d){this.url=loadUrl.get(&quot;APP_URL&quot;)+loadUrl.get(&quot;APP_USERSTORAGE_USER_URL&quot;).replace(&quot;{identifier}&quot;,userLogin);Ext.Ajax.request({url:this.url,method:&quot;POST&quot;,scope:this,params:{filepath:c,filename:a},jsonData:b,success:function(g){var e=Ext.decode(g.responseText);if(!e.success){Ext.Msg.alert(i18n.get(&quot;label.warning&quot;),e.message);return}else{var k=new Ext.ux.Notification({iconCls:&quot;x-icon-information&quot;,title:i18n.get(&quot;label.information&quot;),html:e.message,autoDestroy:true,hideDelay:1000});k.show(document)}},failure:function(){Ext.Msg.alert(i18n.get(&quot;label.warning&quot;),i18n.get(&quot;label.warning.savepreference.error&quot;));return},callback:function(){if(!Ext.isEmpty(d)){d.call()}}})},get:function(a,b){Ext.Ajax.request({url:this.url+&quot;/?media=json&quot;,method:&quot;GET&quot;,scope:this,params:{filepath:b,filename:a},success:function(d){try{alert(&quot;success&quot;);var c=Ext.decode(d.responseText);return c}catch(e){alert(e)}},failure:function(c){return null}})}};var publicStorage={set:function(a,c,b,d){this.url=loadUrl.get(&quot;APP_URL&quot;)+loadUrl.get(&quot;APP_PUBLIC_STORAGE_URL&quot;);Ext.Ajax.request({url:this.url,method:&quot;POST&quot;,scope:this,params:{filepath:c,filename:a},jsonData:b,success:function(g){var e=Ext.decode(g.responseText);if(!e.success){Ext.Msg.alert(i18n.get(&quot;label.warning&quot;),e.message);return}else{var k=new Ext.ux.Notification({iconCls:&quot;x-icon-information&quot;,title:i18n.get(&quot;label.information&quot;),html:e.message,autoDestroy:true,hideDelay:1000});k.show(document)}},failure:function(){Ext.Msg.alert(i18n.get(&quot;label.warning&quot;),i18n.get(&quot;label.warning.savepreference.error&quot;));return},callback:function(){if(!Ext.isEmpty(d)){d.call()}}})},get:function(a,b){Ext.Ajax.request({url:this.url+&quot;/?media=json&quot;,method:&quot;GET&quot;,scope:this,params:{filepath:b,filename:a},success:function(d){try{var c=Ext.decode(d.responseText);return c}catch(e){alert(e)}},failure:function(c){return null}})},remove:function(){this.url=loadUrl.get(&quot;APP_URL&quot;)+loadUrl.get(&quot;APP_PUBLIC_STORAGE_URL&quot;)+&quot;?recursive=true&quot;;Ext.Ajax.request({url:this.url,method:&quot;DELETE&quot;,scope:this,success:function(a){var b=new Ext.ux.Notification({iconCls:&quot;x-icon-information&quot;,title:i18n.get(&quot;label.information&quot;),html:i18n.get(&quot;label.publicUserPrefDeleted&quot;),autoDestroy:true,hideDelay:1000});b.show(document)},failure:function(a){if(a.status==404){var b=new Ext.ux.Notification({iconCls:&quot;x-icon-information&quot;,title:i18n.get(&quot;label.information&quot;),html:i18n.get(&quot;label.publicUserPrefDeleted&quot;),autoDestroy:true,hideDelay:1000});b.show(document)}else{var c=new Ext.ux.Notification({iconCls:&quot;x-icon-error&quot;,title:i18n.get(&quot;label.error&quot;),html:a.responseText,autoDestroy:true,hideDelay:1000});c.show(document)}}})}};function showResponse(b,e){try{var a=Ext.decode(b.responseText);if(!a.success){Ext.Msg.alert(i18n.get(&quot;label.warning&quot;),a.message);return false}if(e){var c=new Ext.ux.Notification({iconCls:&quot;x-icon-information&quot;,title:i18n.get(&quot;label.information&quot;),html:a.message,autoDestroy:true,hideDelay:1000});c.show(document)}return true}catch(d){Ext.Msg.alert(i18n.get(&quot;label.warning&quot;),i18n.get(&quot;warning.javascriptError&quot;)+&quot; : &quot;+d);return false}}var commonTreeUtils={addShowData:function(a,b){a.appendChild({id:&quot;nodedata&quot;+b.id,text:i18n.get(&quot;label.dataTitle&quot;),winTitle:i18n.get(&quot;label.dataTitle&quot;)+&quot; : &quot;+b.name,leaf:true,type:&quot;data&quot;,datasetId:b.id,columnModel:b.columnModel,datasetName:b.name,datasetDescription:b.description,dataUrl:b.sitoolsAttachementForUsers,dictionaryMappings:b.dictionaryMappings,icon:loadUrl.get(&quot;APP_URL&quot;)+&quot;/common/res/images/icons/tree_datasets.png&quot;,datasetView:b.datasetView,datasetViewConfig:b.datasetViewConfig})},addShowDefinition:function(a,b){a.appendChild({text:i18n.get(&quot;label.definitionTitle&quot;),winTitle:i18n.get(&quot;label.definitionTitle&quot;)+&quot; : &quot;+b.name,leaf:true,type:&quot;defi&quot;,datasetId:b.id,columnModel:b.columnModel,datasetName:b.name,dictionaryMappings:b.dictionaryMappings,icon:loadUrl.get(&quot;APP_URL&quot;)+&quot;/common/res/images/icons/tree_dictionary.png&quot;})},addOpensearch:function(a,b){a.appendChild({text:i18n.get(&quot;label.opensearch&quot;),winTitle:i18n.get(&quot;label.opensearch&quot;)+&quot; : &quot;+b.name,leaf:true,type:&quot;openSearch&quot;,datasetId:b.id,columnModel:b.columnModel,datasetName:b.name,dataUrl:b.sitoolsAttachementForUsers,icon:loadUrl.get(&quot;APP_URL&quot;)+&quot;/common/res/images/icons/toolbar_open_search.png&quot;})},addForm:function(a,b){a.appendChild({text:i18n.get(&quot;label.forms&quot;),leaf:false,children:[{leaf:true}],datasetId:b.id,columnModel:b.columnModel,datasetName:b.name,listeners:{scope:this,beforeexpand:function(d){var c=new Ext.data.Connection();c.request({url:b.sitoolsAttachementForUsers+&quot;/forms?media=json&quot;,success:function(g){d.removeAll(true);var e=Ext.decode(g.responseText);if(!e.success){Ext.msg.alert(i18n.get(&quot;label.warning&quot;),e.message);return}Ext.each(e.data,function(k){d.appendChild({leaf:true,winTitle:i18n.get(&quot;label.forms&quot;)+&quot; : &quot;+b.name+&quot;.&quot;+k.name,datasetId:b.id,columnModel:b.columnModel,datasetName:b.name,dataUrl:b.sitoolsAttachementForUsers,type:&quot;form&quot;,text:k.name,formId:k.id,formName:k.name,formParameters:k.parameters,formWidth:k.width,formHeight:k.height,formCss:k.css,node:this,icon:loadUrl.get(&quot;APP_URL&quot;)+&quot;/common/res/images/icons/tree_forms.png&quot;,datasetView:b.datasetView})})}})}}})},addFeeds:function(a,b){a.appendChild({text:i18n.get(&quot;label.feeds&quot;),leaf:false,children:[{leaf:true}],datasetId:b.id,datasetName:b.name,listeners:{scope:this,beforeexpand:function(d){var c=new Ext.data.Connection();c.request({url:b.sitoolsAttachementForUsers+&quot;/feeds?media=json&quot;,success:function(g){d.removeAll(true);var e=Ext.decode(g.responseText);if(!e.success){Ext.msg.alert(i18n.get(&quot;label.warning&quot;),e.message);return}Ext.each(e.data,function(k){d.appendChild({leaf:true,winTitle:i18n.get(&quot;label.feeds&quot;)+&quot; : &quot;+b.name+&quot;.&quot;+k.title,type:&quot;feeds&quot;,text:k.name,datasetId:b.id,feedId:k.name,dataUrl:b.sitoolsAttachementForUsers,feedType:k.feedType,feedSource:k.feedSource,datasetName:b.name,icon:loadUrl.get(&quot;APP_URL&quot;)+&quot;/common/res/images/icons/rss.png&quot;})})}})}}})},treeAction:function(node){var desktop=getDesktop();var win=desktop.getWindow(&quot;wind&quot;+node.id);if(!win){var componentCfg,javascriptObject;var windowConfig={title:node.attributes.winTitle,datasetName:node.attributes.datasetName,datasetDescription:node.attributes.datasetDescription,type:node.attributes.type,saveToolbar:true,toolbarItems:[]};if(node.attributes.type==&quot;data&quot;){javascriptObject=eval(node.attributes.datasetView.jsObject);componentCfg={dataUrl:node.attributes.dataUrl,datasetId:node.attributes.datasetId,datasetCm:node.attributes.columnModel,datasetName:node.attributes.datasetName,dictionaryMappings:node.attributes.dictionaryMappings,datasetViewConfig:node.attributes.datasetViewConfig}}if(node.attributes.type==&quot;defi&quot;){javascriptObject=sitools.user.component.columnsDefinition;Ext.apply(windowConfig,{id:node.attributes.type+node.attributes.datasetId});componentCfg={datasetId:node.attributes.datasetId,datasetCm:node.attributes.columnModel,datasetName:node.attributes.datasetName,dictionaryMappings:node.attributes.dictionaryMappings}}if(node.attributes.type==&quot;openSearch&quot;){javascriptObject=sitools.user.component.datasetOpensearch;Ext.apply(windowConfig,{id:node.attributes.type+node.attributes.datasetId});componentCfg={datasetId:node.attributes.datasetId,dataUrl:node.attributes.dataUrl,datasetName:node.attributes.datasetName}}if(node.attributes.type==&quot;form&quot;){javascriptObject=sitools.user.component.forms;Ext.apply(windowConfig,{id:node.attributes.type+node.attributes.datasetId+node.attributes.formId});componentCfg={dataUrl:node.attributes.dataUrl,formId:node.attributes.formId,formName:node.attributes.formName,formParameters:node.attributes.formParameters,formWidth:node.attributes.formWidth,formHeight:node.attributes.formHeight,formCss:node.attributes.formCss}}if(node.attributes.type==&quot;feeds&quot;){javascriptObject=sitools.widget.FeedGridFlux;var url=node.attributes.dataUrl+&quot;/clientFeeds/&quot;+node.attributes.feedId;Ext.apply(windowConfig,{id:node.attributes.type+node.attributes.datasetId+node.attributes.feedId});componentCfg={datasetId:node.attributes.datasetId,urlFeed:url,feedType:node.attributes.feedType,datasetName:node.attributes.datasetName,feedSource:node.attributes.feedSource,autoLoad:true}}SitoolsDesk.addDesktopWindow(windowConfig,componentCfg,javascriptObject)}else{win.toFront()}}};
/*!
 * Ext JS Library 3.0+
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
var DEFAULT_NATIVEJSON=false;var DEFAULT_TIMEOUT=30000;var DEFAULT_TIMEBUF=10;var DEFAULT_NBRETRY=0;var SERVER_OK=200;var DEFAULT_WIN_HEIGHT=400;var DEFAULT_WIN_WIDTH=600;var DEFAULT_WINORDER_WIDTH=400;var DEFAULT_ORDER_FOLDER=&quot;dataSelection&quot;;var DEFAULT_PREFERENCES_FOLDER=&quot;preferences&quot;;var DEFAULT_LIVEGRID_BUFFER_SIZE=300;var URL_CGU=&quot;/sitools/res/licences/cgu.html&quot;;var COOKIE_DURATION=20;var MULTIDS_TIME_DELAY=2000;var DEFAULT_NEAR_LIMIT_SIZE=100;Ext.BLANK_IMAGE_URL=&quot;/sitools/cots/extjs/resources/images/default/s.gif&quot;;Ext.USE_NATIVE_JSON=DEFAULT_NATIVEJSON;Ext.Ajax.timeout=DEFAULT_TIMEOUT;var onBeforeRequest=function(k,d){var c=new Date();if(!Ext.isEmpty(Ext.util.Cookies.get(&quot;scheme&quot;))){if(Ext.util.Cookies.get(&quot;scheme&quot;)==&quot;HTTP_Digest&quot;){var e=null;var l=&quot;GET&quot;;if(!Ext.isEmpty(d.method)){l=d.method}var b=d.url;if(Ext.isEmpty(d.url)&amp;&amp;!Ext.isEmpty(d.scope)){if(!Ext.isEmpty(d.scope.url)){b=d.scope.url}}var a=Ext.util.Cookies.get(&quot;A1&quot;);var g=new Digest({usr:Ext.util.Cookies.get(&quot;userLogin&quot;),algorithm:Ext.util.Cookies.get(&quot;algorithm&quot;),realm:Ext.util.Cookies.get(&quot;realm&quot;),url:b,nonce:Ext.util.Cookies.get(&quot;nonce&quot;),method:l,mode:&quot;digest&quot;,A1:a});Ext.apply(Ext.Ajax.defaultHeaders,{Authorization:g.getDigestAuth()})}else{if(!Ext.isEmpty(Ext.util.Cookies.get(&quot;hashCode&quot;))){Ext.util.Cookies.set(&quot;hashCode&quot;,Ext.util.Cookies.get(&quot;hashCode&quot;),c.add(Date.MINUTE,COOKIE_DURATION));Ext.apply(Ext.Ajax.defaultHeaders,{Authorization:Ext.util.Cookies.get(&quot;hashCode&quot;)})}}}if(!Ext.isEmpty(Ext.util.Cookies.get(&quot;userLogin&quot;))){Ext.util.Cookies.set(&quot;userLogin&quot;,Ext.util.Cookies.get(&quot;userLogin&quot;),c.add(Date.MINUTE,20))}};Ext.Ajax.on(&quot;beforerequest&quot;,onBeforeRequest,this);var LOCALE;var SITOOLS_DATE_FORMAT=&quot;Y-m-d\\TH:i:s.u&quot;;var SITOOLS_DEFAULT_IHM_DATE_FORMAT=&quot;Y-m-d H:i:s.u&quot;;if(Ext.isEmpty(Ext.util.Cookies.get(&quot;language&quot;))){LOCALE=&quot;en&quot;}else{LOCALE=Ext.util.Cookies.get(&quot;language&quot;)}var onRequestFeedException=function(d,e,g,c,a,b){if((a.status==403)&amp;&amp;!Ext.isEmpty(Ext.util.Cookies.get(&quot;hashCode&quot;))){Ext.MessageBox.minWidth=360;Ext.MessageBox.alert(i18n.get(&quot;label.session.expired&quot;),a.responseText)}else{Ext.MessageBox.minWidth=360;Ext.MessageBox.alert(i18n.get(&quot;label.error&quot;),a.responseText)}return false};var desktop;var projectGlobal;var projectId;function alertFailure(b,d){var a;if(b.status==SERVER_OK){var c=Ext.decode(b.responseText).message;a=i18n.get(&quot;msg.error&quot;)+&quot;: &quot;+c}else{a=i18n.get(&quot;warning.serverError&quot;)+&quot;: &quot;+b.statusText}Ext.Msg.alert(i18n.get(&quot;label.warning&quot;),a)}function extColModelToJsonColModel(a){var b=[];var c;if(!Ext.isEmpty(a.columns)){c=a.columns}else{c=a}Ext.each(c,function(d){b.push({columnAlias:d.columnAlias,dataIndex:d.dataIndexSitools,dataIndexSitools:d.dataIndexSitools,header:d.header,filter:d.filter,hidden:d.hidden,id:d.id,previewColumn:d.previewColumn,primaryKey:d.primaryKey,schema:d.schema,sortable:d.sortable,sqlColumnType:d.sqlColumnType,tableAlias:d.tableAlias,tableName:d.tableName,toolTip:d.tooltip,urlColumn:d.urlColumn,width:d.width,columnRenderer:d.columnRenderer,specificColumnType:d.specificColumnType,javaSqlColumnType:d.javaSqlColumnType,format:d.format})});return b}function extColModelToSrv(a){var b=[];var c;if(!Ext.isEmpty(a.columns)){c=a.columns}else{c=a}Ext.each(c,function(d){if(!d.hidden){b.push(d.columnAlias)}});return b.join(&quot;, &quot;)}function extColModelToStorage(a){var b=[];var c;if(!Ext.isEmpty(a.columns)){c=a.columns}else{c=a}Ext.each(c,function(d){if(!d.hidden){b.push({columnAlias:d.columnAlias,dataIndex:d.dataIndex,dataIndexSitools:d.dataIndexSitools,editor:d.editor,filter:d.filter,header:d.header,hidden:d.hidden,id:d.id,isColumn:d.isColumn,previewColumn:d.previewColumn,primaryKey:d.primaryKey,schema:d.schema,sortable:d.sortable,sqlColumnType:d.sqlColumnType,tableAlias:d.tableAlias,tableName:d.tableName,toolTip:d.tooltip,urlColumn:d.urlColumn,width:d.width,columnRenderer:d.columnRenderer,specificColumnType:d.specificColumnType,javaSqlColumnType:d.javaSqlColumnType,unit:d.unit,format:d.format})}});return b}function getDesktop(){if(Ext.isEmpty(this.SitoolsDesk)){return null}else{return this.SitoolsDesk.app.desktop}}function getApp(){if(Ext.isEmpty(SitoolsDesk)){return null}else{return SitoolsDesk.app}}Ext.override(Ext.Window,{initEvents:function(){Ext.Window.superclass.initEvents.call(this);if(this.animateTarget){this.setAnimateTarget(this.animateTarget)}if(this.resizable){this.resizer=new Ext.Resizable(this.el,{minWidth:this.minWidth,minHeight:this.minHeight,handles:this.resizeHandles||&quot;all&quot;,pinned:true,resizeElement:this.resizerAction,handleCls:&quot;x-window-handle&quot;});this.resizer.window=this;this.mon(this.resizer,&quot;beforeresize&quot;,this.beforeResize,this)}if(this.draggable){this.header.addClass(&quot;x-window-draggable&quot;)}this.mon(this.el,&quot;mousedown&quot;,this.toFront,this);var a=getDesktop();if(Ext.isEmpty(a)){this.manager=Ext.WindowMgr}else{this.manager=getDesktop().getManager()||Ext.WindowMgr}this.manager.register(this);if(this.maximized){this.maximized=false;this.maximize()}if(this.closable){var b=this.getKeyMap();b.on(27,this.onEsc,this);b.disable()}}});Ext.override(Ext.grid.GridPanel,{stripeRows:true});Ext.data.Types.DATEASSTRING={convert:function(a,b){return a},sortType:function(a){return a},type:&quot;dateAsString&quot;};function includeJs(b){if(Ext.isEmpty(b)){return}var c=document.getElementsByTagName(&quot;head&quot;)[0];var a=document.createElement(&quot;script&quot;);a.setAttribute(&quot;src&quot;,b);a.setAttribute(&quot;type&quot;,&quot;text/javascript&quot;);c.appendChild(a)}Ext.override(Ext.PagingToolbar,{initComponent:function(){var a=Ext.Toolbar;var c=[this.first=new a.Button({tooltip:this.firstText,overflowText:this.firstText,iconCls:&quot;x-tbar-page-first&quot;,disabled:true,handler:this.moveFirst,scope:this}),this.prev=new a.Button({tooltip:this.prevText,overflowText:this.prevText,iconCls:&quot;x-tbar-page-prev&quot;,disabled:true,handler:this.movePrevious,scope:this}),&quot;-&quot;,this.beforePageText,this.inputItem=new Ext.form.NumberField({cls:&quot;x-tbar-page-number&quot;,allowDecimals:false,allowNegative:false,enableKeyEvents:true,selectOnFocus:true,submitValue:false,listeners:{scope:this,keydown:this.onPagingKeyDown,blur:this.onPagingBlur}}),this.afterTextItem=new a.TextItem({text:String.format(this.afterPageText,1)}),&quot;-&quot;,this.next=new a.Button({tooltip:this.nextText,overflowText:this.nextText,iconCls:&quot;x-tbar-page-next&quot;,disabled:true,handler:this.moveNext,scope:this}),this.last=new a.Button({tooltip:this.lastText,overflowText:this.lastText,iconCls:&quot;x-tbar-page-last&quot;,disabled:true,handler:this.moveLast,scope:this}),&quot;-&quot;];var b=this.items||this.buttons||[];if(this.prependButtons){this.items=b.concat(c)}else{this.items=c.concat(b)}delete this.buttons;if(this.displayInfo){this.items.push(&quot;-&gt;&quot;);this.items.push(this.displayItem=new a.TextItem({}))}Ext.PagingToolbar.superclass.initComponent.call(this);this.addEvents(&quot;change&quot;,&quot;beforechange&quot;);this.on(&quot;afterlayout&quot;,this.onFirstLayout,this,{single:true});this.cursor=0;this.bindStore(this.store,true)},onFirstLayout:function(){this.refresh=new Ext.Toolbar.Button({tooltip:i18n.get(&quot;label.refreshText&quot;),overflowText:i18n.get(&quot;label.refreshText&quot;),iconCls:&quot;x-tbar-loading&quot;,handler:this.doRefresh,scope:this});this.insert(10,this.refresh);if(this.dsLoaded){this.onLoad.apply(this,this.dsLoaded)}}});function getColumnModel(d,e,b){var c=[];if(!Ext.isEmpty(d)){Ext.each(d,function(m,k,r){var q=&quot;&quot;;if(m.toolTip){q=m.toolTip}else{if(Ext.isArray(e)&amp;&amp;!Ext.isEmpty(e)){var l=e[0];var g=l.mapping||[];g.each(function(s){if(m.columnAlias==s.columnAlias){var t=s.concept||{};if(!Ext.isEmpty(t.description)){q+=t.description.replace('&quot;',&quot;''&quot;)+&quot;&lt;br&gt;&quot;}}})}}var p=sitools.user.component.dataviews.dataviewUtils.getRendererLiveGrid(m,b);var n;if(Ext.isEmpty(m.visible)){n=m.hidden}else{n=!m.visible}if(Ext.isEmpty(m.columnRenderer)||ColumnRendererEnum.NO_CLIENT_ACCESS!=m.columnRenderer.behavior){c.push(new Ext.grid.Column({columnAlias:m.columnAlias,dataIndexSitools:m.dataIndex,dataIndex:m.columnAlias,header:m.header,width:m.width,sortable:m.sortable,hidden:n,tooltip:q,renderer:p,schema:m.schema,tableName:m.tableName,tableAlias:m.tableAlias,id:m.id,primaryKey:m.primaryKey,previewColumn:m.previewColumn,filter:m.filter,sqlColumnType:m.sqlColumnType,columnRenderer:m.columnRenderer,specificColumnType:m.specificColumnType,format:m.format}))}},this)}var a=new Ext.grid.ColumnModel({columns:c});return a}Ext.override(Ext.menu.DateMenu,{initComponent:function(){this.on(&quot;beforeshow&quot;,this.onBeforeShow,this);if(this.strict==(Ext.isIE7&amp;&amp;Ext.isStrict)){this.on(&quot;show&quot;,this.onShow,this,{single:true,delay:20})}Ext.apply(this,{plain:true,showSeparator:false,items:this.picker=new Ext.SitoolsDatePicker(Ext.applyIf({internalRender:this.strict||!Ext.isIE,ctCls:&quot;x-menu-date-item&quot;,id:this.pickerId},this.initialConfig))});this.picker.purgeListeners();Ext.menu.DateMenu.superclass.initComponent.call(this);this.relayEvents(this.picker,[&quot;select&quot;]);this.on(&quot;show&quot;,this.picker.focus,this.picker);this.on(&quot;select&quot;,this.menuHide,this);if(this.handler){this.on(&quot;select&quot;,this.handler,this.scope||this)}}});Ext.override(Ext.form.DateField,{showTime:false,onTriggerClick:function(){if(this.disabled){return}if(Ext.isEmpty(this.menu)){this.menu=new Ext.menu.DateMenu({hideOnClick:false,showTime:this.showTime,focusOnSelect:false})}this.onFocus();Ext.apply(this.menu.picker,{minDate:this.minValue,maxDate:this.maxValue,disabledDatesRE:this.disabledDatesRE,disabledDatesText:this.disabledDatesText,disabledDays:this.disabledDays,disabledDaysText:this.disabledDaysText,format:this.format,showToday:this.showToday,minText:String.format(this.minText,this.formatDate(this.minValue)),maxText:String.format(this.maxText,this.formatDate(this.maxValue))});this.menu.picker.setValue(this.getValue()||new Date());this.menu.show(this.el,&quot;tl-bl?&quot;);this.menuEvents(&quot;on&quot;)}});function viewFileContent(a,b){Ext.Ajax.request({url:a,method:&quot;HEAD&quot;,scope:this,success:function(d){try{var c=d.getResponseHeader(&quot;Content-Type&quot;).split(&quot;;&quot;)[0].split(&quot;/&quot;)[0];if(c==&quot;text&quot;||d.getResponseHeader(&quot;Content-Type&quot;).indexOf(&quot;application/json&quot;)&gt;=0){Ext.Ajax.request({url:a,method:&quot;GET&quot;,scope:this,success:function(l){var g={id:&quot;winPreferenceDetailId&quot;,title:b};var m=Ext.Panel;var k={layout:&quot;fit&quot;,autoScroll:true,html:l.responseText};SitoolsDesk.addDesktopWindow(g,k,m)}})}else{if(c==&quot;image&quot;){sitools.user.component.dataviews.dataviewUtils.showPreview(a,b)}else{sitools.user.component.dataviews.dataviewUtils.downloadFile(a)}}}catch(e){Ext.Msg.alert(i18n.get(&quot;label.error&quot;),e)}},failure:function(c){return null}})}Ext.override(Ext.data.XmlReader,{buildExtractors:function(){if(this.ef){return}var n=this.meta,k=this.recordType,e=k.prototype.fields,m=e.items,l=e.length;if(n.totalProperty){this.getTotal=this.createAccessor(n.totalProperty)}if(n.successProperty){this.getSuccess=this.createAccessor(n.successProperty)}if(n.messageProperty){this.getMessage=this.createAccessor(n.messageProperty)}this.getRoot=function(g){return(!Ext.isEmpty(g[this.meta.record]))?g[this.meta.record]:g[this.meta.root]};if(n.idPath||n.idProperty){var d=this.createAccessor(n.idPath||n.idProperty);this.getId=function(g){var p=d(g)||g.id;return(p===undefined||p===&quot;&quot;)?null:p}}else{this.getId=function(){return null}}var c=[];for(var b=0;b&lt;l;b++){e=m[b];var a=(e.mapping!==undefined&amp;&amp;e.mapping!==null)?e.mapping:e.name;if(e.createAccessor!==undefined&amp;&amp;e.createAccessor!==null){c.push(e.createAccessor)}else{c.push(this.createAccessor(a))}}this.ef=c}});Ext.override(Ext.layout.BorderLayout.Region,{getCollapsedEl:function(){if(!this.collapsedEl){if(!this.toolTemplate){var b=new Ext.Template('&lt;span class=&quot;x-panel-collapsed-text&quot;&gt;{title}&lt;/span&gt;','&lt;div class=&quot;x-tool x-tool-{id}&quot;&gt;&amp;#160;&lt;/div&gt;');b.disableFormats=true;b.compile();Ext.layout.BorderLayout.Region.prototype.toolTemplate=b}this.collapsedEl=this.targetEl.createChild({cls:&quot;x-layout-collapsed x-layout-collapsed-&quot;+this.position,id:this.panel.id+&quot;-xcollapsed&quot;});this.collapsedEl.enableDisplayMode(&quot;block&quot;);if(this.collapseMode==&quot;mini&quot;){this.collapsedEl.addClass(&quot;x-layout-cmini-&quot;+this.position);this.miniCollapsedEl=this.collapsedEl.createChild({cls:&quot;x-layout-mini x-layout-mini-&quot;+this.position,html:&quot;&amp;#160;&quot;});this.miniCollapsedEl.addClassOnOver(&quot;x-layout-mini-over&quot;);this.collapsedEl.addClassOnOver(&quot;x-layout-collapsed-over&quot;);this.collapsedEl.on(&quot;click&quot;,this.onExpandClick,this,{stopEvent:true})}else{if(this.collapsible!==false&amp;&amp;!this.hideCollapseTool){var a=this.expandToolEl=this.toolTemplate.append(this.collapsedEl.dom,{id:&quot;expand-&quot;+this.position,title:this.panel.collapsedTitle},true);a.addClassOnOver(&quot;x-tool-expand-&quot;+this.position+&quot;-over&quot;);a.on(&quot;click&quot;,this.onExpandClick,this,{stopEvent:true})}if(this.floatable!==false||this.titleCollapse){this.collapsedEl.addClassOnOver(&quot;x-layout-collapsed-over&quot;);this.collapsedEl.on(&quot;click&quot;,this[this.floatable?&quot;collapseClick&quot;:&quot;onExpandClick&quot;],this)}}}return this.collapsedEl}});Ext.ns(&quot;sitools.user&quot;);sitools.user.clickDatasetIcone=function(url,type,extraCmpConfig){Ext.Ajax.request({method:&quot;GET&quot;,url:url,success:function(ret){var Json=Ext.decode(ret.responseText);if(showResponse(ret)){var dataset=Json.dataset;var componentCfg,javascriptObject;var windowConfig={datasetName:dataset.name,type:type,saveToolbar:true,toolbarItems:[]};switch(type){case&quot;desc&quot;:Ext.apply(windowConfig,{title:i18n.get(&quot;label.description&quot;)+&quot; : &quot;+dataset.name,id:&quot;desc&quot;+dataset.id,saveToolbar:false});componentCfg={autoScroll:true,html:dataset.descriptionHTML};Ext.applyIf(componentCfg,extraCmpConfig);javascriptObject=Ext.Panel;SitoolsDesk.addDesktopWindow(windowConfig,componentCfg,javascriptObject);break;case&quot;data&quot;:javascriptObject=eval(dataset.datasetView.jsObject);Ext.apply(windowConfig,{title:i18n.get(&quot;label.dataTitle&quot;)+&quot; : &quot;+dataset.name,id:type+dataset.id});componentCfg={dataUrl:dataset.sitoolsAttachementForUsers,datasetId:dataset.id,datasetCm:dataset.columnModel,datasetName:dataset.name,dictionaryMappings:dataset.dictionaryMappings,datasetViewConfig:dataset.datasetViewConfig};Ext.applyIf(componentCfg,extraCmpConfig);SitoolsDesk.addDesktopWindow(windowConfig,componentCfg,javascriptObject);break;case&quot;forms&quot;:var menuForms=new Ext.menu.Menu();Ext.Ajax.request({method:&quot;GET&quot;,url:dataset.sitoolsAttachementForUsers+&quot;/forms&quot;,success:function(ret){try{var Json=Ext.decode(ret.responseText);if(!Json.success){throw Json.message}if(Json.total===0){throw i18n.get(&quot;label.noForms&quot;)}javascriptObject=sitools.user.component.forms;if(Json.total==1){var form=Json.data[0];Ext.apply(windowConfig,{title:i18n.get(&quot;label.forms&quot;)+&quot; : &quot;+dataset.name+&quot;.&quot;+form.name});Ext.apply(windowConfig,{id:type+dataset.id+form.id});componentCfg={dataUrl:dataset.sitoolsAttachementForUsers,dataset:dataset,formId:form.id,formName:form.name,formParameters:form.parameters,formWidth:form.width,formHeight:form.height,formCss:form.css};Ext.applyIf(componentCfg,extraCmpConfig);SitoolsDesk.addDesktopWindow(windowConfig,componentCfg,javascriptObject)}else{var handler=null;Ext.each(Json.data,function(form){handler=function(form,dataset){Ext.apply(windowConfig,{title:i18n.get(&quot;label.forms&quot;)+&quot; : &quot;+dataset.name+&quot;.&quot;+form.name});Ext.apply(windowConfig,{id:type+dataset.id+form.id});componentCfg={dataUrl:dataset.sitoolsAttachementForUsers,formId:form.id,formName:form.name,formParameters:form.parameters,formWidth:form.width,formHeight:form.height,formCss:form.css,dataset:dataset};Ext.applyIf(componentCfg,extraCmpConfig);SitoolsDesk.addDesktopWindow(windowConfig,componentCfg,javascriptObject)};menuForms.addItem({text:form.name,handler:function(){handler(form,dataset)},icon:loadUrl.get(&quot;APP_URL&quot;)+&quot;/common/res/images/icons/tree_forms.png&quot;})},this);menuForms.showAt(Ext.EventObject.xy)}}catch(err){var tmp=new Ext.ux.Notification({iconCls:&quot;x-icon-information&quot;,title:i18n.get(&quot;label.information&quot;),html:i18n.get(err),autoDestroy:true,hideDelay:1000}).show(document)}}});break;case&quot;feeds&quot;:var menuFeeds=new Ext.menu.Menu();Ext.Ajax.request({method:&quot;GET&quot;,url:dataset.sitoolsAttachementForUsers+&quot;/feeds&quot;,success:function(ret){try{var Json=Ext.decode(ret.responseText);if(!Json.success){throw Json.message}if(Json.total===0){throw i18n.get(&quot;label.noFeeds&quot;)}javascriptObject=sitools.widget.FeedGridFlux;if(Json.total==1){var feed=Json.data[0];Ext.apply(windowConfig,{title:i18n.get(&quot;label.feeds&quot;)+&quot; : &quot;+dataset.name+&quot;.&quot;+feed.title,id:type+dataset.id+feed.id});componentCfg={datasetId:dataset.id,urlFeed:dataset.sitoolsAttachementForUsers+&quot;/clientFeeds/&quot;+feed.name,feedType:feed.feedType,datasetName:dataset.name,feedSource:feed.feedSource,autoLoad:true};Ext.applyIf(componentCfg,extraCmpConfig);SitoolsDesk.addDesktopWindow(windowConfig,componentCfg,javascriptObject)}else{var handler=null;Ext.each(Json.data,function(feed){handler=function(feed,dataset){Ext.apply(windowConfig,{title:i18n.get(&quot;label.feeds&quot;)+&quot; : &quot;+dataset.name+&quot;.&quot;+feed.title,id:type+dataset.id+feed.id});componentCfg={datasetId:dataset.id,urlFeed:dataset.sitoolsAttachementForUsers+&quot;/clientFeeds/&quot;+feed.name,feedType:feed.feedType,datasetName:dataset.name,feedSource:feed.feedSource,autoLoad:true};Ext.applyIf(componentCfg,extraCmpConfig);SitoolsDesk.addDesktopWindow(windowConfig,componentCfg,javascriptObject)};menuFeeds.addItem({text:feed.name,handler:function(){handler(feed,dataset)},icon:loadUrl.get(&quot;APP_URL&quot;)+&quot;/common/res/images/icons/rss.png&quot;})},this);menuFeeds.showAt(Ext.EventObject.xy)}}catch(err){var tmp=new Ext.ux.Notification({iconCls:&quot;x-icon-information&quot;,title:i18n.get(&quot;label.information&quot;),html:i18n.get(err),autoDestroy:true,hideDelay:1000}).show(document)}}});break;case&quot;defi&quot;:Ext.apply(windowConfig,{title:i18n.get(&quot;label.definitionTitle&quot;)+&quot; : &quot;+dataset.name,id:type+dataset.id});javascriptObject=sitools.user.component.columnsDefinition;componentCfg={datasetId:dataset.id,datasetCm:dataset.columnModel,datasetName:dataset.name,dictionaryMappings:dataset.dictionaryMappings};Ext.applyIf(componentCfg,extraCmpConfig);SitoolsDesk.addDesktopWindow(windowConfig,componentCfg,javascriptObject);break;case&quot;openSearch&quot;:Ext.Ajax.request({method:&quot;GET&quot;,url:dataset.sitoolsAttachementForUsers+&quot;/opensearch.xml&quot;,success:function(ret){var xml=ret.responseXML;var dq=Ext.DomQuery;var success=dq.selectNode(&quot;OpenSearchDescription &quot;,xml);if(!success){var tmp=new Ext.ux.Notification({iconCls:&quot;x-icon-information&quot;,title:i18n.get(&quot;label.information&quot;),html:i18n.get(&quot;label.noOpenSearch&quot;),autoDestroy:true,hideDelay:1000}).show(document);return}Ext.apply(windowConfig,{title:i18n.get(&quot;label.opensearch&quot;)+&quot; : &quot;+dataset.name,id:type+dataset.id});javascriptObject=sitools.user.component.datasetOpensearch;componentCfg={datasetId:dataset.id,dataUrl:dataset.sitoolsAttachementForUsers,datasetName:dataset.name};Ext.applyIf(componentCfg,extraCmpConfig);SitoolsDesk.addDesktopWindow(windowConfig,componentCfg,javascriptObject)}});break}}},failure:alertFailure})};Ext.override(Ext.form.Field,{tooltip:null,listeners:{render:function(){Ext.form.Field.superclass.render.apply(this,arguments);if(!Ext.isEmpty(this.tooltip)){var a={};if(Ext.isString(this.tooltip)){a={html:this.tooltip,width:200,dismissDelay:5000}}else{if(Ext.isObject(this.tooltip)){a=this.tooltip}else{return}}Ext.apply(a,{target:this.el});this.tTip=new Ext.ToolTip(a)}}}});Ext.override(Ext.BoxComponent,{tooltip:null,listeners:{render:function(){Ext.BoxComponent.superclass.render.apply(this,arguments);if(!Ext.isEmpty(this.tooltip)){var a={};if(Ext.isString(this.tooltip)){a={html:this.tooltip,width:200,dismissDelay:5000}}else{if(Ext.isObject(this.tooltip)){a=this.tooltip}else{return}}Ext.apply(a,{target:this.el});this.tTip=new Ext.ToolTip(a)}}}});
/*!
 * Ext JS Library 3.2.1
 * Copyright(c) 2006-2010 Ext JS, Inc.
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
function initAppliDesktop(){return}var portal;var portalApp={projects:null,languages:null,preferences:null,autoChainAjaxRequest:true,initProjects:function(a){Ext.Ajax.request({scope:this,url:loadUrl.get(&quot;APP_URL&quot;)+loadUrl.get(&quot;APP_PORTAL_URL&quot;)+&quot;/projects?media=json&quot;,method:&quot;GET&quot;,success:function(b){try{this.projects=b.responseJSON.data;if(this.autoChainAjaxRequest){this.initLanguages()}}catch(c){Ext.Msg.alert(i18n.get(&quot;label.error&quot;),c)}},failure:function(b){Ext.Msg.alert(&quot;Status&quot;,i18n.get(&quot;warning.serverError&quot;))}})},initLanguages:function(){Ext.Ajax.request({scope:this,method:&quot;GET&quot;,url:loadUrl.get(&quot;APP_URL&quot;)+&quot;/client-user/tmp/langues.json&quot;,success:function(a){this.languages=a.responseJSON.data;if(this.autoChainAjaxRequest){this.initPreferences()}},failure:function(a){Ext.Msg.alert(&quot;Status&quot;,i18n.get(&quot;warning.serverError&quot;))}})},initPreferences:function(a){if(Ext.isEmpty(userLogin)){var d=this.projects;var e=this.languages;var b=this.preferences;var g;if(this.autoChainAjaxRequest){g=function(){portal=new sitools.Portal(d,e,b)}}else{g=a}i18n.load(loadUrl.get(&quot;APP_URL&quot;)+&quot;/res/i18n/&quot;+LOCALE+&quot;/gui.properties&quot;,g);return}var c=loadUrl.get(&quot;APP_USERSTORAGE_USER_URL&quot;).replace(&quot;{identifier}&quot;,userLogin);Ext.Ajax.request({scope:this,url:loadUrl.get(&quot;APP_URL&quot;)+c+&quot;/&quot;+DEFAULT_PREFERENCES_FOLDER+&quot;/portal/portal?media=json&quot;,method:&quot;GET&quot;,success:function(k){this.preferences=Ext.decode(k.responseText);if(!Ext.isEmpty(this.preferences.language)){LOCALE=this.preferences.language}},callback:function(){var l=this.projects;var m=this.languages;var k=this.preferences;i18n.load(loadUrl.get(&quot;APP_URL&quot;)+&quot;/res/i18n/&quot;+LOCALE+&quot;/gui.properties&quot;,function(){portal=new sitools.Portal(l,m,k)})}})},initAppliPortal:function(b,c){if(!Ext.isEmpty(Ext.util.Cookies.get(&quot;userLogin&quot;))){var a=Ext.util.Cookies.get(&quot;hashCode&quot;);Ext.Ajax.defaultHeaders={Authorization:a,Accept:&quot;application/json&quot;,&quot;User-Agent&quot;:&quot;Sitools&quot;}}else{Ext.Ajax.defaultHeaders={Accept:&quot;application/json&quot;,&quot;User-Agent&quot;:&quot;Sitools&quot;}}Ext.QuickTips.init();this.callSiteMapResource(b.siteMapRes,c)},callSiteMapResource:function(b,a){var c;if(this.autoChainAjaxRequest){c=this.initProjects}else{c=a}loadUrl.load(b+&quot;/siteMap&quot;,c,this)}};var ID={PANEL:{MENU:&quot;menuPanelId&quot;,TREE:&quot;treePanelId&quot;,MAIN:&quot;mainPanelId&quot;,HELP:&quot;helpPanelId&quot;},CMP:{TOOLBAR:&quot;toolbarId&quot;,MENU:&quot;menuId&quot;},WIN:{LOGIN:&quot;loginWinId&quot;,ORDER:&quot;orderWinId&quot;},BOX:{REG:&quot;regBoxId&quot;,USER:&quot;userBoxId&quot;,GROUP:&quot;groupBoxId&quot;,FIREWALL:&quot;firewallBoxId&quot;},PORTLET:{PROJET:&quot;portletProjectId&quot;,RECHERCHE:&quot;portletRecherceID&quot;,FEEDS:&quot;portletFeedsId&quot;},PORTALTREENAV:{PROJET:&quot;navProjectId&quot;,RECHERCHE:&quot;navRechercheId&quot;,FEEDS:&quot;navFeedsId&quot;}};sitools.Portal=function(e,m,r){var J;var b;if(Ext.isEmpty(Ext.util.Cookies.get(&quot;userLogin&quot;))){J=i18n.get(&quot;label.guest&quot;);b={xtype:&quot;tbbutton&quot;,text:i18n.get(&quot;label.connection&quot;),itemId:&quot;menu_login&quot;,icon:loadUrl.get(&quot;APP_URL&quot;)+&quot;/common/res/images/icons/login.png&quot;,handler:this.connect}}else{J=Ext.util.Cookies.get(&quot;userLogin&quot;);b={xtype:&quot;tbbutton&quot;,text:i18n.get(&quot;label.logout&quot;),itemId:&quot;menu_logout&quot;,icon:loadUrl.get(&quot;APP_URL&quot;)+&quot;/common/res/images/icons/logout.png&quot;,handler:function(){utils_logout()}}}var E={xtype:&quot;tbbutton&quot;,text:i18n.get(&quot;label.version&quot;),itemId:&quot;menu_version&quot;,icon:loadUrl.get(&quot;APP_URL&quot;)+&quot;/common/res/images/icons/version.png&quot;,handler:function(){showVersion()}};var B=new Ext.menu.Menu({plain:true});Ext.each(m,function(K){B.add({text:K.displayName,scope:this,handler:function(){var M=function(){Ext.util.Cookies.set(&quot;language&quot;,K.localName);window.location.reload()};var L=new Date();Ext.util.Cookies.set(&quot;language&quot;,K.localName,L.add(Date.MINUTE,20));userPreferences={};userPreferences.language=K.localName;if(!Ext.isEmpty(userLogin)){userStorage.set(loadUrl.get(&quot;APP_PORTAL_URL&quot;),&quot;/&quot;+DEFAULT_PREFERENCES_FOLDER+loadUrl.get(&quot;APP_PORTAL_URL&quot;),userPreferences,M)}else{window.location.reload()}},icon:K.image})},this);var k;if(!Ext.isEmpty(Ext.util.Cookies.get(&quot;userLogin&quot;))){k={xtype:&quot;tbbutton&quot;,text:i18n.get(&quot;label.editProfile&quot;),itemId:&quot;menu_editProfile&quot;,icon:loadUrl.get(&quot;APP_URL&quot;)+&quot;/common/res/images/icons/tree_userman.png&quot;,identifier:J,edit:loadUrl.get(&quot;APP_URL&quot;)+&quot;/editProfile/&quot;+J,handler:function(){var K=new sitools.widget.editProfile({closable:true,identifier:J,url:this.edit,handler:this.onRender});K.show()}}}else{k={xtype:&quot;tbbutton&quot;,hidden:true}}var p={xtype:&quot;toolbar&quot;,id:&quot;toolbar&quot;,items:[{xtype:&quot;label&quot;,html:&quot;&lt;img src=&quot;+loadUrl.get(&quot;APP_URL&quot;)+&quot;/common/res/images/cnes.png width=92 height=28&gt;&quot;},{xtype:&quot;label&quot;,html:&quot;&lt;img src=&quot;+loadUrl.get(&quot;APP_URL&quot;)+&quot;/common/res/images/logo_01_petiteTaille.png width=92 height=28&gt;&quot;},&quot;-&gt;&quot;,{xtype:&quot;label&quot;,margins:{top:0,right:10,bottom:0,left:10},text:i18n.get(&quot;label.welcome&quot;)+&quot; &quot;+J},&quot;-&quot;,E,&quot;-&quot;,{text:i18n.get(&quot;label.langues&quot;),menu:B},&quot;-&quot;,k,&quot;-&quot;,b]};var A=new Ext.Panel({id:&quot;north&quot;,region:&quot;north&quot;,layout:&quot;fit&quot;,height:28,items:[p]});var v=new Ext.Panel({id:&quot;tree&quot;,region:&quot;west&quot;,title:i18n.get(&quot;label.components&quot;),split:true,collapsible:true,autoScroll:true,width:200,layout:&quot;fit&quot;,defaults:{padding:10},collapsed:true});var D=[];var g=new Ext.data.JsonStore({fields:[&quot;id&quot;,&quot;name&quot;,&quot;description&quot;,&quot;image&quot;,&quot;authorized&quot;,&quot;maintenance&quot;,&quot;maintenanceText&quot;],sortInfo:{field:&quot;name&quot;,direction:&quot;ASC&quot;}});Ext.each(e,function(L){var K=new Ext.data.Record({id:L.id,name:L.name,description:L.description,image:L.image.url,authorized:L.authorized,maintenance:L.maintenance,maintenanceText:L.maintenanceText});g.add(K)});var z=new Ext.DataView({store:g,tpl:new Ext.XTemplate(&quot;&lt;ul&gt;&quot;,'&lt;tpl for=&quot;.&quot;&gt;','&lt;li id=&quot;{id}&quot; ','&lt;tpl if=&quot;authorized == true&quot;&gt;','class=&quot;project','&lt;tpl if=&quot;maintenance&quot;&gt;',&quot; sitools-maintenance-portal&quot;,&quot;&lt;/tpl&gt;&quot;,'&quot;',&quot;&lt;/tpl&gt;&quot;,'&lt;tpl if=&quot;authorized == false&quot;&gt;','class=&quot;project projectUnauthorized&quot;',&quot;&lt;/tpl&gt;&quot;,&quot;&gt;&quot;,'&lt;img width=&quot;80&quot; height=&quot;80&quot; src=&quot;{image}&quot; /&gt;',&quot;&lt;strong&gt;{name}&lt;/strong&gt;&quot;,&quot;&lt;span&gt;{description} &lt;/span&gt;&quot;,&quot;&lt;/li&gt;&quot;,&quot;&lt;/tpl&gt;&quot;,&quot;&lt;/ul&gt;&quot;,{compiled:true,disableFormats:true,isAuthorized:function(K){return K===true}}),id:&quot;projectDataView&quot;,itemSelector:&quot;li.project&quot;,overClass:&quot;project-hover&quot;,singleSelect:true,multiSelect:false,autoScroll:true,listeners:{scope:this,click:function(Q,O,L,P){var M=Q.getRecord(L).data;var T=M.name;var S=M.authorized;var K=M.maintenance;var N=M.maintenanceText;if(S){if(!K){window.open(T+&quot;/project-index.html&quot;)}else{var R=new Ext.Window({title:i18n.get(&quot;label.maintenance&quot;),width:600,height:400,autoScroll:true,items:[{xtype:&quot;panel&quot;,layout:&quot;fit&quot;,autoScroll:true,html:N,padding:&quot;5&quot;}],modal:true});R.show()}}else{this.connect()}}}});var d=new Ext.ux.Portlet({id:ID.PORTLET.PROJET,title:i18n.get(&quot;label.portletProjetTitle&quot;),height:560,items:[z],autoScroll:true});var t={xtype:&quot;sitools.component.users.portal.feedsReaderPortal&quot;};var n=new Ext.ux.Portlet({layout:&quot;fit&quot;,id:ID.PORTLET.FEEDS,title:i18n.get(&quot;title.portlelFeedsPortal&quot;),height:400,items:[t]});var u=new sitools.component.users.portal.portalOpensearch({dataUrl:loadUrl.get(&quot;APP_URL&quot;)+loadUrl.get(&quot;APP_PORTAL_URL&quot;),suggest:false,pagging:false});var a=new Ext.ux.Portlet({collapsed:true,bodyCssClass:&quot;portletRecherche&quot;,id:ID.PORTLET.RECHERCHE,title:i18n.get(&quot;label.portletRechercheTitle&quot;),items:[u],layout:&quot;fit&quot;,height:400});var C=new Ext.ux.ManagedIFrame.Panel({id:&quot;helpPanelId&quot;,title:i18n.get(&quot;label.helpTitle&quot;),autoScroll:true,defaults:{padding:10},defaultSrc:&quot;res/html/&quot;+LOCALE+&quot;/help.html&quot;});var s=new Ext.ux.ManagedIFrame.Panel({id:&quot;link&quot;,title:i18n.get(&quot;label.linkTitle&quot;),autoScroll:true,defaults:{padding:10},defaultSrc:&quot;res/html/&quot;+LOCALE+&quot;/link.html&quot;});var c=new Ext.ux.ManagedIFrame.Panel({id:&quot;help&quot;,title:i18n.get(&quot;label.contactTitle&quot;),autoScroll:true,defaults:{padding:10},defaultSrc:&quot;res/html/&quot;+LOCALE+&quot;/contact.html&quot;});var l=new Ext.TabPanel({baseCls:&quot;portalMainPanel&quot;,region:&quot;center&quot;,activeTab:0,items:[{xtype:&quot;panel&quot;,baseCls:&quot;portalMainPanel&quot;,autoScroll:true,title:i18n.get(&quot;label.portalTitle&quot;),items:[{region:&quot;north&quot;,xtype:&quot;iframepanel&quot;,title:i18n.get(&quot;label.freeText&quot;),autoScroll:true,defaults:{padding:10},defaultSrc:&quot;res/html/&quot;+LOCALE+&quot;/freeText.html&quot;,height:200},{region:&quot;center&quot;,baseCls:&quot;portalMainPanel&quot;,xtype:&quot;portal&quot;,id:&quot;portalId&quot;,margins:&quot;35 5 5 0&quot;,defaults:{style:&quot;padding:10px 0 10px 10px&quot;},items:[{columnWidth:0.5,style:&quot;padding:10px 0 10px 10px&quot;,items:[d]},{columnWidth:0.5,style:&quot;padding:10px&quot;,items:[n,a]}]}]},c,s,C]});sitools.Portal.superclass.constructor.call(this,Ext.apply({layout:&quot;border&quot;,items:[A,v,l]}));var q=new Ext.tree.TreePanel({id:&quot;panelNav&quot;,useArrows:true,autoScroll:true,animate:true,enableDD:false,containerScroll:true,rootVisible:false,width:200,root:new Ext.tree.AsyncTreeNode({expanded:true,children:[{id:ID.PORTALTREENAV.PROJET,panelId:ID.PORTLET.PROJET,icon:&quot;res/images/icons/portlet.png&quot;,text:i18n.get(&quot;label.portletProjetTitle&quot;),leaf:true,checked:true,listeners:{checkchange:function(K){if(!K.attributes.checked){Ext.get(K.attributes.panelId).hide();Ext.get(K.attributes.panelId).addClass(&quot;x-hide-display&quot;)}else{Ext.get(K.attributes.panelId).show();Ext.get(K.attributes.panelId).removeClass(&quot;x-hide-display&quot;)}}}},{id:ID.PORTALTREENAV.RECHERCHE,icon:&quot;res/images/icons/portlet.png&quot;,panelId:ID.PORTLET.RECHERCHE,text:i18n.get(&quot;label.portletRechercheTitle&quot;),leaf:true,checked:true,listeners:{checkchange:function(K){if(!K.attributes.checked){Ext.get(K.attributes.panelId).hide();Ext.get(K.attributes.panelId).addClass(&quot;x-hide-display&quot;)}else{Ext.get(K.attributes.panelId).show();Ext.get(K.attributes.panelId).removeClass(&quot;x-hide-display&quot;)}}}},{id:ID.PORTALTREENAV.FEEDS,icon:&quot;res/images/icons/portlet.png&quot;,panelId:ID.PORTLET.FEEDS,text:i18n.get(&quot;label.portletFeedsTitle&quot;),leaf:true,checked:true,listeners:{checkchange:function(K){if(!K.attributes.checked){Ext.get(K.attributes.panelId).hide();Ext.get(K.attributes.panelId).addClass(&quot;x-hide-display&quot;)}else{Ext.get(K.attributes.panelId).show();Ext.get(K.attributes.panelId).removeClass(&quot;x-hide-display&quot;)}}}}]}),listeners:{checkchange:function(L,K){if(K){L.getUI().addClass(&quot;complete&quot;)}else{L.getUI().removeClass(&quot;complete&quot;)}}}});v.add(q);v.doLayout()};Ext.extend(sitools.Portal,Ext.Viewport,{onRender:function(){sitools.Portal.superclass.onRender.apply(this,arguments)},connect:function(){var a=new sitools.widget.Login({closable:true,url:loadUrl.get(&quot;APP_URL&quot;)+&quot;/login&quot;,register:loadUrl.get(&quot;APP_URL&quot;)+&quot;/inscriptions/user&quot;,reset:loadUrl.get(&quot;APP_URL&quot;)+&quot;/resetPassword&quot;,handler:function(){portal.initAppliPortal({siteMapRes:loadUrl.get(&quot;APP_URL&quot;)+loadUrl.get(&quot;APP_CLIENT_USER_URL&quot;)})}}).show()}});Ext.reg(&quot;sitools.Portal&quot;,sitools.Portal);Ext.namespace(&quot;sitools.component.users.portal&quot;);sitools.component.users.portal.feedsReaderPortal=Ext.extend(Ext.Panel,{portalId:&quot;idPortal&quot;,layout:&quot;fit&quot;,initComponent:function(){var a=new Ext.data.JsonStore({fields:[&quot;id&quot;,&quot;name&quot;,&quot;feedType&quot;,&quot;title&quot;,&quot;feedSource&quot;,{name:&quot;visible&quot;,type:&quot;boolean&quot;}],url:loadUrl.get(&quot;APP_URL&quot;)+loadUrl.get(&quot;APP_PORTAL_URL&quot;)+&quot;/&quot;+this.portalId+&quot;/listFeeds&quot;,root:&quot;data&quot;,autoLoad:true,listeners:{scope:this,load:function(c,b,d){if(c.getCount()!==0){this.comboFeeds.setValue(a.getAt(0).data.id);this.selectFeeds(this.comboFeeds,a.getAt(0))}}}});this.comboFeeds=new Ext.form.ComboBox({store:a,displayField:&quot;name&quot;,valueField:&quot;id&quot;,typeAhead:true,mode:&quot;local&quot;,forceSelection:true,triggerAction:&quot;all&quot;,emptyText:i18n.get(&quot;label.selectAFeed&quot;),selectOnFocus:true,scope:this,listeners:{scope:this,select:this.selectFeeds}});this.tbar={xtype:&quot;toolbar&quot;,defaults:{scope:this},items:[this.comboFeeds]};sitools.component.users.portal.feedsReaderPortal.superclass.initComponent.call(this)},selectFeeds:function(c,d,b){this.remove(this.feedsReader);var a=loadUrl.get(&quot;APP_URL&quot;)+loadUrl.get(&quot;APP_PORTAL_URL&quot;)+&quot;/&quot;+this.portalId+&quot;/clientFeeds/&quot;+d.data.name;this.feedsReader=new sitools.widget.FeedGridFlux({urlFeed:a,feedType:d.data.feedType,feedSource:d.data.feedSource,autoLoad:true});this.add(this.feedsReader);this.doLayout()}});Ext.reg(&quot;sitools.component.users.portal.feedsReaderPortal&quot;,sitools.component.users.portal.feedsReaderPortal);Ext.namespace(&quot;sitools.component.users.portal&quot;);sitools.component.users.portal.portalOpensearch=function(k){var g=k.dataUrl+&quot;/opensearch/search&quot;;var p=k.dataUrl+&quot;/opensearch/suggest&quot;;var l=true;if(!Ext.isEmpty(k.suggest)){l=k.suggest}var r=true;if(!Ext.isEmpty(k.pagging)){r=k.pagging}function b(){var v=c.getForm().getValues().searchQuery;var u=c.getForm().getValues().nbResults;s.updateStore(g+&quot;?q=&quot;+v+&quot;&amp;nbResults=&quot;+u)}var e=new Ext.data.JsonStore({url:p,restful:true,root:&quot;data&quot;,fields:[{name:&quot;field&quot;,type:&quot;string&quot;},{name:&quot;name&quot;,type:&quot;string&quot;},{name:&quot;nb&quot;,type:&quot;string&quot;}]});var n=new Ext.XTemplate('&lt;tpl for=&quot;.&quot;&gt;&lt;div class=&quot;search-item&quot;&gt;',&quot;&lt;h3&gt;{name}&lt;span&gt; ({field} / {nb} results ) &lt;/span&gt;&lt;/h3&gt;&quot;,&quot;&lt;/div&gt;&lt;/tpl&gt;&quot;);var t=new Ext.form.ComboBox({store:e,displayField:&quot;name&quot;,typeAhead:false,loadingText:i18n.get(&quot;label.searching&quot;),hideTrigger:true,fieldLabel:i18n.get(&quot;label.search&quot;),name:&quot;searchQuery&quot;,anchor:&quot;100%&quot;,tpl:n,itemSelector:&quot;div.search-item&quot;,minChars:2,queryParam:&quot;q&quot;,enableKeyEvents:true,scope:this,listeners:{scope:this,beforequery:function(u){if(u.query.indexOf(&quot; &quot;)==-1){return true}else{return false}},specialkey:function(v,u){if(u.getKey()==u.ENTER){b()}},beforeselect:function(v,u,z){u.data.name=u.data.field+&quot;:&quot;+u.data.name;return true}}});this.storeCb=new Ext.data.ArrayStore({id:0,fields:[&quot;nbResults&quot;],data:[[10],[20],[30],[40],[50]]});var d=new Ext.form.ComboBox({name:&quot;nbResults&quot;,typeAhead:true,triggerAction:&quot;all&quot;,lazyRender:true,mode:&quot;local&quot;,store:this.storeCb,valueField:&quot;nbResults&quot;,displayField:&quot;nbResults&quot;,fieldLabel:i18n.get(&quot;label.nbResults&quot;),value:this.storeCb.getAt(0).get(&quot;nbResults&quot;)});var q=[t,d];var a=[{text:i18n.get(&quot;label.search&quot;),scope:this,handler:b}];var c=new Ext.FormPanel({labelWidth:75,height:90,frame:true,defaultType:&quot;textfield&quot;,items:q,buttons:a});function m(u,D,B){var C=u.store.getAt(D);var z=C.get(&quot;guid&quot;);if(Ext.isEmpty(z)){Ext.Msg.alert(i18n.get(&quot;label.warning&quot;),i18n.get(&quot;warning.noGuidFieldDefined&quot;)+&quot;&lt;br/&gt;&quot;+i18n.get(&quot;warning.noPrimaryKeyDefinedOSNotice&quot;));return}var v=new sitools.user.component.simpleViewDataDetail({urlDataDetail:z});var A=new Ext.Window({stateful:false,title:i18n.get(&quot;label.viewDataDetail&quot;),width:400,height:600,shim:false,animCollapse:false,constrainHeader:true,layout:&quot;fit&quot;});A.add(v);A.show()}var s=new sitools.user.component.openSearchResultFeed({input:t,dataUrl:k.dataUrl,pagging:false,listeners:{rowdblclick:m}});sitools.component.users.portal.portalOpensearch.superclass.constructor.call(this,Ext.apply({items:[c,s],layout:&quot;vbox&quot;,layoutConfig:{align:&quot;stretch&quot;,pack:&quot;start&quot;}},k))};Ext.extend(sitools.component.users.portal.portalOpensearch,Ext.Panel,{_getSettings:function(){return[]}});Ext.reg(&quot;sitools.component.users.portal.portalOpensearch&quot;,sitools.component.users.portal.portalOpensearch);Ext.namespace(&quot;sitools.user.component&quot;);sitools.user.component.openSearchResultFeed=function(d){this.pageSize=10;var b=d.urlFeed;this.input=d.input;this.uriRecords=d.dataUrl+&quot;/records&quot;;var k=d.pagging;var c=(b===undefined)?&quot;/tmp&quot;:b;var a=(Ext.isEmpty(d.exceptionHttpHandler))?onRequestFeedException:d.exceptionHttpHandler;this.httpProxy=new Ext.data.HttpProxy({url:c,restful:true,listeners:{scope:this,exception:a}});this.xmlReader=new sitools.component.users.datasets.XmlReader({record:&quot;item&quot;,totalProperty:&quot;opensearch:totalResults&quot;},[&quot;title&quot;,&quot;link&quot;,&quot;guid&quot;,&quot;pubDate&quot;,&quot;description&quot;]);this.store=new Ext.data.Store({proxy:this.httpProxy,reader:this.xmlReader,autoLoad:d.autoLoad,paramNames:{start:&quot;start&quot;,limit:&quot;rows&quot;},listeners:{scope:this,load:function(m,l,n){if(l.length&gt;1){if(Ext.isEmpty(l[0].data.pubDate)){this.getColumnModel().setHidden(1,true)}else{this.getColumnModel().setHidden(1,false)}}if(!k&amp;&amp;!Ext.isEmpty(this.displayNbResults)){this.displayNbResults.setText(&quot;Total number of results : &quot;+this.store.getTotalCount())}return true},exception:function(p,q,s,n,m,l){var r=Ext.decode(m.responseText);if(!r.success){this.input.markInvalid(i18n.get(r.message));this.store.removeAll()}return true}}});this.store.setDefaultSort(&quot;pubDate&quot;,&quot;DESC&quot;);var e=[{id:&quot;title&quot;,header:&quot;Title&quot;,dataIndex:&quot;title&quot;,sortable:true,renderer:this.formatTitle},{id:&quot;last&quot;,header:&quot;Date&quot;,dataIndex:&quot;pubDate&quot;,sortable:true}];if(k){this.bbar={xtype:&quot;paging&quot;,pageSize:this.pageSize,store:this.store,displayInfo:true,displayMsg:i18n.get(&quot;paging.display&quot;),emptyMsg:i18n.get(&quot;paging.empty&quot;),totalProperty:&quot;totalCount&quot;}}else{this.displayNbResults=new Ext.form.Label({text:&quot;Total number of results : &quot;});this.bbar={items:[&quot;-&gt;&quot;,this.displayNbResults]}}function g(z,t,r){r.stopEvent();var p=z.store.getAt(t);var s=p.get(&quot;guid&quot;);if(Ext.isEmpty(s)){Ext.Msg.alert(i18n.get(&quot;label.warning&quot;),i18n.get(&quot;warning.noGuidFieldDefined&quot;)+&quot;&lt;br/&gt;&quot;+i18n.get(&quot;warning.noPrimaryKeyDefinedOSNotice&quot;));return}if(Ext.isEmpty(window)||Ext.isEmpty(window.SitoolsDesk)){var u=new sitools.user.component.simpleViewDataDetail({fromWhere:&quot;openSearch&quot;,urlDataDetail:s});var q=new Ext.Window({stateful:false,title:i18n.get(&quot;label.viewDataDetail&quot;),width:400,height:600,shim:false,animCollapse:false,constrainHeader:true,layout:&quot;fit&quot;});q.add(u);q.show()}else{var m={grid:this,fromWhere:&quot;openSearch&quot;,datasetId:d.datasetId,datasetUrl:d.dataUrl,datasetName:d.datasetName};var l=sitools.user.component.viewDataDetail;var v=loadUrl.get(&quot;APP_USERSTORAGE_USER_URL&quot;).replace(&quot;{identifier}&quot;,userLogin);var n={id:&quot;dataDetail&quot;+d.datasetId,title:i18n.get(&quot;label.viewDataDetail&quot;)+&quot; : &quot;+d.datasetName,datasetName:d.datasetName,saveToolbar:true,urlPreferences:loadUrl.get(&quot;APP_URL&quot;)+v+&quot;/&quot;+DEFAULT_PREFERENCES_FOLDER+&quot;/&quot;+projectGlobal.projectName+&quot;/&quot;+d.datasetName+&quot;/dataDetail&quot;,type:&quot;dataDetail&quot;,toolbarItems:[{icon:loadUrl.get(&quot;APP_URL&quot;)+&quot;/common/res/images/icons/simple-arrow-left.png&quot;,handler:function(){this.ownerCt.ownerCt.items.items[0].goPrevious()}},{icon:loadUrl.get(&quot;APP_URL&quot;)+&quot;/common/res/images/icons/simple-arrow-right.png&quot;,handler:function(){this.ownerCt.ownerCt.items.items[0].goNext()}}]};SitoolsDesk.addDesktopWindow(n,m,l,true)}}sitools.user.component.openSearchResultFeed.superclass.constructor.call(this,{columns:e,layout:&quot;fit&quot;,flex:1,store:this.store,loadMask:{msg:i18n.get(&quot;label.loadingFeed&quot;)},sm:new Ext.grid.RowSelectionModel({singleSelect:true}),autoExpandColumn:&quot;title&quot;,viewConfig:{forceFit:true,enableRowBody:true,showPreview:true,getRowClass:this.applyRowClass},listeners:{rowdblclick:g}});this.updateStore=function(l){this.httpProxy.setUrl(l,true);this.store.load()}};Ext.extend(sitools.user.component.openSearchResultFeed,Ext.grid.GridPanel,{componentType:&quot;feeds&quot;,applyRowClass:function(a,e,d,c){if(this.showPreview){var b=Ext.util.Format;d.body=&quot;&lt;p class=sous-titre-flux&gt;&quot;+b.ellipsis(b.stripTags(a.data.description),200)+&quot;&lt;/p&gt;&quot;;return&quot;x-grid3-row-expanded&quot;}return&quot;x-grid3-row-collapsed&quot;},formatDate:function(b){if(!b){return&quot;&quot;}var a=new Date();var e=a.clearTime(true);var c=b.clearTime(true).getTime();if(c==e.getTime()){return&quot;Today &quot;+b.dateFormat(&quot;g:i a&quot;)}e=e.add(&quot;d&quot;,-6);if(e.getTime()&lt;=c){return b.dateFormat(&quot;D g:i a&quot;)}return b.dateFormat(&quot;n/j g:i a&quot;)},formatTitle:function(d,e,a){var c=a.data.link;var b=(Ext.isEmpty(a.data.author))?&quot;&quot;:a.data.author;if(c!==undefined&amp;&amp;c!==&quot;&quot;){return String.format('&lt;div class=&quot;topic&quot;&gt;&lt;a href=&quot;{0}&quot;&gt;&lt;span class=&quot;rss_feed_title&quot;&gt;{1}&lt;/span&gt;&lt;/a&gt;&lt;br/&gt;&lt;span class=&quot;author&quot;&gt;{2}&lt;/span&gt;&lt;/div&gt;',c,d,b)}else{return String.format('&lt;div class=&quot;topic&quot;&gt;&lt;span class=&quot;rss_feed_title&quot;&gt;{0}&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;author&quot;&gt;{1}&lt;/span&gt;&lt;/div&gt;',d,b)}}});Ext.reg(&quot;sitools.user.component.openSearchResultFeed&quot;,sitools.user.component.openSearchResultFeed);
/*!
 * Ext JS Library 3.3.1
 * Copyright(c) 2006-2010 Sencha Inc.
 * licensing@sencha.com
 * http://www.sencha.com/license
 */
Ext.namespace(&quot;sitools.component.users.datasets&quot;);sitools.component.users.datasets.DomQuery=function(){var cache={},simpleCache={},valueCache={},nonSpace=/\S/,trimRe=/^\s+|\s+$/g,tplRe=/\{(\d+)\}/g,modeRe=/^(\s?[\/&gt;+~]\s?|\s|$)/,tagTokenRe=/^(#)?((?:opensearch:)?[\w-\*]+)/,nthRe=/(\d*)n\+?(\d*)/,nthRe2=/\D/,isIE=window.ActiveXObject?true:false,key=30803;eval(&quot;var batch = 30803;&quot;);function child(parent,index){var i=0,n=parent.firstChild;while(n){if(n.nodeType==1){if(++i==index){return n}}n=n.nextSibling}return null}function next(n){while((n=n.nextSibling)&amp;&amp;n.nodeType!=1){}return n}function prev(n){while((n=n.previousSibling)&amp;&amp;n.nodeType!=1){}return n}function children(parent){var n=parent.firstChild,nodeIndex=-1,nextNode;while(n){nextNode=n.nextSibling;if(n.nodeType==3&amp;&amp;!nonSpace.test(n.nodeValue)){parent.removeChild(n)}else{n.nodeIndex=++nodeIndex}n=nextNode}return this}function byClassName(nodeSet,cls){if(!cls){return nodeSet}var result=[],ri=-1;for(var i=0,ci;ci=nodeSet[i];i++){if((&quot; &quot;+ci.className+&quot; &quot;).indexOf(cls)!=-1){result[++ri]=ci}}return result}function attrValue(n,attr){if(!n.tagName&amp;&amp;typeof n.length!=&quot;undefined&quot;){n=n[0]}if(!n){return null}if(attr==&quot;for&quot;){return n.htmlFor}if(attr==&quot;class&quot;||attr==&quot;className&quot;){return n.className}return n.getAttribute(attr)||n[attr]}function getNodes(ns,mode,tagName){var result=[],ri=-1,cs;if(!ns){return result}tagName=tagName||&quot;*&quot;;if(typeof ns.getElementsByTagName!=&quot;undefined&quot;){ns=[ns]}if(!mode){for(var i=0,ni;ni=ns[i];i++){cs=ni.getElementsByTagName(tagName);for(var j=0,ci;ci=cs[j];j++){result[++ri]=ci}}}else{if(mode==&quot;/&quot;||mode==&quot;&gt;&quot;){var utag=tagName.toUpperCase();for(var i=0,ni,cn;ni=ns[i];i++){cn=ni.childNodes;for(var j=0,cj;cj=cn[j];j++){if(cj.nodeName==utag||cj.nodeName==tagName||tagName==&quot;*&quot;){result[++ri]=cj}}}}else{if(mode==&quot;+&quot;){var utag=tagName.toUpperCase();for(var i=0,n;n=ns[i];i++){while((n=n.nextSibling)&amp;&amp;n.nodeType!=1){}if(n&amp;&amp;(n.nodeName==utag||n.nodeName==tagName||tagName==&quot;*&quot;)){result[++ri]=n}}}else{if(mode==&quot;~&quot;){var utag=tagName.toUpperCase();for(var i=0,n;n=ns[i];i++){while((n=n.nextSibling)){if(n.nodeName==utag||n.nodeName==tagName||tagName==&quot;*&quot;){result[++ri]=n}}}}}}}return result}function concat(a,b){if(b.slice){return a.concat(b)}for(var i=0,l=b.length;i&lt;l;i++){a[a.length]=b[i]}return a}function byTag(cs,tagName){if(cs.tagName||cs==document){cs=[cs]}if(!tagName){return cs}var result=[],ri=-1;tagName=tagName.toLowerCase();for(var i=0,ci;ci=cs[i];i++){if(ci.nodeType==1&amp;&amp;ci.tagName.toLowerCase()==tagName){result[++ri]=ci}}return result}function byId(cs,id){if(cs.tagName||cs==document){cs=[cs]}if(!id){return cs}var result=[],ri=-1;for(var i=0,ci;ci=cs[i];i++){if(ci&amp;&amp;ci.id==id){result[++ri]=ci;return result}}return result}function byAttribute(cs,attr,value,op,custom){var result=[],ri=-1,useGetStyle=custom==&quot;{&quot;,fn=sitools.component.users.datasets.DomQuery.operators[op],a,xml,hasXml;for(var i=0,ci;ci=cs[i];i++){if(ci.nodeType!=1){continue}if(!hasXml){xml=sitools.component.users.datasets.DomQuery.isXml(ci);hasXml=true}if(!xml){if(useGetStyle){a=sitools.component.users.datasets.DomQuery.getStyle(ci,attr)}else{if(attr==&quot;class&quot;||attr==&quot;className&quot;){a=ci.className}else{if(attr==&quot;for&quot;){a=ci.htmlFor}else{if(attr==&quot;href&quot;){a=ci.getAttribute(&quot;href&quot;,2)}else{a=ci.getAttribute(attr)}}}}}else{a=ci.getAttribute(attr)}if((fn&amp;&amp;fn(a,value))||(!fn&amp;&amp;a)){result[++ri]=ci}}return result}function byPseudo(cs,name,value){return sitools.component.users.datasets.DomQuery.pseudos[name](cs,value)}function nodupIEXml(cs){var d=++key,r;cs[0].setAttribute(&quot;_nodup&quot;,d);r=[cs[0]];for(var i=1,len=cs.length;i&lt;len;i++){var c=cs[i];if(!c.getAttribute(&quot;_nodup&quot;)!=d){c.setAttribute(&quot;_nodup&quot;,d);r[r.length]=c}}for(var i=0,len=cs.length;i&lt;len;i++){cs[i].removeAttribute(&quot;_nodup&quot;)}return r}function nodup(cs){if(!cs){return[]}var len=cs.length,c,i,r=cs,cj,ri=-1;if(!len||typeof cs.nodeType!=&quot;undefined&quot;||len==1){return cs}if(isIE&amp;&amp;typeof cs[0].selectSingleNode!=&quot;undefined&quot;){return nodupIEXml(cs)}var d=++key;cs[0]._nodup=d;for(i=1;c=cs[i];i++){if(c._nodup!=d){c._nodup=d}else{r=[];for(var j=0;j&lt;i;j++){r[++ri]=cs[j]}for(j=i+1;cj=cs[j];j++){if(cj._nodup!=d){cj._nodup=d;r[++ri]=cj}}return r}}return r}function quickDiffIEXml(c1,c2){var d=++key,r=[];for(var i=0,len=c1.length;i&lt;len;i++){c1[i].setAttribute(&quot;_qdiff&quot;,d)}for(var i=0,len=c2.length;i&lt;len;i++){if(c2[i].getAttribute(&quot;_qdiff&quot;)!=d){r[r.length]=c2[i]}}for(var i=0,len=c1.length;i&lt;len;i++){c1[i].removeAttribute(&quot;_qdiff&quot;)}return r}function quickDiff(c1,c2){var len1=c1.length,d=++key,r=[];if(!len1){return c2}if(isIE&amp;&amp;typeof c1[0].selectSingleNode!=&quot;undefined&quot;){return quickDiffIEXml(c1,c2)}for(var i=0;i&lt;len1;i++){c1[i]._qdiff=d}for(var i=0,len=c2.length;i&lt;len;i++){if(c2[i]._qdiff!=d){r[r.length]=c2[i]}}return r}function quickId(ns,mode,root,id){if(ns==root){var d=root.ownerDocument||root;return d.getElementById(id)}ns=getNodes(ns,mode,&quot;*&quot;);return byId(ns,id)}return{getStyle:function(el,name){return Ext.fly(el).getStyle(name)},compile:function(path,type){type=type||&quot;select&quot;;var fn=[&quot;var f = function(root){\n var mode; ++batch; var n = root || document;\n&quot;],mode,lastPath,matchers=sitools.component.users.datasets.DomQuery.matchers,matchersLn=matchers.length,modeMatch,lmode=path.match(modeRe);if(lmode&amp;&amp;lmode[1]){fn[fn.length]='mode=&quot;'+lmode[1].replace(trimRe,&quot;&quot;)+'&quot;;';path=path.replace(lmode[1],&quot;&quot;)}while(path.substr(0,1)==&quot;/&quot;){path=path.substr(1)}while(path&amp;&amp;lastPath!=path){lastPath=path;var tokenMatch=path.match(tagTokenRe);if(type==&quot;select&quot;){if(tokenMatch){if(tokenMatch[1]==&quot;#&quot;){fn[fn.length]='n = quickId(n, mode, root, &quot;'+tokenMatch[2]+'&quot;);'}else{fn[fn.length]='n = getNodes(n, mode, &quot;'+tokenMatch[2]+'&quot;);'}path=path.replace(tokenMatch[0],&quot;&quot;)}else{if(path.substr(0,1)!=&quot;@&quot;){fn[fn.length]='n = getNodes(n, mode, &quot;*&quot;);'}}}else{if(tokenMatch){if(tokenMatch[1]==&quot;#&quot;){fn[fn.length]='n = byId(n, &quot;'+tokenMatch[2]+'&quot;);'}else{fn[fn.length]='n = byTag(n, &quot;'+tokenMatch[2]+'&quot;);'}path=path.replace(tokenMatch[0],&quot;&quot;)}}while(!(modeMatch=path.match(modeRe))){var matched=false;for(var j=0;j&lt;matchersLn;j++){var t=matchers[j];var m=path.match(t.re);if(m){fn[fn.length]=t.select.replace(tplRe,function(x,i){return m[i]});path=path.replace(m[0],&quot;&quot;);matched=true;break}}if(!matched){throw'Error parsing selector, parsing failed at &quot;'+path+'&quot;'}}if(modeMatch[1]){fn[fn.length]='mode=&quot;'+modeMatch[1].replace(trimRe,&quot;&quot;)+'&quot;;';path=path.replace(modeMatch[1],&quot;&quot;)}}fn[fn.length]=&quot;return nodup(n);\n}&quot;;eval(fn.join(&quot;&quot;));return f},jsSelect:function(path,root,type){root=root||document;if(typeof root==&quot;string&quot;){root=document.getElementById(root)}var paths=path.split(&quot;,&quot;),results=[];for(var i=0,len=paths.length;i&lt;len;i++){var subPath=paths[i].replace(trimRe,&quot;&quot;);if(!cache[subPath]){cache[subPath]=sitools.component.users.datasets.DomQuery.compile(subPath);if(!cache[subPath]){throw subPath+&quot; is not a valid selector&quot;}}var result=cache[subPath](root);if(result&amp;&amp;result!=document){results=results.concat(result)}}if(paths.length&gt;1){return nodup(results)}return results},isXml:function(el){var docEl=(el?el.ownerDocument||el:0).documentElement;return docEl?docEl.nodeName!==&quot;HTML&quot;:false},select:document.querySelectorAll?function(path,root,type){root=root||document;if(!sitools.component.users.datasets.DomQuery.isXml(root)){try{var cs=root.querySelectorAll(path);return Ext.toArray(cs)}catch(ex){}}return sitools.component.users.datasets.DomQuery.jsSelect.call(this,path,root,type)}:function(path,root,type){return sitools.component.users.datasets.DomQuery.jsSelect.call(this,path,root,type)},selectNode:function(path,root){return sitools.component.users.datasets.DomQuery.select(path,root)[0]},selectValue:function(path,root,defaultValue){path=path.replace(trimRe,&quot;&quot;);if(!valueCache[path]){valueCache[path]=sitools.component.users.datasets.DomQuery.compile(path,&quot;select&quot;)}var n=valueCache[path](root),v;n=n[0]?n[0]:n;if(typeof n.normalize==&quot;function&quot;){n.normalize()}v=(n&amp;&amp;n.firstChild?n.firstChild.nodeValue:null);return((v===null||v===undefined||v===&quot;&quot;)?defaultValue:v)},selectNumber:function(path,root,defaultValue){var v=sitools.component.users.datasets.DomQuery.selectValue(path,root,defaultValue||0);return parseFloat(v)},is:function(el,ss){if(typeof el==&quot;string&quot;){el=document.getElementById(el)}var isArray=Ext.isArray(el),result=sitools.component.users.datasets.DomQuery.filter(isArray?el:[el],ss);return isArray?(result.length==el.length):(result.length&gt;0)},filter:function(els,ss,nonMatches){ss=ss.replace(trimRe,&quot;&quot;);if(!simpleCache[ss]){simpleCache[ss]=sitools.component.users.datasets.DomQuery.compile(ss,&quot;simple&quot;)}var result=simpleCache[ss](els);return nonMatches?quickDiff(result,els):result},matchers:[{re:/^\.([\w-]+)/,select:'n = byClassName(n, &quot; {1} &quot;);'},{re:/^\:([\w-]+)(?:\(((?:[^\s&gt;\/]*|.*?))\))?/,select:'n = byPseudo(n, &quot;{1}&quot;, &quot;{2}&quot;);'},{re:/^(?:([\[\{])(?:@)?([\w-]+)\s?(?:(=|.=)\s?['&quot;]?(.*?)[&quot;']?)?[\]\}])/,select:'n = byAttribute(n, &quot;{2}&quot;, &quot;{4}&quot;, &quot;{3}&quot;, &quot;{1}&quot;);'},{re:/^#([\w-]+)/,select:'n = byId(n, &quot;{1}&quot;);'},{re:/^@([\w-]+)/,select:'return {firstChild:{nodeValue:attrValue(n, &quot;{1}&quot;)}};'}],operators:{&quot;=&quot;:function(a,v){return a==v},&quot;!=&quot;:function(a,v){return a!=v},&quot;^=&quot;:function(a,v){return a&amp;&amp;a.substr(0,v.length)==v},&quot;$=&quot;:function(a,v){return a&amp;&amp;a.substr(a.length-v.length)==v},&quot;*=&quot;:function(a,v){return a&amp;&amp;a.indexOf(v)!==-1},&quot;%=&quot;:function(a,v){return(a%v)==0},&quot;|=&quot;:function(a,v){return a&amp;&amp;(a==v||a.substr(0,v.length+1)==v+&quot;-&quot;)},&quot;~=&quot;:function(a,v){return a&amp;&amp;(&quot; &quot;+a+&quot; &quot;).indexOf(&quot; &quot;+v+&quot; &quot;)!=-1}},pseudos:{&quot;first-child&quot;:function(c){var r=[],ri=-1,n;for(var i=0,ci;ci=n=c[i];i++){while((n=n.previousSibling)&amp;&amp;n.nodeType!=1){}if(!n){r[++ri]=ci}}return r},&quot;last-child&quot;:function(c){var r=[],ri=-1,n;for(var i=0,ci;ci=n=c[i];i++){while((n=n.nextSibling)&amp;&amp;n.nodeType!=1){}if(!n){r[++ri]=ci}}return r},&quot;nth-child&quot;:function(c,a){var r=[],ri=-1,m=nthRe.exec(a==&quot;even&quot;&amp;&amp;&quot;2n&quot;||a==&quot;odd&quot;&amp;&amp;&quot;2n+1&quot;||!nthRe2.test(a)&amp;&amp;&quot;n+&quot;+a||a),f=(m[1]||1)-0,l=m[2]-0;for(var i=0,n;n=c[i];i++){var pn=n.parentNode;if(batch!=pn._batch){var j=0;for(var cn=pn.firstChild;cn;cn=cn.nextSibling){if(cn.nodeType==1){cn.nodeIndex=++j}}pn._batch=batch}if(f==1){if(l==0||n.nodeIndex==l){r[++ri]=n}}else{if((n.nodeIndex+l)%f==0){r[++ri]=n}}}return r},&quot;only-child&quot;:function(c){var r=[],ri=-1;for(var i=0,ci;ci=c[i];i++){if(!prev(ci)&amp;&amp;!next(ci)){r[++ri]=ci}}return r},empty:function(c){var r=[],ri=-1;for(var i=0,ci;ci=c[i];i++){var cns=ci.childNodes,j=0,cn,empty=true;while(cn=cns[j]){++j;if(cn.nodeType==1||cn.nodeType==3){empty=false;break}}if(empty){r[++ri]=ci}}return r},contains:function(c,v){var r=[],ri=-1;for(var i=0,ci;ci=c[i];i++){if((ci.textContent||ci.innerText||&quot;&quot;).indexOf(v)!=-1){r[++ri]=ci}}return r},nodeValue:function(c,v){var r=[],ri=-1;for(var i=0,ci;ci=c[i];i++){if(ci.firstChild&amp;&amp;ci.firstChild.nodeValue==v){r[++ri]=ci}}return r},checked:function(c){var r=[],ri=-1;for(var i=0,ci;ci=c[i];i++){if(ci.checked==true){r[++ri]=ci}}return r},not:function(c,ss){return sitools.component.users.datasets.DomQuery.filter(c,ss,true)},any:function(c,selectors){var ss=selectors.split(&quot;|&quot;),r=[],ri=-1,s;for(var i=0,ci;ci=c[i];i++){for(var j=0;s=ss[j];j++){if(sitools.component.users.datasets.DomQuery.is(ci,s)){r[++ri]=ci;break}}}return r},odd:function(c){return this[&quot;nth-child&quot;](c,&quot;odd&quot;)},even:function(c){return this[&quot;nth-child&quot;](c,&quot;even&quot;)},nth:function(c,a){return c[a-1]||[]},first:function(c){return c[0]||[]},last:function(c){return c[c.length-1]||[]},has:function(c,ss){var s=sitools.component.users.datasets.DomQuery.select,r=[],ri=-1;for(var i=0,ci;ci=c[i];i++){if(s(ss,ci).length&gt;0){r[++ri]=ci}}return r},next:function(c,ss){var is=sitools.component.users.datasets.DomQuery.is,r=[],ri=-1;for(var i=0,ci;ci=c[i];i++){var n=next(ci);if(n&amp;&amp;is(n,ss)){r[++ri]=ci}}return r},prev:function(c,ss){var is=sitools.component.users.datasets.DomQuery.is,r=[],ri=-1;for(var i=0,ci;ci=c[i];i++){var n=prev(ci);if(n&amp;&amp;is(n,ss)){r[++ri]=ci}}return r}}}}();Ext.query=sitools.component.users.datasets.DomQuery.select;Ext.namespace(&quot;sitools.component.users.datasets&quot;);sitools.component.users.datasets.XmlReader=function(a,b){a=a||{};Ext.applyIf(a,{idProperty:a.idProperty||a.idPath||a.id,successProperty:a.successProperty||a.success});sitools.component.users.datasets.XmlReader.superclass.constructor.call(this,a,b||a.fields)};Ext.extend(sitools.component.users.datasets.XmlReader,Ext.data.XmlReader,{createAccessor:function(){var a=sitools.component.users.datasets.DomQuery;return function(b){if(Ext.isFunction(b)){return b}switch(b){case this.meta.totalProperty:return function(c,d){return a.selectNumber(b,c,d)};break;case this.meta.successProperty:return function(d,e){var c=a.selectValue(b,d,true);var g=c!==false&amp;&amp;c!==&quot;false&quot;;return g};break;default:return function(c,d){return a.selectValue(b,c,d)};break}}}()});Ext.namespace(&quot;sitools.user.component&quot;);sitools.user.component.viewDataDetail=Ext.extend(Ext.Panel,{datasetColumnModel:null,initComponent:function(){var e;switch(this.fromWhere){case&quot;openSearch&quot;:this.grid=this.grid;this.recSelected=this.grid.getSelectionModel().getSelected();this.url=this.recSelected.data.guid;break;case&quot;dataView&quot;:break;case&quot;plot&quot;:break;default:this.recSelected=this.selections[0];if(Ext.isEmpty(this.recSelected)){Ext.Msg.alert(i18n.get(&quot;label.error&quot;),i18n.get(&quot;label.noSelection&quot;));return}var d=&quot;&quot;,c=&quot;&quot;;Ext.each(this.recSelected.fields.items,function(g){if(g.primaryKey){this.primaryKeyName=g.name}},this);this.primaryKeyValue=this.recSelected.get(this.primaryKeyName);this.primaryKeyValue=encodeURIComponent(this.primaryKeyValue);this.url=this.baseUrl+this.primaryKeyValue;break}this.layout=&quot;border&quot;;this.linkStore=new Ext.data.Store({fields:[&quot;name&quot;,&quot;value&quot;,&quot;image&quot;,&quot;behavior&quot;,&quot;columnRenderer&quot;]});var a=new Ext.DataView({store:this.linkStore,tpl:new Ext.XTemplate(&quot;&lt;ul&gt;&quot;,'&lt;tpl for=&quot;.&quot;&gt;','&lt;li id=&quot;{name}&quot; class=&quot;img-link&quot;','&lt;tpl if=&quot;this.hasToolTip(toolTip)&quot;&gt;','ext:qtip=&quot;{toolTip}&quot;&gt;',&quot;&lt;/tpl&gt;&quot;,'&lt;tpl if=&quot;this.hasToolTip(toolTip) == false&quot;&gt;','ext:qtip=&quot;{name}&quot;&gt;',&quot;&lt;/tpl&gt;&quot;,'&lt;img src=&quot;{image}&quot; /&gt;',&quot;&lt;/li&gt;&quot;,&quot;&lt;/tpl&gt;&quot;,&quot;&lt;/ul&gt;&quot;,{compiled:true,disableFormats:true,hasToolTip:function(g){return !Ext.isEmpty(g)}}),cls:&quot;linkImageDataView&quot;,itemSelector:&quot;li.img-link&quot;,overClass:&quot;nodes-hover&quot;,selectedClass:&quot;&quot;,singleSelect:true,multiSelect:false,autoScroll:true,listeners:{scope:this,click:this.handleClickOnLink}});this.formPanel=new Ext.FormPanel({labelAlign:&quot;top&quot;,anchor:&quot;100%&quot;,defaults:{labelStyle:&quot;font-weight:bold;&quot;}});this.linkPanel=new Ext.Panel({title:i18n.get(&quot;label.complementaryInformation&quot;),items:[a],anchor:&quot;100%&quot;});this.formPanelImg=new Ext.FormPanel({frame:true,autoScroll:true,region:&quot;east&quot;,hideLabels:true,split:(this.fromWhere!=&quot;dataView&quot;),collapsible:(this.fromWhere!=&quot;dataView&quot;),collapsed:(this.fromWhere!=&quot;dataView&quot;),flex:1,title:(this.fromWhere==&quot;dataView&quot;)?i18n.get(&quot;label.formImagePanelTitle&quot;):null});var b;if(this.fromWhere==&quot;dataView&quot;){b=[this.formPanel,this.formPanelImg,this.linkPanel]}else{b=[this.formPanel,this.linkPanel]}this.centerPanel=new Ext.Panel({autoScroll:true,frame:true,region:&quot;center&quot;,split:true,layout:{type:&quot;anchor&quot;},items:b});this.getCmDefAndbuildForm();this.componentType=&quot;dataDetail&quot;;if(this.fromWhere==&quot;dataView&quot;){this.items=[this.centerPanel]}else{this.items=[this.centerPanel,this.formPanelImg]}this.listeners={scope:this,afterrender:function(g){g.getEl().on(&quot;contextmenu&quot;,function(l,k,m){l.stopPropagation()},this)}};sitools.user.component.viewDataDetail.superclass.initComponent.call(this)},afterRender:function(){this._loadMaskAnchor=Ext.get(this.body.dom);sitools.user.component.viewDataDetail.superclass.afterRender.apply(this,arguments)},_getSettings:function(){return null},goNext:function(){if(Ext.isEmpty(this.grid)){return}var d,c;switch(this.fromWhere){case&quot;openSearch&quot;:c=this.grid.getSelectionModel();if(!c.selectNext()){return}d=c.getSelected();this.url=d.data.guid;break;case&quot;sitools.user.component.dataviews.tplView.TplView&quot;:var a=this.grid.getStore().indexOf(this.recSelected);var b=this.grid.getStore().getAt(a+1);if(Ext.isEmpty(b)){return}this.primaryKeyValue=b.get(this.primaryKeyName);this.primaryKeyValue=encodeURIComponent(this.primaryKeyValue);this.url=this.baseUrl+this.primaryKeyValue;this.recSelected=b;this.grid.select(b);break;default:c=this.grid.getSelectionModel();if(!c.selectNext()){return}d=c.getSelected();this.primaryKeyValue=d.get(this.primaryKeyName);this.primaryKeyValue=encodeURIComponent(this.primaryKeyValue);this.url=this.baseUrl+this.primaryKeyValue;break}this.getCmDefAndbuildForm()},goPrevious:function(){if(Ext.isEmpty(this.grid)){return}var d,c;switch(this.fromWhere){case&quot;openSearch&quot;:c=this.grid.getSelectionModel();if(!c.selectPrevious()){return}d=c.getSelected();this.url=d.data.guid;break;case&quot;sitools.user.component.dataviews.tplView.TplView&quot;:var a=this.grid.getStore().indexOf(this.recSelected);var b=this.grid.getStore().getAt(a-1);if(Ext.isEmpty(b)){return}this.primaryKeyValue=b.get(this.primaryKeyName);this.primaryKeyValue=encodeURIComponent(this.primaryKeyValue);this.url=this.baseUrl+this.primaryKeyValue;this.recSelected=b;this.grid.select(b);break;default:c=this.grid.getSelectionModel();if(!c.selectPrevious()){return}d=c.getSelected();this.primaryKeyValue=d.get(this.primaryKeyName);this.primaryKeyValue=encodeURIComponent(this.primaryKeyValue);this.url=this.baseUrl+this.primaryKeyValue;break}this.getCmDefAndbuildForm()},getCmDefAndbuildForm:function(){if(Ext.isEmpty(this.datasetColumnModel)){Ext.Ajax.request({url:this.datasetUrl,method:&quot;GET&quot;,scope:this,success:function(b){try{var a=Ext.decode(b.responseText);if(!a.success){throw a.message}this.datasetColumnModel=a.dataset.columnModel;this.buildForm()}catch(c){Ext.Msg.alert(i18n.get(&quot;label.error&quot;),c)}},failure:alertFailure})}else{this.buildForm()}},buildForm:function(){if(!Ext.isEmpty(this._loadMaskAnchor)){this._loadMaskAnchor.mask(i18n.get(&quot;label.waitMessage&quot;),&quot;x-mask-loading&quot;)}if(!Ext.isEmpty(this.url)){this.linkStore.removeAll();Ext.Ajax.request({url:this.url,method:&quot;GET&quot;,scope:this,success:function(v){var z=Ext.decode(v.responseText);var a=[];var k=[];if(!z.success){Ext.Msg.alert(i18n.get(&quot;label.information&quot;),&quot;Server error&quot;);return false}var b=z.record;var q=b.id;var l=b.attributeValues;if(l!==undefined){var s;for(s=0;s&lt;l.length;s++){var A=l[s].name;var c=this.findColumn(A);var r=l[s].value;var e=r;if(sql2ext.get(c.sqlColumnType)==&quot;dateAsString&quot;){e=sitools.user.component.dataviews.dataviewUtils.formatDate(r,c)}if(sql2ext.get(c.sqlColumnType)==&quot;boolean&quot;){e=r?i18n.get(&quot;label.true&quot;):i18n.get(&quot;label.false&quot;)}var u=new Ext.BoxComponent({fieldLabel:c.header,labelSeparator:&quot;&quot;,html:e});if(Ext.isEmpty(c)||Ext.isEmpty(c.columnRenderer)){a.push(u)}else{var n=c.columnRenderer;var p=&quot;&quot;;if(!Ext.isEmpty(c.columnRenderer)){p=c.columnRenderer.behavior;var m=sitools.user.component.dataviews.dataviewUtils.getRendererHTML(c,{});switch(p){case ColumnRendererEnum.URL_LOCAL:case ColumnRendererEnum.URL_EXT_NEW_TAB:case ColumnRendererEnum.URL_EXT_DESKTOP:case ColumnRendererEnum.DATASET_ICON_LINK:if(!Ext.isEmpty(r)){if(!Ext.isEmpty(n.linkText)){u=new Ext.BoxComponent({fieldLabel:c.header,labelSeparator:&quot;&quot;,html:String.format(m,r)});a.push(u)}else{if(!Ext.isEmpty(n.image)){var g={name:A,value:r,image:n.image.url,behavior:p,columnRenderer:n,toolTip:n.toolTip};g=new Ext.data.Record(g);this.linkStore.add(g)}}}break;case ColumnRendererEnum.IMAGE_FROM_SQL:case ColumnRendererEnum.IMAGE_THUMB_FROM_IMAGE:if(!Ext.isEmpty(r)){var d=&quot;&quot;;var t=&quot;&quot;;if(Ext.isEmpty(n.toolTip)){d=n.toolTip}else{d=col.header}if(!Ext.isEmpty(n.url)){t=n.url}else{if(!Ext.isEmpty(n.columnAlias)){t=this.findRecordValue(b,n.columnAlias)}}u=new Ext.BoxComponent({html:String.format(m,r,t),tooltip:d,cls:&quot;x-form-item&quot;})}k.push(u);break;case ColumnRendererEnum.NO_CLIENT_ACCESS:break;default:u=new Ext.BoxComponent({fieldLabel:c.header,labelSeparator:&quot;&quot;,html:String.format(m,r)});a.push(u);break}}}}this.formPanel.removeAll();this.formPanelImg.removeAll();this.formPanel.add(a);this.formPanel.doLayout();if(this.linkStore.getCount()===0){this.linkPanel.setVisible(false)}else{this.linkPanel.setVisible(true);this.linkPanel.doLayout()}if(k.length===0){this.formPanelImg.setVisible(false)}else{this.formPanelImg.add(k);this.formPanelImg.setVisible(true);this.linkPanel.doLayout()}this.doLayout();if(this._loadMaskAnchor&amp;&amp;this._loadMaskAnchor.isMasked()){this._loadMaskAnchor.unmask()}}},failure:function(){alertFailure();if(this._loadMaskAnchor&amp;&amp;this._loadMaskAnchor.isMasked()){this._loadMaskAnchor.unmask()}}})}},findColumn:function(b){var a=null;Ext.each(this.datasetColumnModel,function(c){if(c.columnAlias==b){a=c;return}},this);return a},findRecordValue:function(b,c){var a=null;Ext.each(b.attributeValues,function(d){if(d.name==c){a=d.value;return}},this);return a},handleClickOnLink:function(k,a,c,g){var d=k.getRecord(c).data;var b=d.behavior;switch(b){case ColumnRendererEnum.URL_LOCAL:sitools.user.component.dataviews.dataviewUtils.downloadData(d.value);break;case ColumnRendererEnum.URL_EXT_NEW_TAB:window.open(d.value);break;case ColumnRendererEnum.URL_EXT_DESKTOP:sitools.user.component.dataviews.dataviewUtils.showDisplayableUrl(d.value,d.columnRenderer.displayable);break;case ColumnRendererEnum.DATASET_ICON_LINK:sitools.user.component.dataviews.dataviewUtils.showDetailsData(d.value,d.columnRenderer.columnAlias,d.columnRenderer.datasetLinkUrl);break;default:break}}});Ext.namespace(&quot;sitools.user.component&quot;);sitools.user.component.simpleViewDataDetail=Ext.extend(Ext.Panel,{initComponent:function(){this.url=this.urlDataDetail;var b=this.url.split(&quot;/&quot;);this.url=&quot;&quot;;for(var a=0;a&lt;b.length;a++){if(a&lt;b.length-1){this.url+=b[a]+&quot;/&quot;}else{this.url+=encodeURIComponent(b[a])}}this.layout=&quot;fit&quot;;this.autoScroll=true;this.formPanel=new Ext.FormPanel({frame:true,autoScroll:true,labelWidth:150,labelAlign:&quot;top&quot;});var c=[];Ext.Ajax.request({url:this.url,method:&quot;GET&quot;,scope:this,success:function(n){var k=Ext.decode(n.responseText);if(!k.success){Ext.Msg.alert(i18n.get(&quot;label.information&quot;),&quot;Server error&quot;);return false}var m=k.record;var e=m.id;var g=m.attributeValues;if(g!==undefined){var l;for(l=0;l&lt;g.length;l++){var d=g[l].name;var p=g[l].value;var q;if(p!==null&amp;&amp;p.length&gt;100){q=new Ext.form.TextArea({fieldLabel:d,value:p,anchor:&quot;90%&quot;,readOnly:true})}else{q=new Ext.form.TextField({fieldLabel:d,value:p,anchor:&quot;90%&quot;,readOnly:true})}c.push(q)}this.formPanel.add(c);this.formPanel.doLayout()}},failure:alertFailure});this.componentType=&quot;detail&quot;;this.items=[this.formPanel];sitools.user.component.simpleViewDataDetail.superclass.initComponent.call(this)},_getSettings:function(){return null}});Ext.namespace(&quot;sitools.component.version&quot;);sitools.component.version.sitoolsVersion=Ext.extend(Ext.Panel,{layout:&quot;fit&quot;,version:null,initComponent:function(){this.versionUrl=loadUrl.get(&quot;APP_URL&quot;)+&quot;/version&quot;;var g=new Ext.form.Label({html:&quot;&lt;h2&gt;SITools2&lt;/h2&quot;});var e=new Ext.form.Label({html:&quot;&lt;img src=&quot;+loadUrl.get(&quot;APP_URL&quot;)+&quot;/res/images/logo_02_tailleMoyenne.png&gt;&quot;});var c=new Ext.form.Label({html:&quot;&lt;p&gt;Copyright 2010, 2011, 2012 CNES&lt;/p&gt;&quot;});var a=new Ext.form.Label({html:'&lt;a href=&quot;http://www.sitools2.sourceforge.net&quot;&gt;sitools2.sourceforge.net&lt;/&gt;'});this.versionLabel=new Ext.form.Label({});var b=new Ext.Panel({title:i18n.get(&quot;label.version&quot;),layout:&quot;fit&quot;,padding:10});var d=new Ext.ux.ManagedIFrame.Panel({title:i18n.get(&quot;label.licence&quot;),layout:&quot;fit&quot;,defaultSrc:loadUrl.get(&quot;APP_URL&quot;)+&quot;/res/licences/gpl-3.0.txt&quot;});b.add([e,g,this.versionLabel,c,a]);this.tabs=new Ext.TabPanel({activeTab:0,items:[b,d]});this.items=[this.tabs];this.listeners={scope:this,resize:function(l){var k=l.body.getSize();this.tabs.setSize(k)}};sitools.component.version.sitoolsVersion.superclass.initComponent.call(this)},afterRender:function(){sitools.component.version.sitoolsVersion.superclass.afterRender.apply(this,arguments);Ext.Ajax.request({url:this.versionUrl,method:&quot;GET&quot;,scope:this,success:function(b){var c=Ext.decode(b.responseText);if(!c.success){Ext.Msg.alert(i18n.get(&quot;label.warning&quot;),c.message);return false}this.version=c.version;this.versionLabel.setText(&quot;&lt;h3&gt;Version : &quot;+this.version+&quot;&lt;/h3&gt;&quot;,false)},failure:alertFailure});var a=this.ownerCt.body.getSize();this.tabs.setSize(a)}});function showVersion(){var a=Ext.getCmp(&quot;winVersionId&quot;);if(!a){var b=new sitools.component.version.sitoolsVersion();a=new Ext.Window({title:i18n.get(&quot;label.version&quot;),id:&quot;winVersionId&quot;,items:[b],modal:false,width:700,height:480,resizable:false,buttons:[{text:i18n.get(&quot;label.close&quot;),handler:function(){this.ownerCt.ownerCt.close()}}]});a.show()}else{a.show()}};</pre>
</body>
</html>
